<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Assignment 4: Demand Function Estimation II | ECON5630 Topics in Empirical Industrial Organization</title>
  <meta name="description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Assignment 4: Demand Function Estimation II | ECON5630 Topics in Empirical Industrial Organization" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Assignment 4: Demand Function Estimation II | ECON5630 Topics in Empirical Industrial Organization" />
  
  <meta name="twitter:description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  

<meta name="author" content="Kohei Kawaguchi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="assignment3.html"/>
<link rel="next" href="assignment5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECON5630</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#general-information"><i class="fa fa-check"></i><b>1.2</b> General Information</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#class-time"><i class="fa fa-check"></i><b>1.2.1</b> Class Time</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>1.2.2</b> Description</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#expectation-and-goals"><i class="fa fa-check"></i><b>1.2.3</b> Expectation and Goals</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#required-environment"><i class="fa fa-check"></i><b>1.3</b> Required Environment</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#evaluation"><i class="fa fa-check"></i><b>1.4</b> Evaluation</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#academic-integrity"><i class="fa fa-check"></i><b>1.5</b> Academic Integrity</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.6</b> Schedule</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#course-materials"><i class="fa fa-check"></i><b>1.7</b> Course Materials</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#code"><i class="fa fa-check"></i><b>1.7.1</b> Code</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.7.2</b> R and RStudio</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#handbook-chapters"><i class="fa fa-check"></i><b>1.7.3</b> Handbook Chapters</a></li>
<li class="chapter" data-level="1.7.4" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i><b>1.7.4</b> Books</a></li>
<li class="chapter" data-level="1.7.5" data-path="index.html"><a href="index.html#papers"><i class="fa fa-check"></i><b>1.7.5</b> Papers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-are-structural-models"><i class="fa fa-check"></i><b>2.1</b> What are structural models?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#example-linear-demand-and-supply-model"><i class="fa fa-check"></i><b>2.2</b> Example: Linear demand and supply model</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ordinary-least-squares-ols-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.3</b> Ordinary-Least-Squares (OLS) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#maximum-likelihood-estimation-mle-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.4</b> Maximum-Likelihood Estimation (MLE) of the demand and supply model</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#simulation-based-simulated-likelihood-or-simulated-method-of-moments-methods"><i class="fa fa-check"></i><b>2.5</b> Simulation-based (Simulated-Likelihood or Simulated-Method-of-Moments) methods</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#two-stage-least-squares-2sls-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.6</b> Two-Stage Least Squares (2SLS) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#instrumental-variables-iv-and-generalized-method-of-moments-gmm-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.7</b> Instrumental-Variables (IV) and Generalized Method of Moments (GMM) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#general-case"><i class="fa fa-check"></i><b>2.8</b> General Case</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#structural-estimation-and-counterfactual-analysis"><i class="fa fa-check"></i><b>2.9</b> Structural Estimation and Counterfactual Analysis</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="intro.html"><a href="intro.html#example"><i class="fa fa-check"></i><b>2.9.1</b> Example</a></li>
<li class="chapter" data-level="2.9.2" data-path="intro.html"><a href="intro.html#recap"><i class="fa fa-check"></i><b>2.9.2</b> Recap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="production.html"><a href="production.html"><i class="fa fa-check"></i><b>3</b> Production and Cost Function Estimation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="production.html"><a href="production.html#motivations"><i class="fa fa-check"></i><b>3.1</b> Motivations</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="production.html"><a href="production.html#io"><i class="fa fa-check"></i><b>3.1.1</b> IO</a></li>
<li class="chapter" data-level="3.1.2" data-path="production.html"><a href="production.html#development"><i class="fa fa-check"></i><b>3.1.2</b> Development</a></li>
<li class="chapter" data-level="3.1.3" data-path="production.html"><a href="production.html#trade"><i class="fa fa-check"></i><b>3.1.3</b> Trade</a></li>
<li class="chapter" data-level="3.1.4" data-path="production.html"><a href="production.html#management"><i class="fa fa-check"></i><b>3.1.4</b> Management</a></li>
<li class="chapter" data-level="3.1.5" data-path="production.html"><a href="production.html#education"><i class="fa fa-check"></i><b>3.1.5</b> Education</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="production.html"><a href="production.html#analyzing-producer-behaviors"><i class="fa fa-check"></i><b>3.2</b> Analyzing Producer Behaviors</a></li>
<li class="chapter" data-level="3.3" data-path="production.html"><a href="production.html#production-function-estimation"><i class="fa fa-check"></i><b>3.3</b> Production Function Estimation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="production.html"><a href="production.html#cobb-douglas-specification-as-a-benchmark"><i class="fa fa-check"></i><b>3.3.1</b> Cobb-Douglas Specification as a Benchmark</a></li>
<li class="chapter" data-level="3.3.2" data-path="production.html"><a href="production.html#potential-bias-i-endogeneity"><i class="fa fa-check"></i><b>3.3.2</b> Potential Bias I: Endogeneity</a></li>
<li class="chapter" data-level="3.3.3" data-path="production.html"><a href="production.html#potential-bias-ii-selection"><i class="fa fa-check"></i><b>3.3.3</b> Potential Bias II: Selection</a></li>
<li class="chapter" data-level="3.3.4" data-path="production.html"><a href="production.html#how-to-resolve-endogeneity-bias"><i class="fa fa-check"></i><b>3.3.4</b> How to Resolve Endogeneity Bias?</a></li>
<li class="chapter" data-level="3.3.5" data-path="production.html"><a href="production.html#panel-data"><i class="fa fa-check"></i><b>3.3.5</b> Panel Data</a></li>
<li class="chapter" data-level="3.3.6" data-path="production.html"><a href="production.html#first-order-condition-for-inputs"><i class="fa fa-check"></i><b>3.3.6</b> First-Order Condition for Inputs</a></li>
<li class="chapter" data-level="3.3.7" data-path="production.html"><a href="production.html#productioniv"><i class="fa fa-check"></i><b>3.3.7</b> Instrumental Variable</a></li>
<li class="chapter" data-level="3.3.8" data-path="production.html"><a href="production.html#olley-pakes-approach"><i class="fa fa-check"></i><b>3.3.8</b> Olley-Pakes Approach</a></li>
<li class="chapter" data-level="3.3.9" data-path="production.html"><a href="production.html#assumption-i-information-set"><i class="fa fa-check"></i><b>3.3.9</b> Assumption I: Information Set</a></li>
<li class="chapter" data-level="3.3.10" data-path="production.html"><a href="production.html#assumption-ii-first-order-markov"><i class="fa fa-check"></i><b>3.3.10</b> Assumption II: First Order Markov</a></li>
<li class="chapter" data-level="3.3.11" data-path="production.html"><a href="production.html#assumption-iii-timing-of-input-choices"><i class="fa fa-check"></i><b>3.3.11</b> Assumption III: Timing of Input Choices</a></li>
<li class="chapter" data-level="3.3.12" data-path="production.html"><a href="production.html#assumption-iv-scalar-unobservable"><i class="fa fa-check"></i><b>3.3.12</b> Assumption IV: Scalar Unobservable</a></li>
<li class="chapter" data-level="3.3.13" data-path="production.html"><a href="production.html#assumption-iv-strict-monotonicity"><i class="fa fa-check"></i><b>3.3.13</b> Assumption IV: Strict Monotonicity</a></li>
<li class="chapter" data-level="3.3.14" data-path="production.html"><a href="production.html#two-step-approach-the-first-step"><i class="fa fa-check"></i><b>3.3.14</b> Two-step Approach: The First Step</a></li>
<li class="chapter" data-level="3.3.15" data-path="production.html"><a href="production.html#two-step-approach-the-second-step"><i class="fa fa-check"></i><b>3.3.15</b> Two-step Approach: The Second Step</a></li>
<li class="chapter" data-level="3.3.16" data-path="production.html"><a href="production.html#identification-of-the-anticipated-shocks"><i class="fa fa-check"></i><b>3.3.16</b> Identification of the Anticipated Shocks</a></li>
<li class="chapter" data-level="3.3.17" data-path="production.html"><a href="production.html#two-step-estimation-of-olley1996."><i class="fa fa-check"></i><b>3.3.17</b> Two-Step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span>.</a></li>
<li class="chapter" data-level="3.3.18" data-path="production.html"><a href="production.html#from-an-economic-models-to-an-econometric-model"><i class="fa fa-check"></i><b>3.3.18</b> From An Economic Models to An Econometric Model</a></li>
<li class="chapter" data-level="3.3.19" data-path="production.html"><a href="production.html#how-to-resolve-selection-bias"><i class="fa fa-check"></i><b>3.3.19</b> How to Resolve Selection Bias</a></li>
<li class="chapter" data-level="3.3.20" data-path="production.html"><a href="production.html#correction-in-the-first-step"><i class="fa fa-check"></i><b>3.3.20</b> Correction in the First Step</a></li>
<li class="chapter" data-level="3.3.21" data-path="production.html"><a href="production.html#correction-in-the-second-step-i-the-source-of-bias"><i class="fa fa-check"></i><b>3.3.21</b> Correction in the Second Step I: The Source of Bias</a></li>
<li class="chapter" data-level="3.3.22" data-path="production.html"><a href="production.html#correction-in-the-second-step-ii-conditional-exit-probability"><i class="fa fa-check"></i><b>3.3.22</b> Correction in the Second Step II: Conditional Exit Probability</a></li>
<li class="chapter" data-level="3.3.23" data-path="production.html"><a href="production.html#correction-in-the-second-step-iii-invertibility-in-threshold"><i class="fa fa-check"></i><b>3.3.23</b> Correction in the Second Step III: Invertibility in Threshold</a></li>
<li class="chapter" data-level="3.3.24" data-path="production.html"><a href="production.html#correction-in-the-second-step-iv-controlling-the-threshold"><i class="fa fa-check"></i><b>3.3.24</b> Correction in the Second Step IV: Controlling the Threshold</a></li>
<li class="chapter" data-level="3.3.25" data-path="production.html"><a href="production.html#three-step-estimation-of-olley1996"><i class="fa fa-check"></i><b>3.3.25</b> Three Step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span></a></li>
<li class="chapter" data-level="3.3.26" data-path="production.html"><a href="production.html#zero-investment-problem"><i class="fa fa-check"></i><b>3.3.26</b> Zero Investment Problem</a></li>
<li class="chapter" data-level="3.3.27" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-i-discard-some-data"><i class="fa fa-check"></i><b>3.3.27</b> Tackle Zero Investment Problem I: Discard Some Data</a></li>
<li class="chapter" data-level="3.3.28" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-ii-use-another-proxy"><i class="fa fa-check"></i><b>3.3.28</b> Tackle Zero Investment Problem II: Use Another Proxy</a></li>
<li class="chapter" data-level="3.3.29" data-path="production.html"><a href="production.html#one-step-estimation-of-olley1996-and-levinsohn2003"><i class="fa fa-check"></i><b>3.3.29</b> One-step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span> and <span class="citation">Levinsohn &amp; Petrin (2003)</span></a></li>
<li class="chapter" data-level="3.3.30" data-path="production.html"><a href="production.html#scalar-unobservable-problem-finite-order-markov-process"><i class="fa fa-check"></i><b>3.3.30</b> Scalar Unobservable Problem: Finite-order Markov Process</a></li>
<li class="chapter" data-level="3.3.31" data-path="production.html"><a href="production.html#scalar-unobservable-problem-demand-and-productivity-shocks"><i class="fa fa-check"></i><b>3.3.31</b> Scalar Unobservable Problem: Demand and Productivity Shocks</a></li>
<li class="chapter" data-level="3.3.32" data-path="production.html"><a href="production.html#collinearity-problem"><i class="fa fa-check"></i><b>3.3.32</b> Collinearity Problem</a></li>
<li class="chapter" data-level="3.3.33" data-path="production.html"><a href="production.html#tackle-collinearity-problem-peculiar-assumptions"><i class="fa fa-check"></i><b>3.3.33</b> Tackle Collinearity Problem: Peculiar Assumptions</a></li>
<li class="chapter" data-level="3.3.34" data-path="production.html"><a href="production.html#tackle-collinearity-problem-share-regression"><i class="fa fa-check"></i><b>3.3.34</b> Tackle Collinearity Problem: Share Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="production.html"><a href="production.html#cost-function-estimation"><i class="fa fa-check"></i><b>3.4</b> Cost Function Estimation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="production.html"><a href="production.html#cost-function-duality"><i class="fa fa-check"></i><b>3.4.1</b> Cost Function: Duality</a></li>
<li class="chapter" data-level="3.4.2" data-path="production.html"><a href="production.html#translog-cost-function"><i class="fa fa-check"></i><b>3.4.2</b> Translog Cost Function</a></li>
<li class="chapter" data-level="3.4.3" data-path="production.html"><a href="production.html#translog-cost-function-integrability"><i class="fa fa-check"></i><b>3.4.3</b> Translog Cost Function: Integrability</a></li>
<li class="chapter" data-level="3.4.4" data-path="production.html"><a href="production.html#two-approaches"><i class="fa fa-check"></i><b>3.4.4</b> Two Approaches</a></li>
<li class="chapter" data-level="3.4.5" data-path="production.html"><a href="production.html#cost-data-approach"><i class="fa fa-check"></i><b>3.4.5</b> Cost Data Approach</a></li>
<li class="chapter" data-level="3.4.6" data-path="production.html"><a href="production.html#revealed-preference-approach"><i class="fa fa-check"></i><b>3.4.6</b> Revealed Preference Approach</a></li>
<li class="chapter" data-level="3.4.7" data-path="production.html"><a href="production.html#single-product-monopolist"><i class="fa fa-check"></i><b>3.4.7</b> Single-product Monopolist</a></li>
<li class="chapter" data-level="3.4.8" data-path="production.html"><a href="production.html#unobserved-heterogeneity-in-the-cost-function"><i class="fa fa-check"></i><b>3.4.8</b> Unobserved Heterogeneity in the Cost Function</a></li>
<li class="chapter" data-level="3.4.9" data-path="production.html"><a href="production.html#multi-product-monopolist-case"><i class="fa fa-check"></i><b>3.4.9</b> Multi-product Monopolist Case</a></li>
<li class="chapter" data-level="3.4.10" data-path="production.html"><a href="production.html#oligopoly"><i class="fa fa-check"></i><b>3.4.10</b> Oligopoly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="demand.html"><a href="demand.html"><i class="fa fa-check"></i><b>4</b> Demand Function Estimation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="demand.html"><a href="demand.html#motivations-1"><i class="fa fa-check"></i><b>4.1</b> Motivations</a></li>
<li class="chapter" data-level="4.2" data-path="demand.html"><a href="demand.html#analyzing-consumer-behaviors"><i class="fa fa-check"></i><b>4.2</b> Analyzing Consumer Behaviors</a></li>
<li class="chapter" data-level="4.3" data-path="demand.html"><a href="demand.html#continuous-choice"><i class="fa fa-check"></i><b>4.3</b> Continuous Choice</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="demand.html"><a href="demand.html#duality-between-utility-and-expenditure-functions"><i class="fa fa-check"></i><b>4.3.1</b> Duality between Utility and Expenditure Functions</a></li>
<li class="chapter" data-level="4.3.2" data-path="demand.html"><a href="demand.html#deriving-other-functions"><i class="fa fa-check"></i><b>4.3.2</b> Deriving Other Functions</a></li>
<li class="chapter" data-level="4.3.3" data-path="demand.html"><a href="demand.html#starting-from-an-indirect-utility-function"><i class="fa fa-check"></i><b>4.3.3</b> Starting from an Indirect Utility Function</a></li>
<li class="chapter" data-level="4.3.4" data-path="demand.html"><a href="demand.html#expenditure-share-equation"><i class="fa fa-check"></i><b>4.3.4</b> Expenditure Share Equation</a></li>
<li class="chapter" data-level="4.3.5" data-path="demand.html"><a href="demand.html#almost-ideal-demand-system-aids"><i class="fa fa-check"></i><b>4.3.5</b> Almost Ideal Demand System (AIDS)</a></li>
<li class="chapter" data-level="4.3.6" data-path="demand.html"><a href="demand.html#piglog-class"><i class="fa fa-check"></i><b>4.3.6</b> PIGLOG Class</a></li>
<li class="chapter" data-level="4.3.7" data-path="demand.html"><a href="demand.html#derive-the-share-equation-i"><i class="fa fa-check"></i><b>4.3.7</b> Derive the Share Equation I</a></li>
<li class="chapter" data-level="4.3.8" data-path="demand.html"><a href="demand.html#derive-the-share-equation-ii"><i class="fa fa-check"></i><b>4.3.8</b> Derive the Share Equation II</a></li>
<li class="chapter" data-level="4.3.9" data-path="demand.html"><a href="demand.html#specify-the-detail-ii"><i class="fa fa-check"></i><b>4.3.9</b> Specify the Detail II</a></li>
<li class="chapter" data-level="4.3.10" data-path="demand.html"><a href="demand.html#estimation"><i class="fa fa-check"></i><b>4.3.10</b> Estimation</a></li>
<li class="chapter" data-level="4.3.11" data-path="demand.html"><a href="demand.html#from-product-space-approach-to-characteristics-space-approach"><i class="fa fa-check"></i><b>4.3.11</b> From Product Space Approach to Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.3.12" data-path="demand.html"><a href="demand.html#from-continuous-choice-approach-to-discrete-choice-approach"><i class="fa fa-check"></i><b>4.3.12</b> From Continuous Choice Approach to Discrete Choice Approach</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="demand.html"><a href="demand.html#discrete-choice"><i class="fa fa-check"></i><b>4.4</b> Discrete Choice</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="demand.html"><a href="demand.html#discrete-choice-approach"><i class="fa fa-check"></i><b>4.4.1</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.2" data-path="demand.html"><a href="demand.html#discrete-choice-approach-1"><i class="fa fa-check"></i><b>4.4.2</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.3" data-path="demand.html"><a href="demand.html#discrete-choice-approach-2"><i class="fa fa-check"></i><b>4.4.3</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.4" data-path="demand.html"><a href="demand.html#characteristics-space-approach"><i class="fa fa-check"></i><b>4.4.4</b> Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.4.5" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect"><i class="fa fa-check"></i><b>4.4.5</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.6" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect-1"><i class="fa fa-check"></i><b>4.4.6</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.7" data-path="demand.html"><a href="demand.html#utility-function-normalization"><i class="fa fa-check"></i><b>4.4.7</b> Utility Function Normalization</a></li>
<li class="chapter" data-level="4.4.8" data-path="demand.html"><a href="demand.html#aggregation-of-the-individual-demand"><i class="fa fa-check"></i><b>4.4.8</b> Aggregation of the Individual Demand</a></li>
<li class="chapter" data-level="4.4.9" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation"><i class="fa fa-check"></i><b>4.4.9</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.10" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.10</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.11" data-path="demand.html"><a href="demand.html#vertical-product-differentiation"><i class="fa fa-check"></i><b>4.4.11</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.12" data-path="demand.html"><a href="demand.html#vertical-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.12</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.13" data-path="demand.html"><a href="demand.html#econometric-models"><i class="fa fa-check"></i><b>4.4.13</b> Econometric Models</a></li>
<li class="chapter" data-level="4.4.14" data-path="demand.html"><a href="demand.html#multinomial-logit-model-preference-shock"><i class="fa fa-check"></i><b>4.4.14</b> Multinomial Logit Model: Preference Shock</a></li>
<li class="chapter" data-level="4.4.15" data-path="demand.html"><a href="demand.html#multinomial-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.15</b> Multinomial Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.16" data-path="demand.html"><a href="demand.html#multinomial-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.16</b> Multinomial Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.17" data-path="demand.html"><a href="demand.html#multinomial-logit-model-inclusive-value"><i class="fa fa-check"></i><b>4.4.17</b> Multinomial Logit Model: Inclusive Value</a></li>
<li class="chapter" data-level="4.4.18" data-path="demand.html"><a href="demand.html#maximum-likelihood-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.18</b> Maximum Likelihood Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.19" data-path="demand.html"><a href="demand.html#nonlinear-least-square-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.19</b> Nonlinear Least Square Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.20" data-path="demand.html"><a href="demand.html#iia-problem"><i class="fa fa-check"></i><b>4.4.20</b> IIA Problem</a></li>
<li class="chapter" data-level="4.4.21" data-path="demand.html"><a href="demand.html#blue-bus-and-red-bus-problem"><i class="fa fa-check"></i><b>4.4.21</b> Blue Bus and Red Bus Problem</a></li>
<li class="chapter" data-level="4.4.22" data-path="demand.html"><a href="demand.html#restrictive-price-elasticity"><i class="fa fa-check"></i><b>4.4.22</b> Restrictive Price Elasticity</a></li>
<li class="chapter" data-level="4.4.23" data-path="demand.html"><a href="demand.html#monotonic-inclusive-value"><i class="fa fa-check"></i><b>4.4.23</b> Monotonic Inclusive Value</a></li>
<li class="chapter" data-level="4.4.24" data-path="demand.html"><a href="demand.html#the-source-of-the-problem"><i class="fa fa-check"></i><b>4.4.24</b> The Source of the Problem</a></li>
<li class="chapter" data-level="4.4.25" data-path="demand.html"><a href="demand.html#correlation-in-preference-shocks"><i class="fa fa-check"></i><b>4.4.25</b> Correlation in Preference Shocks</a></li>
<li class="chapter" data-level="4.4.26" data-path="demand.html"><a href="demand.html#observed-and-unobserved-consumer-heterogeneity"><i class="fa fa-check"></i><b>4.4.26</b> Observed and Unobserved Consumer Heterogeneity</a></li>
<li class="chapter" data-level="4.4.27" data-path="demand.html"><a href="demand.html#mixed-logit-model"><i class="fa fa-check"></i><b>4.4.27</b> Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.28" data-path="demand.html"><a href="demand.html#mixed-logit-model-parametric-assumptions"><i class="fa fa-check"></i><b>4.4.28</b> Mixed Logit Model : Parametric Assumptions</a></li>
<li class="chapter" data-level="4.4.29" data-path="demand.html"><a href="demand.html#mixed-logit-model-iia"><i class="fa fa-check"></i><b>4.4.29</b> Mixed Logit Model: IIA</a></li>
<li class="chapter" data-level="4.4.30" data-path="demand.html"><a href="demand.html#mixed-logit-moel-price-elasticities"><i class="fa fa-check"></i><b>4.4.30</b> Mixed Logit Moel: Price Elasticities</a></li>
<li class="chapter" data-level="4.4.31" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.31</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.32" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model-1"><i class="fa fa-check"></i><b>4.4.32</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.33" data-path="demand.html"><a href="demand.html#simulated-non-linear-least-square-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.33</b> Simulated Non-linear Least Square Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.34" data-path="demand.html"><a href="demand.html#numerical-integration-with-quadrature"><i class="fa fa-check"></i><b>4.4.34</b> Numerical Integration with Quadrature</a></li>
<li class="chapter" data-level="4.4.35" data-path="demand.html"><a href="demand.html#nested-logit-model-a-special-case-of-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.35</b> Nested Logit Model: A Special Case of Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.36" data-path="demand.html"><a href="demand.html#nested-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.36</b> Nested Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.37" data-path="demand.html"><a href="demand.html#nested-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.37</b> Nested Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.38" data-path="demand.html"><a href="demand.html#nested-logit-model-decomposition-of-the-choice-probability"><i class="fa fa-check"></i><b>4.4.38</b> Nested Logit Model: Decomposition of the Choice Probability</a></li>
<li class="chapter" data-level="4.4.39" data-path="demand.html"><a href="demand.html#discrete-choice-model-with-unobserved-fixed-effects"><i class="fa fa-check"></i><b>4.4.39</b> Discrete Choice Model with Unobserved Fixed Effects</a></li>
<li class="chapter" data-level="4.4.40" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.40</b> Unobserved Fixed Effects in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.41" data-path="demand.html"><a href="demand.html#instrumental-variables-and-inversion"><i class="fa fa-check"></i><b>4.4.41</b> Instrumental Variables and Inversion</a></li>
<li class="chapter" data-level="4.4.42" data-path="demand.html"><a href="demand.html#inversion-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.42</b> Inversion in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.43" data-path="demand.html"><a href="demand.html#market-invariant-product-specific-fixed-effects"><i class="fa fa-check"></i><b>4.4.43</b> Market-invariant Product-specific Fixed Effects</a></li>
<li class="chapter" data-level="4.4.44" data-path="demand.html"><a href="demand.html#unobserved-consumer-heterogeneity-and-unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.44</b> Unobserved Consumer Heterogeneity and Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.45" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.45</b> Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.46" data-path="demand.html"><a href="demand.html#representing-xi_jt-as-a-function-of-parameters-of-interest"><i class="fa fa-check"></i><b>4.4.46</b> Representing <span class="math inline">\(\xi_{jt}\)</span> as a Function of Parameters of Interest</a></li>
<li class="chapter" data-level="4.4.47" data-path="demand.html"><a href="demand.html#summarizing-the-conditional-mean-term"><i class="fa fa-check"></i><b>4.4.47</b> Summarizing the Conditional Mean Term</a></li>
<li class="chapter" data-level="4.4.48" data-path="demand.html"><a href="demand.html#contraction-mapping-for-delta_t."><i class="fa fa-check"></i><b>4.4.48</b> Contraction Mapping for <span class="math inline">\(\delta_t\)</span>.</a></li>
<li class="chapter" data-level="4.4.49" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta"><i class="fa fa-check"></i><b>4.4.49</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span></a></li>
<li class="chapter" data-level="4.4.50" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta-summary"><i class="fa fa-check"></i><b>4.4.50</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span>: Summary</a></li>
<li class="chapter" data-level="4.4.51" data-path="demand.html"><a href="demand.html#gmm-objective-function"><i class="fa fa-check"></i><b>4.4.51</b> GMM Objective Function</a></li>
<li class="chapter" data-level="4.4.52" data-path="demand.html"><a href="demand.html#estimating-linear-parameters"><i class="fa fa-check"></i><b>4.4.52</b> Estimating Linear Parameters</a></li>
<li class="chapter" data-level="4.4.53" data-path="demand.html"><a href="demand.html#blp-algorithm"><i class="fa fa-check"></i><b>4.4.53</b> BLP Algorithm</a></li>
<li class="chapter" data-level="4.4.54" data-path="demand.html"><a href="demand.html#mathematical-program-with-equilibrium-constraints-mpec"><i class="fa fa-check"></i><b>4.4.54</b> Mathematical Program with Equilibrium Constraints (MPEC)</a></li>
<li class="chapter" data-level="4.4.55" data-path="demand.html"><a href="demand.html#control-function-approach"><i class="fa fa-check"></i><b>4.4.55</b> Control Function Approach</a></li>
<li class="chapter" data-level="4.4.56" data-path="demand.html"><a href="demand.html#control-function-approach-1"><i class="fa fa-check"></i><b>4.4.56</b> Control Function Approach</a></li>
<li class="chapter" data-level="4.4.57" data-path="demand.html"><a href="demand.html#instrumental-variables"><i class="fa fa-check"></i><b>4.4.57</b> Instrumental Variables</a></li>
<li class="chapter" data-level="4.4.58" data-path="demand.html"><a href="demand.html#pyblp"><i class="fa fa-check"></i><b>4.4.58</b> PyBLP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="merger.html"><a href="merger.html"><i class="fa fa-check"></i><b>5</b> Merger Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="merger.html"><a href="merger.html#motivations-2"><i class="fa fa-check"></i><b>5.1</b> Motivations</a></li>
<li class="chapter" data-level="5.2" data-path="merger.html"><a href="merger.html#identification-of-conduct"><i class="fa fa-check"></i><b>5.2</b> Identification of Conduct</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="merger.html"><a href="merger.html#identification-of-conduct-1"><i class="fa fa-check"></i><b>5.2.1</b> Identification of Conduct</a></li>
<li class="chapter" data-level="5.2.2" data-path="merger.html"><a href="merger.html#marginal-revenue-function"><i class="fa fa-check"></i><b>5.2.2</b> Marginal Revenue Function</a></li>
<li class="chapter" data-level="5.2.3" data-path="merger.html"><a href="merger.html#first-order-condition"><i class="fa fa-check"></i><b>5.2.3</b> First-Order Condition</a></li>
<li class="chapter" data-level="5.2.4" data-path="merger.html"><a href="merger.html#linear-model"><i class="fa fa-check"></i><b>5.2.4</b> Linear Model</a></li>
<li class="chapter" data-level="5.2.5" data-path="merger.html"><a href="merger.html#pricing-equation"><i class="fa fa-check"></i><b>5.2.5</b> Pricing Equation</a></li>
<li class="chapter" data-level="5.2.6" data-path="merger.html"><a href="merger.html#identification-of-inverse-demand-function-and-pricing-equation"><i class="fa fa-check"></i><b>5.2.6</b> Identification of Inverse Demand Function and Pricing Equation</a></li>
<li class="chapter" data-level="5.2.7" data-path="merger.html"><a href="merger.html#the-conduct-parameter-is-unidentified"><i class="fa fa-check"></i><b>5.2.7</b> The Conduct Parameter is Unidentified</a></li>
<li class="chapter" data-level="5.2.8" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-when-cost-data-is-available"><i class="fa fa-check"></i><b>5.2.8</b> Identification of the Conduct Parameter: When Cost Data is Available</a></li>
<li class="chapter" data-level="5.2.9" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-when-cost-data-is-not-available"><i class="fa fa-check"></i><b>5.2.9</b> Identification of the Conduct Parameter: When Cost Data is Not Available</a></li>
<li class="chapter" data-level="5.2.10" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-demand-rotater-is-available"><i class="fa fa-check"></i><b>5.2.10</b> Identification of the Conduct Parameter: Demand Rotater is Available</a></li>
<li class="chapter" data-level="5.2.11" data-path="merger.html"><a href="merger.html#identification-of-conduct-in-differentiated-product-market"><i class="fa fa-check"></i><b>5.2.11</b> Identification of Conduct in Differentiated Product Market</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="merger.html"><a href="merger.html#merger-simulation"><i class="fa fa-check"></i><b>5.3</b> Merger Simulation</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="merger.html"><a href="merger.html#unilateral-and-coordinated-effects-of-a-horizontal-merger"><i class="fa fa-check"></i><b>5.3.1</b> Unilateral and Coordinated Effects of a Horizontal Merger</a></li>
<li class="chapter" data-level="5.3.2" data-path="merger.html"><a href="merger.html#merger-simulation-1"><i class="fa fa-check"></i><b>5.3.2</b> Merger Simulation</a></li>
<li class="chapter" data-level="5.3.3" data-path="merger.html"><a href="merger.html#quantifying-the-unilateral-effect"><i class="fa fa-check"></i><b>5.3.3</b> Quantifying the Unilateral Effect</a></li>
<li class="chapter" data-level="5.3.4" data-path="merger.html"><a href="merger.html#pre-merger-equilibrium"><i class="fa fa-check"></i><b>5.3.4</b> Pre-Merger Equilibrium</a></li>
<li class="chapter" data-level="5.3.5" data-path="merger.html"><a href="merger.html#post-merger-equilibrium"><i class="fa fa-check"></i><b>5.3.5</b> Post-Merger Equilibrium</a></li>
<li class="chapter" data-level="5.3.6" data-path="merger.html"><a href="merger.html#consumer-surplus"><i class="fa fa-check"></i><b>5.3.6</b> Consumer Surplus</a></li>
<li class="chapter" data-level="5.3.7" data-path="merger.html"><a href="merger.html#quantifying-the-coordinated-effect"><i class="fa fa-check"></i><b>5.3.7</b> Quantifying the Coordinated Effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="entryexit.html"><a href="entryexit.html"><i class="fa fa-check"></i><b>6</b> Entry and Exit</a>
<ul>
<li class="chapter" data-level="6.1" data-path="entryexit.html"><a href="entryexit.html#motivations-3"><i class="fa fa-check"></i><b>6.1</b> Motivations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="entryexit.html"><a href="entryexit.html#entry-cost-mode-of-competition-and-market-structure"><i class="fa fa-check"></i><b>6.1.1</b> Entry Cost, Mode of Competition, and Market Structure</a></li>
<li class="chapter" data-level="6.1.2" data-path="entryexit.html"><a href="entryexit.html#exogenous-and-endogenous-entry-cost"><i class="fa fa-check"></i><b>6.1.2</b> Exogenous and Endogenous Entry Cost</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="entryexit.html"><a href="entryexit.html#monopoly-entry"><i class="fa fa-check"></i><b>6.2</b> Monopoly Entry</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="entryexit.html"><a href="entryexit.html#variable-profits-and-fixed-costs"><i class="fa fa-check"></i><b>6.2.1</b> Variable Profits and Fixed Costs</a></li>
<li class="chapter" data-level="6.2.2" data-path="entryexit.html"><a href="entryexit.html#non-identification"><i class="fa fa-check"></i><b>6.2.2</b> Non-Identification</a></li>
<li class="chapter" data-level="6.2.3" data-path="entryexit.html"><a href="entryexit.html#restrictions-for-identification."><i class="fa fa-check"></i><b>6.2.3</b> Restrictions for Identification.</a></li>
<li class="chapter" data-level="6.2.4" data-path="entryexit.html"><a href="entryexit.html#homogeneous-of-degree-1-variable-profits"><i class="fa fa-check"></i><b>6.2.4</b> Homogeneous of Degree 1 Variable Profits</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="entryexit.html"><a href="entryexit.html#complete-information-homogeneous-oligopoly-entry"><i class="fa fa-check"></i><b>6.3</b> Complete-Information Homogeneous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="entryexit.html"><a href="entryexit.html#variable-and-fixed-costs"><i class="fa fa-check"></i><b>6.3.1</b> Variable and Fixed Costs</a></li>
<li class="chapter" data-level="6.3.2" data-path="entryexit.html"><a href="entryexit.html#equilibrium-condition"><i class="fa fa-check"></i><b>6.3.2</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="6.3.3" data-path="entryexit.html"><a href="entryexit.html#identification-under-a-shape-restriction"><i class="fa fa-check"></i><b>6.3.3</b> Identification under a Shape Restriction</a></li>
<li class="chapter" data-level="6.3.4" data-path="entryexit.html"><a href="entryexit.html#log-likelihood-function"><i class="fa fa-check"></i><b>6.3.4</b> Log Likelihood Function</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="entryexit.html"><a href="entryexit.html#complete-information-heterogeneous-oligopoly-entry"><i class="fa fa-check"></i><b>6.4</b> Complete-Information Heterogeneous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="entryexit.html"><a href="entryexit.html#bivartiate-game-with-heterogeneous-profits"><i class="fa fa-check"></i><b>6.4.1</b> Bivartiate Game with Heterogeneous Profits</a></li>
<li class="chapter" data-level="6.4.2" data-path="entryexit.html"><a href="entryexit.html#sampling-assumption-and-observations"><i class="fa fa-check"></i><b>6.4.2</b> Sampling Assumption and Observations</a></li>
<li class="chapter" data-level="6.4.3" data-path="entryexit.html"><a href="entryexit.html#identification-assuming-pure-strategy-equilibrium"><i class="fa fa-check"></i><b>6.4.3</b> Identification Assuming Pure-Strategy Equilibrium</a></li>
<li class="chapter" data-level="6.4.4" data-path="entryexit.html"><a href="entryexit.html#heterogeneous-independent-fixed-costs"><i class="fa fa-check"></i><b>6.4.4</b> Heterogeneous Independent Fixed Costs</a></li>
<li class="chapter" data-level="6.4.5" data-path="entryexit.html"><a href="entryexit.html#heterogenous-and-market-level-correlated-fixed-costs"><i class="fa fa-check"></i><b>6.4.5</b> Heterogenous and Market-Level Correlated Fixed Costs</a></li>
<li class="chapter" data-level="6.4.6" data-path="entryexit.html"><a href="entryexit.html#inference-based-on-a-unique-prediction"><i class="fa fa-check"></i><b>6.4.6</b> Inference Based On a Unique Prediction</a></li>
<li class="chapter" data-level="6.4.7" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-one-shot-game"><i class="fa fa-check"></i><b>6.4.7</b> Entry in the Airline Industry: One-shot Game</a></li>
<li class="chapter" data-level="6.4.8" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-profit-function"><i class="fa fa-check"></i><b>6.4.8</b> Entry in the Airline Industry: Profit Function</a></li>
<li class="chapter" data-level="6.4.9" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-profit-function-1"><i class="fa fa-check"></i><b>6.4.9</b> Entry in the Airline Industry: Profit Function</a></li>
<li class="chapter" data-level="6.4.10" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-likelihood-function"><i class="fa fa-check"></i><b>6.4.10</b> Entry in the Airline Industry: Likelihood Function</a></li>
<li class="chapter" data-level="6.4.11" data-path="entryexit.html"><a href="entryexit.html#is-the-equilibrium-number-of-firms-unique"><i class="fa fa-check"></i><b>6.4.11</b> Is the Equilibrium Number of Firms Unique?</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="entryexit.html"><a href="entryexit.html#multiple-prediction"><i class="fa fa-check"></i><b>6.5</b> Multiple Prediction</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="entryexit.html"><a href="entryexit.html#multiple-equilibria-in-bivariate-game-with-heterogenous-profits"><i class="fa fa-check"></i><b>6.5.1</b> Multiple Equilibria in Bivariate Game with Heterogenous Profits</a></li>
<li class="chapter" data-level="6.5.2" data-path="entryexit.html"><a href="entryexit.html#multiple-prediction-in-bivariate-game-with-heterogenous-profits"><i class="fa fa-check"></i><b>6.5.2</b> Multiple Prediction in Bivariate Game with Heterogenous Profits</a></li>
<li class="chapter" data-level="6.5.3" data-path="entryexit.html"><a href="entryexit.html#inference-based-on-moment-inequalities"><i class="fa fa-check"></i><b>6.5.3</b> Inference Based on Moment Inequalities</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="entryexit.html"><a href="entryexit.html#incompelete-information-heterogenous-oligopoly-entry"><i class="fa fa-check"></i><b>6.6</b> Incompelete-Information Heterogenous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="entryexit.html"><a href="entryexit.html#bivariate-case"><i class="fa fa-check"></i><b>6.6.1</b> Bivariate Case</a></li>
<li class="chapter" data-level="6.6.2" data-path="entryexit.html"><a href="entryexit.html#the-equilibrium-strategy-and-belief"><i class="fa fa-check"></i><b>6.6.2</b> The Equilibrium Strategy and Belief</a></li>
<li class="chapter" data-level="6.6.3" data-path="entryexit.html"><a href="entryexit.html#equilibrium-selection-and-likelihood"><i class="fa fa-check"></i><b>6.6.3</b> Equilibrium Selection and Likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dynamics.html"><a href="dynamics.html"><i class="fa fa-check"></i><b>7</b> Dynamic Decision Model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dynamics.html"><a href="dynamics.html#motivations-4"><i class="fa fa-check"></i><b>7.1</b> Motivations</a></li>
<li class="chapter" data-level="7.2" data-path="dynamics.html"><a href="dynamics.html#single-agent-model"><i class="fa fa-check"></i><b>7.2</b> Single-Agent Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="dynamics.html"><a href="dynamics.html#setting"><i class="fa fa-check"></i><b>7.2.1</b> Setting</a></li>
<li class="chapter" data-level="7.2.2" data-path="dynamics.html"><a href="dynamics.html#timing-of-the-model"><i class="fa fa-check"></i><b>7.2.2</b> Timing of the Model</a></li>
<li class="chapter" data-level="7.2.3" data-path="dynamics.html"><a href="dynamics.html#period-payoff"><i class="fa fa-check"></i><b>7.2.3</b> Period Payoff</a></li>
<li class="chapter" data-level="7.2.4" data-path="dynamics.html"><a href="dynamics.html#markovian-framework"><i class="fa fa-check"></i><b>7.2.4</b> Markovian Framework</a></li>
<li class="chapter" data-level="7.2.5" data-path="dynamics.html"><a href="dynamics.html#belief"><i class="fa fa-check"></i><b>7.2.5</b> Belief</a></li>
<li class="chapter" data-level="7.2.6" data-path="dynamics.html"><a href="dynamics.html#decision-problem"><i class="fa fa-check"></i><b>7.2.6</b> Decision Problem</a></li>
<li class="chapter" data-level="7.2.7" data-path="dynamics.html"><a href="dynamics.html#value-function-and-ex-ante-value-function"><i class="fa fa-check"></i><b>7.2.7</b> Value Function and Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.2.8" data-path="dynamics.html"><a href="dynamics.html#choice-specific-value-function"><i class="fa fa-check"></i><b>7.2.8</b> Choice-specific Value Function</a></li>
<li class="chapter" data-level="7.2.9" data-path="dynamics.html"><a href="dynamics.html#optimality-condition"><i class="fa fa-check"></i><b>7.2.9</b> Optimality Condition</a></li>
<li class="chapter" data-level="7.2.10" data-path="dynamics.html"><a href="dynamics.html#optimal-conditional-choice-probability"><i class="fa fa-check"></i><b>7.2.10</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.2.11" data-path="dynamics.html"><a href="dynamics.html#optimality-condition-1"><i class="fa fa-check"></i><b>7.2.11</b> Optimality Condition</a></li>
<li class="chapter" data-level="7.2.12" data-path="dynamics.html"><a href="dynamics.html#mapping-from-a-conditional-choice-probability-to-an-ex-ante-value-function"><i class="fa fa-check"></i><b>7.2.12</b> Mapping from a Conditional Choice Probability to an Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.2.13" data-path="dynamics.html"><a href="dynamics.html#mapping-from-an-ex-ante-value-function-to-an-optimal-conditional-choice-probability"><i class="fa fa-check"></i><b>7.2.13</b> Mapping from an Ex-ante Value Function to an Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.2.14" data-path="dynamics.html"><a href="dynamics.html#the-optimality-conditions"><i class="fa fa-check"></i><b>7.2.14</b> The Optimality Conditions</a></li>
<li class="chapter" data-level="7.2.15" data-path="dynamics.html"><a href="dynamics.html#fixed-point-algorithm"><i class="fa fa-check"></i><b>7.2.15</b> Fixed-point Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="dynamics.html"><a href="dynamics.html#identification"><i class="fa fa-check"></i><b>7.3</b> Identification</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="dynamics.html"><a href="dynamics.html#unidentification-result"><i class="fa fa-check"></i><b>7.3.1</b> Unidentification Result</a></li>
<li class="chapter" data-level="7.3.2" data-path="dynamics.html"><a href="dynamics.html#identification-when-beta-and-f-is-known"><i class="fa fa-check"></i><b>7.3.2</b> Identification when <span class="math inline">\(\beta\)</span> and <span class="math inline">\(F\)</span> is Known</a></li>
<li class="chapter" data-level="7.3.3" data-path="dynamics.html"><a href="dynamics.html#crucial-assumptions-for-the-argument"><i class="fa fa-check"></i><b>7.3.3</b> Crucial Assumptions for the Argument</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="dynamics.html"><a href="dynamics.html#estimation-by-nested-fixed-point-algorithm"><i class="fa fa-check"></i><b>7.4</b> Estimation by Nested Fixed-point Algorithm</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="dynamics.html"><a href="dynamics.html#nested-fixed-point-algorithm"><i class="fa fa-check"></i><b>7.4.1</b> Nested Fixed-Point Algorithm</a></li>
<li class="chapter" data-level="7.4.2" data-path="dynamics.html"><a href="dynamics.html#solving-for-the-ex-ante-value-function"><i class="fa fa-check"></i><b>7.4.2</b> Solving for the Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.4.3" data-path="dynamics.html"><a href="dynamics.html#estimation-by-nested-fixed-point-algorithm-1"><i class="fa fa-check"></i><b>7.4.3</b> Estimation by Nested Fixed-Point Algorithm</a></li>
<li class="chapter" data-level="7.4.4" data-path="dynamics.html"><a href="dynamics.html#full-and-partial-likelihood"><i class="fa fa-check"></i><b>7.4.4</b> Full and Partial Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="dynamics.html"><a href="dynamics.html#estimation-by-conditional-choice-probability-ccp-approach"><i class="fa fa-check"></i><b>7.5</b> Estimation by Conditional Choice Probability (CCP) Approach</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="dynamics.html"><a href="dynamics.html#ccp-approach"><i class="fa fa-check"></i><b>7.5.1</b> CCP Approach</a></li>
<li class="chapter" data-level="7.5.2" data-path="dynamics.html"><a href="dynamics.html#first-step-estimating-ccp"><i class="fa fa-check"></i><b>7.5.2</b> First Step: Estimating CCP</a></li>
<li class="chapter" data-level="7.5.3" data-path="dynamics.html"><a href="dynamics.html#first-step-estimating-ccp-1"><i class="fa fa-check"></i><b>7.5.3</b> First Step: Estimating CCP</a></li>
<li class="chapter" data-level="7.5.4" data-path="dynamics.html"><a href="dynamics.html#second-step-estimating-structural-parameters"><i class="fa fa-check"></i><b>7.5.4</b> Second Step: Estimating Structural Parameters</a></li>
<li class="chapter" data-level="7.5.5" data-path="dynamics.html"><a href="dynamics.html#second-step-estimating-structural-parameters-1"><i class="fa fa-check"></i><b>7.5.5</b> Second Step: Estimating Structural Parameters</a></li>
<li class="chapter" data-level="7.5.6" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution"><i class="fa fa-check"></i><b>7.5.6</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.7" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-1"><i class="fa fa-check"></i><b>7.5.7</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.8" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-2"><i class="fa fa-check"></i><b>7.5.8</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.9" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-3"><i class="fa fa-check"></i><b>7.5.9</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.10" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-4"><i class="fa fa-check"></i><b>7.5.10</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.11" data-path="dynamics.html"><a href="dynamics.html#general-distribution"><i class="fa fa-check"></i><b>7.5.11</b> General Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="dynamics.html"><a href="dynamics.html#unobserved-heterogeneity"><i class="fa fa-check"></i><b>7.6</b> Unobserved Heterogeneity</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="dynamics.html"><a href="dynamics.html#dynamic-decision-model-with-a-finite-mixture"><i class="fa fa-check"></i><b>7.6.1</b> Dynamic Decision Model with a Finite Mixture</a></li>
<li class="chapter" data-level="7.6.2" data-path="dynamics.html"><a href="dynamics.html#setting-1"><i class="fa fa-check"></i><b>7.6.2</b> Setting</a></li>
<li class="chapter" data-level="7.6.3" data-path="dynamics.html"><a href="dynamics.html#observation"><i class="fa fa-check"></i><b>7.6.3</b> Observation</a></li>
<li class="chapter" data-level="7.6.4" data-path="dynamics.html"><a href="dynamics.html#assumptions-finite-mixture"><i class="fa fa-check"></i><b>7.6.4</b> Further Assumptions</a></li>
<li class="chapter" data-level="7.6.5" data-path="dynamics.html"><a href="dynamics.html#lower-dimensional-submodels"><i class="fa fa-check"></i><b>7.6.5</b> Lower-dimensional Submodels</a></li>
<li class="chapter" data-level="7.6.6" data-path="dynamics.html"><a href="dynamics.html#notations"><i class="fa fa-check"></i><b>7.6.6</b> Notations</a></li>
<li class="chapter" data-level="7.6.7" data-path="dynamics.html"><a href="dynamics.html#notations-for-parameters-to-be-identified"><i class="fa fa-check"></i><b>7.6.7</b> Notations for Parameters to be Identified</a></li>
<li class="chapter" data-level="7.6.8" data-path="dynamics.html"><a href="dynamics.html#notations-for-observables"><i class="fa fa-check"></i><b>7.6.8</b> Notations for Observables</a></li>
<li class="chapter" data-level="7.6.9" data-path="dynamics.html"><a href="dynamics.html#sufficient-condition-for-identification"><i class="fa fa-check"></i><b>7.6.9</b> Sufficient Condition for Identification</a></li>
<li class="chapter" data-level="7.6.10" data-path="dynamics.html"><a href="dynamics.html#remarks-on-the-theorem"><i class="fa fa-check"></i><b>7.6.10</b> Remarks on the Theorem</a></li>
<li class="chapter" data-level="7.6.11" data-path="dynamics.html"><a href="dynamics.html#factorization-equations"><i class="fa fa-check"></i><b>7.6.11</b> Factorization Equations</a></li>
<li class="chapter" data-level="7.6.12" data-path="dynamics.html"><a href="dynamics.html#sketch-of-the-proof"><i class="fa fa-check"></i><b>7.6.12</b> Sketch of the Proof</a></li>
<li class="chapter" data-level="7.6.13" data-path="dynamics.html"><a href="dynamics.html#constructive-estimation"><i class="fa fa-check"></i><b>7.6.13</b> Constructive Estimation</a></li>
<li class="chapter" data-level="7.6.14" data-path="dynamics.html"><a href="dynamics.html#estimation-by-an-em-algorithm"><i class="fa fa-check"></i><b>7.6.14</b> Estimation by an EM Algorithm</a></li>
<li class="chapter" data-level="7.6.15" data-path="dynamics.html"><a href="dynamics.html#idea"><i class="fa fa-check"></i><b>7.6.15</b> Idea</a></li>
<li class="chapter" data-level="7.6.16" data-path="dynamics.html"><a href="dynamics.html#optimal-conditional-choice-probability-1"><i class="fa fa-check"></i><b>7.6.16</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.6.17" data-path="dynamics.html"><a href="dynamics.html#likelihood-functions"><i class="fa fa-check"></i><b>7.6.17</b> Likelihood Functions</a></li>
<li class="chapter" data-level="7.6.18" data-path="dynamics.html"><a href="dynamics.html#expectation-step"><i class="fa fa-check"></i><b>7.6.18</b> Expectation Step</a></li>
<li class="chapter" data-level="7.6.19" data-path="dynamics.html"><a href="dynamics.html#maximization-step"><i class="fa fa-check"></i><b>7.6.19</b> Maximization Step</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="dynamicgame.html"><a href="dynamicgame.html"><i class="fa fa-check"></i><b>8</b> Dynamic Game</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dynamicgame.html"><a href="dynamicgame.html#multiple-agent-model"><i class="fa fa-check"></i><b>8.1</b> Multiple-Agent Model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-2"><i class="fa fa-check"></i><b>8.1.1</b> Setting</a></li>
<li class="chapter" data-level="8.1.2" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-model-1"><i class="fa fa-check"></i><b>8.1.2</b> Timing of the Model</a></li>
<li class="chapter" data-level="8.1.3" data-path="dynamicgame.html"><a href="dynamicgame.html#period-profit"><i class="fa fa-check"></i><b>8.1.3</b> Period Profit</a></li>
<li class="chapter" data-level="8.1.4" data-path="dynamicgame.html"><a href="dynamicgame.html#belief-1"><i class="fa fa-check"></i><b>8.1.4</b> Belief</a></li>
<li class="chapter" data-level="8.1.5" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium"><i class="fa fa-check"></i><b>8.1.5</b> Markov Perfect Equilibrium</a></li>
<li class="chapter" data-level="8.1.6" data-path="dynamicgame.html"><a href="dynamicgame.html#ex-ante-value-function"><i class="fa fa-check"></i><b>8.1.6</b> Ex-ante Value Function</a></li>
<li class="chapter" data-level="8.1.7" data-path="dynamicgame.html"><a href="dynamicgame.html#choice-specific-value-function-1"><i class="fa fa-check"></i><b>8.1.7</b> Choice-specific Value Function</a></li>
<li class="chapter" data-level="8.1.8" data-path="dynamicgame.html"><a href="dynamicgame.html#optimality-condition-2"><i class="fa fa-check"></i><b>8.1.8</b> Optimality Condition</a></li>
<li class="chapter" data-level="8.1.9" data-path="dynamicgame.html"><a href="dynamicgame.html#optimal-conditional-choice-probability-2"><i class="fa fa-check"></i><b>8.1.9</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="8.1.10" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium-condition-1"><i class="fa fa-check"></i><b>8.1.10</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="8.1.11" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium-condition-2"><i class="fa fa-check"></i><b>8.1.11</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="8.1.12" data-path="dynamicgame.html"><a href="dynamicgame.html#single-path-of-play"><i class="fa fa-check"></i><b>8.1.12</b> Single Path of Play</a></li>
<li class="chapter" data-level="8.1.13" data-path="dynamicgame.html"><a href="dynamicgame.html#identification-1"><i class="fa fa-check"></i><b>8.1.13</b> Identification</a></li>
<li class="chapter" data-level="8.1.14" data-path="dynamicgame.html"><a href="dynamicgame.html#estimation-ccp-approach"><i class="fa fa-check"></i><b>8.1.14</b> Estimation: CCP Approach</a></li>
<li class="chapter" data-level="8.1.15" data-path="dynamicgame.html"><a href="dynamicgame.html#computing-psi"><i class="fa fa-check"></i><b>8.1.15</b> Computing <span class="math inline">\(\Psi\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="dynamicgame.html"><a href="dynamicgame.html#with-continuous-dynamic-choice"><i class="fa fa-check"></i><b>8.2</b> With Continuous Dynamic Choice</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="dynamicgame.html"><a href="dynamicgame.html#continuous-control"><i class="fa fa-check"></i><b>8.2.1</b> Continuous Control</a></li>
<li class="chapter" data-level="8.2.2" data-path="dynamicgame.html"><a href="dynamicgame.html#period-payoff-1"><i class="fa fa-check"></i><b>8.2.2</b> Period Payoff</a></li>
<li class="chapter" data-level="8.2.3" data-path="dynamicgame.html"><a href="dynamicgame.html#policy-function-estimation-with-continuous-control"><i class="fa fa-check"></i><b>8.2.3</b> Policy Function Estimation with Continuous Control</a></li>
<li class="chapter" data-level="8.2.4" data-path="dynamicgame.html"><a href="dynamicgame.html#converting-to-the-standard-discrete-choice-model"><i class="fa fa-check"></i><b>8.2.4</b> Converting to the Standard Discrete Choice Model</a></li>
<li class="chapter" data-level="8.2.5" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-based-ccp-approach"><i class="fa fa-check"></i><b>8.2.5</b> Value Function Based CCP Approach</a></li>
<li class="chapter" data-level="8.2.6" data-path="dynamicgame.html"><a href="dynamicgame.html#approximating-the-ex-ante-value-function"><i class="fa fa-check"></i><b>8.2.6</b> Approximating the Ex-ante Value Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="dynamicgame.html"><a href="dynamicgame.html#dynamic-oligopoly-model"><i class="fa fa-check"></i><b>8.3</b> Dynamic Oligopoly Model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="dynamicgame.html"><a href="dynamicgame.html#ryancostenvironmentregulation2012"><i class="fa fa-check"></i><b>8.3.1</b> <span class="citation">Ryan (2012)</span></a></li>
<li class="chapter" data-level="8.3.2" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-3"><i class="fa fa-check"></i><b>8.3.2</b> Setting</a></li>
<li class="chapter" data-level="8.3.3" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-game"><i class="fa fa-check"></i><b>8.3.3</b> Timing of the Game</a></li>
<li class="chapter" data-level="8.3.4" data-path="dynamicgame.html"><a href="dynamicgame.html#demand-function"><i class="fa fa-check"></i><b>8.3.4</b> Demand Function</a></li>
<li class="chapter" data-level="8.3.5" data-path="dynamicgame.html"><a href="dynamicgame.html#production-cost-function"><i class="fa fa-check"></i><b>8.3.5</b> Production Cost Function</a></li>
<li class="chapter" data-level="8.3.6" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-cost"><i class="fa fa-check"></i><b>8.3.6</b> Investment Cost</a></li>
<li class="chapter" data-level="8.3.7" data-path="dynamicgame.html"><a href="dynamicgame.html#entry-and-exit-costs"><i class="fa fa-check"></i><b>8.3.7</b> Entry and Exit Costs</a></li>
<li class="chapter" data-level="8.3.8" data-path="dynamicgame.html"><a href="dynamicgame.html#period-profit-function"><i class="fa fa-check"></i><b>8.3.8</b> Period Profit Function</a></li>
<li class="chapter" data-level="8.3.9" data-path="dynamicgame.html"><a href="dynamicgame.html#transition"><i class="fa fa-check"></i><b>8.3.9</b> Transition</a></li>
<li class="chapter" data-level="8.3.10" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium"><i class="fa fa-check"></i><b>8.3.10</b> Equilibrium</a></li>
<li class="chapter" data-level="8.3.11" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-for-incumbents"><i class="fa fa-check"></i><b>8.3.11</b> Value Function for Incumbents</a></li>
<li class="chapter" data-level="8.3.12" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-for-entrants"><i class="fa fa-check"></i><b>8.3.12</b> Value Function for Entrants</a></li>
<li class="chapter" data-level="8.3.13" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium-1"><i class="fa fa-check"></i><b>8.3.13</b> Markov Perfect Equilibrium</a></li>
<li class="chapter" data-level="8.3.14" data-path="dynamicgame.html"><a href="dynamicgame.html#demand-and-production-cost-estimation"><i class="fa fa-check"></i><b>8.3.14</b> Demand and Production Cost Estimation</a></li>
<li class="chapter" data-level="8.3.15" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-policy-function-estimation"><i class="fa fa-check"></i><b>8.3.15</b> Investment Policy Function Estimation</a></li>
<li class="chapter" data-level="8.3.16" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-policy-function-estimation-1"><i class="fa fa-check"></i><b>8.3.16</b> Investment Policy Function Estimation</a></li>
<li class="chapter" data-level="8.3.17" data-path="dynamicgame.html"><a href="dynamicgame.html#entry-and-exit-policy-functions"><i class="fa fa-check"></i><b>8.3.17</b> Entry and Exit Policy Functions</a></li>
<li class="chapter" data-level="8.3.18" data-path="dynamicgame.html"><a href="dynamicgame.html#bbl-estimation"><i class="fa fa-check"></i><b>8.3.18</b> BBL Estimation</a></li>
<li class="chapter" data-level="8.3.19" data-path="dynamicgame.html"><a href="dynamicgame.html#structural-parameters-estimation-results"><i class="fa fa-check"></i><b>8.3.19</b> Structural Parameters Estimation Results</a></li>
<li class="chapter" data-level="8.3.20" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation"><i class="fa fa-check"></i><b>8.3.20</b> Counterfactual Simulation</a></li>
<li class="chapter" data-level="8.3.21" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation-results"><i class="fa fa-check"></i><b>8.3.21</b> Counterfactual Simulation Results</a></li>
<li class="chapter" data-level="8.3.22" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation-estimation-results"><i class="fa fa-check"></i><b>8.3.22</b> Counterfactual Simulation Estimation Results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="dynamicgame.html"><a href="dynamicgame.html#dynamic-oligopoly-with-many-firms"><i class="fa fa-check"></i><b>8.4</b> Dynamic Oligopoly with Many Firms</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-4"><i class="fa fa-check"></i><b>8.4.1</b> Setting</a></li>
<li class="chapter" data-level="8.4.2" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-game-1"><i class="fa fa-check"></i><b>8.4.2</b> Timing of the Game</a></li>
<li class="chapter" data-level="8.4.3" data-path="dynamicgame.html"><a href="dynamicgame.html#assumptions"><i class="fa fa-check"></i><b>8.4.3</b> Assumptions</a></li>
<li class="chapter" data-level="8.4.4" data-path="dynamicgame.html"><a href="dynamicgame.html#strategy-profile"><i class="fa fa-check"></i><b>8.4.4</b> Strategy Profile</a></li>
<li class="chapter" data-level="8.4.5" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function"><i class="fa fa-check"></i><b>8.4.5</b> Value Function</a></li>
<li class="chapter" data-level="8.4.6" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium-2"><i class="fa fa-check"></i><b>8.4.6</b> Markov-perfect Equilibrium</a></li>
<li class="chapter" data-level="8.4.7" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-strategy"><i class="fa fa-check"></i><b>8.4.7</b> Oblivious Strategy</a></li>
<li class="chapter" data-level="8.4.8" data-path="dynamicgame.html"><a href="dynamicgame.html#long-run-average-industry-state"><i class="fa fa-check"></i><b>8.4.8</b> Long-run Average Industry State</a></li>
<li class="chapter" data-level="8.4.9" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-value-function"><i class="fa fa-check"></i><b>8.4.9</b> Oblivious Value Function</a></li>
<li class="chapter" data-level="8.4.10" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-equilibrium"><i class="fa fa-check"></i><b>8.4.10</b> Oblivious Equilibrium</a></li>
<li class="chapter" data-level="8.4.11" data-path="dynamicgame.html"><a href="dynamicgame.html#asymptotic-results-and-extensions"><i class="fa fa-check"></i><b>8.4.11</b> Asymptotic Results and Extensions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="auction.html"><a href="auction.html"><i class="fa fa-check"></i><b>9</b> Auction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="auction.html"><a href="auction.html#general-symmetric-information-model"><i class="fa fa-check"></i><b>9.1</b> General symmetric information model</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="auction.html"><a href="auction.html#setting-5"><i class="fa fa-check"></i><b>9.1.1</b> Setting</a></li>
<li class="chapter" data-level="9.1.2" data-path="auction.html"><a href="auction.html#discussion-about-the-asssumptions"><i class="fa fa-check"></i><b>9.1.2</b> Discussion About the Asssumptions</a></li>
<li class="chapter" data-level="9.1.3" data-path="auction.html"><a href="auction.html#bidding-strategy"><i class="fa fa-check"></i><b>9.1.3</b> Bidding Strategy</a></li>
<li class="chapter" data-level="9.1.4" data-path="auction.html"><a href="auction.html#special-cases"><i class="fa fa-check"></i><b>9.1.4</b> Special Cases</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="auction.html"><a href="auction.html#second-price-auctions"><i class="fa fa-check"></i><b>9.2</b> Second-Price Auctions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="auction.html"><a href="auction.html#the-button-auction"><i class="fa fa-check"></i><b>9.2.1</b> The Button Auction</a></li>
<li class="chapter" data-level="9.2.2" data-path="auction.html"><a href="auction.html#equilibrium-bidding-strategies"><i class="fa fa-check"></i><b>9.2.2</b> Equilibrium Bidding Strategies</a></li>
<li class="chapter" data-level="9.2.3" data-path="auction.html"><a href="auction.html#reserve-price"><i class="fa fa-check"></i><b>9.2.3</b> Reserve Price</a></li>
<li class="chapter" data-level="9.2.4" data-path="auction.html"><a href="auction.html#variations"><i class="fa fa-check"></i><b>9.2.4</b> Variations</a></li>
<li class="chapter" data-level="9.2.5" data-path="auction.html"><a href="auction.html#estimation-of-a-ipv-button-auction"><i class="fa fa-check"></i><b>9.2.5</b> Estimation of a IPV Button Auction</a></li>
<li class="chapter" data-level="9.2.6" data-path="auction.html"><a href="auction.html#likelihood-of-ipv-button-auction"><i class="fa fa-check"></i><b>9.2.6</b> Likelihood of IPV Button Auction</a></li>
<li class="chapter" data-level="9.2.7" data-path="auction.html"><a href="auction.html#optimal-reserve-price"><i class="fa fa-check"></i><b>9.2.7</b> Optimal Reserve Price</a></li>
<li class="chapter" data-level="9.2.8" data-path="auction.html"><a href="auction.html#likelihood-of-ipv-english-auction-with-bid-data"><i class="fa fa-check"></i><b>9.2.8</b> Likelihood of IPV English Auction with Bid Data</a></li>
<li class="chapter" data-level="9.2.9" data-path="auction.html"><a href="auction.html#observed-heterogeneity"><i class="fa fa-check"></i><b>9.2.9</b> Observed Heterogeneity</a></li>
<li class="chapter" data-level="9.2.10" data-path="auction.html"><a href="auction.html#identification-2"><i class="fa fa-check"></i><b>9.2.10</b> Identification</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="auction.html"><a href="auction.html#first-price-auctions"><i class="fa fa-check"></i><b>9.3</b> First-Price Auctions</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="auction.html"><a href="auction.html#first-price-sealed-bid-auction"><i class="fa fa-check"></i><b>9.3.1</b> First-Price Sealed Bid Auction</a></li>
<li class="chapter" data-level="9.3.2" data-path="auction.html"><a href="auction.html#equilibrium-bidding-strategies-1"><i class="fa fa-check"></i><b>9.3.2</b> Equilibrium Bidding Strategies</a></li>
<li class="chapter" data-level="9.3.3" data-path="auction.html"><a href="auction.html#maximum-likelihood-estimation-of-the-ipv-first-price-auction"><i class="fa fa-check"></i><b>9.3.3</b> Maximum Likelihood Estimation of the IPV First-Price Auction</a></li>
<li class="chapter" data-level="9.3.4" data-path="auction.html"><a href="auction.html#non-parametric-approach"><i class="fa fa-check"></i><b>9.3.4</b> Non-Parametric Approach</a></li>
<li class="chapter" data-level="9.3.5" data-path="auction.html"><a href="auction.html#non-parmaetric-approach-estimation"><i class="fa fa-check"></i><b>9.3.5</b> Non-Parmaetric Approach: Estimation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>10</b> Applications</a>
<ul>
<li class="chapter" data-level="10.1" data-path="applications.html"><a href="applications.html#section"><i class="fa fa-check"></i><b>10.1</b> 2018-2019</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="applications.html"><a href="applications.html#american-economic-review"><i class="fa fa-check"></i><b>10.1.1</b> American Economic Review</a></li>
<li class="chapter" data-level="10.1.2" data-path="applications.html"><a href="applications.html#econometrica"><i class="fa fa-check"></i><b>10.1.2</b> Econometrica</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="applications.html"><a href="applications.html#asymmetric-information-and-market-power"><i class="fa fa-check"></i><b>10.2</b> Asymmetric Information and Market Power</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="applications.html"><a href="applications.html#motivation"><i class="fa fa-check"></i><b>10.2.1</b> Motivation</a></li>
<li class="chapter" data-level="10.2.2" data-path="applications.html"><a href="applications.html#question-method-and-materials"><i class="fa fa-check"></i><b>10.2.2</b> Question, Method, and Materials</a></li>
<li class="chapter" data-level="10.2.3" data-path="applications.html"><a href="applications.html#findings"><i class="fa fa-check"></i><b>10.2.3</b> Findings</a></li>
<li class="chapter" data-level="10.2.4" data-path="applications.html"><a href="applications.html#policy-experiments"><i class="fa fa-check"></i><b>10.2.4</b> Policy Experiments</a></li>
<li class="chapter" data-level="10.2.5" data-path="applications.html"><a href="applications.html#source"><i class="fa fa-check"></i><b>10.2.5</b> Source</a></li>
<li class="chapter" data-level="10.2.6" data-path="applications.html"><a href="applications.html#loan-data"><i class="fa fa-check"></i><b>10.2.6</b> Loan Data</a></li>
<li class="chapter" data-level="10.2.7" data-path="applications.html"><a href="applications.html#firm-data"><i class="fa fa-check"></i><b>10.2.7</b> Firm Data</a></li>
<li class="chapter" data-level="10.2.8" data-path="applications.html"><a href="applications.html#default-data"><i class="fa fa-check"></i><b>10.2.8</b> Default Data</a></li>
<li class="chapter" data-level="10.2.9" data-path="applications.html"><a href="applications.html#positive-correlation-tests"><i class="fa fa-check"></i><b>10.2.9</b> Positive Correlation Tests</a></li>
<li class="chapter" data-level="10.2.10" data-path="applications.html"><a href="applications.html#setting-6"><i class="fa fa-check"></i><b>10.2.10</b> Setting</a></li>
<li class="chapter" data-level="10.2.11" data-path="applications.html"><a href="applications.html#firm-preference-over-banks"><i class="fa fa-check"></i><b>10.2.11</b> Firm Preference over Banks</a></li>
<li class="chapter" data-level="10.2.12" data-path="applications.html"><a href="applications.html#required-loand-amount"><i class="fa fa-check"></i><b>10.2.12</b> Required Loand Amount</a></li>
<li class="chapter" data-level="10.2.13" data-path="applications.html"><a href="applications.html#default-decision"><i class="fa fa-check"></i><b>10.2.13</b> Default Decision</a></li>
<li class="chapter" data-level="10.2.14" data-path="applications.html"><a href="applications.html#information-structure"><i class="fa fa-check"></i><b>10.2.14</b> Information Structure</a></li>
<li class="chapter" data-level="10.2.15" data-path="applications.html"><a href="applications.html#moral-hazard"><i class="fa fa-check"></i><b>10.2.15</b> Moral Hazard</a></li>
<li class="chapter" data-level="10.2.16" data-path="applications.html"><a href="applications.html#bank-problem"><i class="fa fa-check"></i><b>10.2.16</b> Bank Problem</a></li>
<li class="chapter" data-level="10.2.17" data-path="applications.html"><a href="applications.html#the-effect-of-price-on-default-probability"><i class="fa fa-check"></i><b>10.2.17</b> The Effect of Price on Default Probability</a></li>
<li class="chapter" data-level="10.2.18" data-path="applications.html"><a href="applications.html#the-first-order-condition"><i class="fa fa-check"></i><b>10.2.18</b> The First-Order Condition</a></li>
<li class="chapter" data-level="10.2.19" data-path="applications.html"><a href="applications.html#the-effect-of-higher-adverse-selection"><i class="fa fa-check"></i><b>10.2.19</b> The Effect of Higher Adverse Selection</a></li>
<li class="chapter" data-level="10.2.20" data-path="applications.html"><a href="applications.html#estimating-equilibrium-pricing-strategy-and-augmenting-missing-price-data"><i class="fa fa-check"></i><b>10.2.20</b> Estimating Equilibrium Pricing Strategy and Augmenting Missing Price Data</a></li>
<li class="chapter" data-level="10.2.21" data-path="applications.html"><a href="applications.html#inserting-pricing-estimates-into-the-utility"><i class="fa fa-check"></i><b>10.2.21</b> Inserting Pricing Estimates into the Utility</a></li>
<li class="chapter" data-level="10.2.22" data-path="applications.html"><a href="applications.html#choice-probability"><i class="fa fa-check"></i><b>10.2.22</b> Choice Probability</a></li>
<li class="chapter" data-level="10.2.23" data-path="applications.html"><a href="applications.html#equilibrium-loan-strategy"><i class="fa fa-check"></i><b>10.2.23</b> Equilibrium Loan Strategy</a></li>
<li class="chapter" data-level="10.2.24" data-path="applications.html"><a href="applications.html#equilibrium-default-strategy"><i class="fa fa-check"></i><b>10.2.24</b> Equilibrium Default Strategy</a></li>
<li class="chapter" data-level="10.2.25" data-path="applications.html"><a href="applications.html#control-function-approach-to-deal-with-endogeneity-in-loand-and-defaulty-equations"><i class="fa fa-check"></i><b>10.2.25</b> Control Function Approach to Deal with Endogeneity in Loand and Defaulty Equations</a></li>
<li class="chapter" data-level="10.2.26" data-path="applications.html"><a href="applications.html#first-stage-estimation"><i class="fa fa-check"></i><b>10.2.26</b> First-Stage Estimation</a></li>
<li class="chapter" data-level="10.2.27" data-path="applications.html"><a href="applications.html#second-stage-estimation"><i class="fa fa-check"></i><b>10.2.27</b> Second-Stage Estimation</a></li>
<li class="chapter" data-level="10.2.28" data-path="applications.html"><a href="applications.html#estimation-results"><i class="fa fa-check"></i><b>10.2.28</b> Estimation Results</a></li>
<li class="chapter" data-level="10.2.29" data-path="applications.html"><a href="applications.html#findings-from-estimation-results"><i class="fa fa-check"></i><b>10.2.29</b> Findings from Estimation Results</a></li>
<li class="chapter" data-level="10.2.30" data-path="applications.html"><a href="applications.html#fit-of-the-model"><i class="fa fa-check"></i><b>10.2.30</b> Fit of the Model</a></li>
<li class="chapter" data-level="10.2.31" data-path="applications.html"><a href="applications.html#counterfactuals"><i class="fa fa-check"></i><b>10.2.31</b> Counterfactuals</a></li>
<li class="chapter" data-level="10.2.32" data-path="applications.html"><a href="applications.html#what-if-adverse-selection-got-severer"><i class="fa fa-check"></i><b>10.2.32</b> What if Adverse Selection Got Severer?</a></li>
<li class="chapter" data-level="10.2.33" data-path="applications.html"><a href="applications.html#what-if-cost-of-capital-increased"><i class="fa fa-check"></i><b>10.2.33</b> What if Cost of Capital Increased?</a></li>
<li class="chapter" data-level="10.2.34" data-path="applications.html"><a href="applications.html#merger-simulation-2"><i class="fa fa-check"></i><b>10.2.34</b> Merger Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="assignment1.html"><a href="assignment1.html"><i class="fa fa-check"></i><b>11</b> Assignment 1: Basic Programming in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="assignment1.html"><a href="assignment1.html#simulate-data"><i class="fa fa-check"></i><b>11.1</b> Simulate data</a></li>
<li class="chapter" data-level="11.2" data-path="assignment1.html"><a href="assignment1.html#estimate-the-parameter"><i class="fa fa-check"></i><b>11.2</b> Estimate the parameter</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="assignment2.html"><a href="assignment2.html"><i class="fa fa-check"></i><b>12</b> Assignment 2: Production Function Estimation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="assignment2.html"><a href="assignment2.html#simulate-data-1"><i class="fa fa-check"></i><b>12.1</b> Simulate data</a></li>
<li class="chapter" data-level="12.2" data-path="assignment2.html"><a href="assignment2.html#estimate-the-parameters"><i class="fa fa-check"></i><b>12.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="assignment3.html"><a href="assignment3.html"><i class="fa fa-check"></i><b>13</b> Assignment 3: Demand Function Estimation I</a>
<ul>
<li class="chapter" data-level="13.1" data-path="assignment3.html"><a href="assignment3.html#simulate-data-2"><i class="fa fa-check"></i><b>13.1</b> Simulate data</a></li>
<li class="chapter" data-level="13.2" data-path="assignment3.html"><a href="assignment3.html#estimate-the-parameters-1"><i class="fa fa-check"></i><b>13.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="assignment4.html"><a href="assignment4.html"><i class="fa fa-check"></i><b>14</b> Assignment 4: Demand Function Estimation II</a>
<ul>
<li class="chapter" data-level="14.1" data-path="assignment4.html"><a href="assignment4.html#simulate-data-3"><i class="fa fa-check"></i><b>14.1</b> Simulate data</a></li>
<li class="chapter" data-level="14.2" data-path="assignment4.html"><a href="assignment4.html#estimate-the-parameters-2"><i class="fa fa-check"></i><b>14.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="assignment5.html"><a href="assignment5.html"><i class="fa fa-check"></i><b>15</b> Assignment 5: Merger Simulation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="assignment5.html"><a href="assignment5.html#simulate-data-4"><i class="fa fa-check"></i><b>15.1</b> Simulate data</a></li>
<li class="chapter" data-level="15.2" data-path="assignment5.html"><a href="assignment5.html#estimate-the-parameters-3"><i class="fa fa-check"></i><b>15.2</b> Estimate the parameters</a></li>
<li class="chapter" data-level="15.3" data-path="assignment5.html"><a href="assignment5.html#conduct-counterfactual-simulation"><i class="fa fa-check"></i><b>15.3</b> Conduct counterfactual simulation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="assignment6.html"><a href="assignment6.html"><i class="fa fa-check"></i><b>16</b> Assignment 6: Entry and Exit Analysis</a>
<ul>
<li class="chapter" data-level="16.1" data-path="assignment6.html"><a href="assignment6.html#simulate-data-5"><i class="fa fa-check"></i><b>16.1</b> Simulate data</a></li>
<li class="chapter" data-level="16.2" data-path="assignment6.html"><a href="assignment6.html#estimate-the-parameters-4"><i class="fa fa-check"></i><b>16.2</b> Estimate the parameters</a></li>
<li class="chapter" data-level="16.3" data-path="assignment6.html"><a href="assignment6.html#conduct-counterfactual-simulations"><i class="fa fa-check"></i><b>16.3</b> Conduct counterfactual simulations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="assignment7.html"><a href="assignment7.html"><i class="fa fa-check"></i><b>17</b> Assignment 7: Dynamic Decision</a>
<ul>
<li class="chapter" data-level="17.1" data-path="assignment7.html"><a href="assignment7.html#simulate-data-6"><i class="fa fa-check"></i><b>17.1</b> Simulate data</a></li>
<li class="chapter" data-level="17.2" data-path="assignment7.html"><a href="assignment7.html#estimate-parameters"><i class="fa fa-check"></i><b>17.2</b> Estimate parameters</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="assignment8.html"><a href="assignment8.html"><i class="fa fa-check"></i><b>18</b> Assignment 8: Dynamic Game</a>
<ul>
<li class="chapter" data-level="18.1" data-path="assignment8.html"><a href="assignment8.html#simulate-data-7"><i class="fa fa-check"></i><b>18.1</b> Simulate data</a></li>
<li class="chapter" data-level="18.2" data-path="assignment8.html"><a href="assignment8.html#estimate-parameters-1"><i class="fa fa-check"></i><b>18.2</b> Estimate parameters</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="assignment9.html"><a href="assignment9.html"><i class="fa fa-check"></i><b>19</b> Assignment 9: Auction</a>
<ul>
<li class="chapter" data-level="19.1" data-path="assignment9.html"><a href="assignment9.html#simulate-data-8"><i class="fa fa-check"></i><b>19.1</b> Simulate data</a></li>
<li class="chapter" data-level="19.2" data-path="assignment9.html"><a href="assignment9.html#estimate-the-parameters-5"><i class="fa fa-check"></i><b>19.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>20</b> Integrating with C++ using Rcpp and RcppEigen</a>
<ul>
<li class="chapter" data-level="20.1" data-path="rcpp.html"><a href="rcpp.html#prerequisite"><i class="fa fa-check"></i><b>20.1</b> Prerequisite</a></li>
<li class="chapter" data-level="20.2" data-path="rcpp.html"><a href="rcpp.html#workflow"><i class="fa fa-check"></i><b>20.2</b> Workflow</a></li>
<li class="chapter" data-level="20.3" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-as-rcpp-objects"><i class="fa fa-check"></i><b>20.3</b> Passing R Objects as Rcpp Objects</a></li>
<li class="chapter" data-level="20.4" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-as-eigen-objects"><i class="fa fa-check"></i><b>20.4</b> Passing R Objects as Eigen Objects</a></li>
<li class="chapter" data-level="20.5" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-in-other-objects-in-cc"><i class="fa fa-check"></i><b>20.5</b> Passing R Objects in Other Objects in C/C++</a></li>
<li class="chapter" data-level="20.6" data-path="rcpp.html"><a href="rcpp.html#manipulating-objects-in-a-c-function"><i class="fa fa-check"></i><b>20.6</b> Manipulating Objects in a C++ Function</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="rcpp.html"><a href="rcpp.html#matrix-and-vector-arithmetic"><i class="fa fa-check"></i><b>20.6.1</b> Matrix and Vector Arithmetic</a></li>
<li class="chapter" data-level="20.6.2" data-path="rcpp.html"><a href="rcpp.html#the-array-class-and-coefficient-wise-operations"><i class="fa fa-check"></i><b>20.6.2</b> The Array Class and Coefficient-wise Operations</a></li>
<li class="chapter" data-level="20.6.3" data-path="rcpp.html"><a href="rcpp.html#solving-linear-least-squares-systems"><i class="fa fa-check"></i><b>20.6.3</b> Solving Linear Least Squares Systems</a></li>
<li class="chapter" data-level="20.6.4" data-path="rcpp.html"><a href="rcpp.html#accessing-to-elements-of-a-matrix-and-vector"><i class="fa fa-check"></i><b>20.6.4</b> Accessing to Elements of a Matrix and Vector</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>21</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECON5630 Topics in Empirical Industrial Organization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="assignment4" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Assignment 4: Demand Function Estimation II<a href="assignment4.html#assignment4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="simulate-data-3" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Simulate data<a href="assignment4.html#simulate-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Be carefull that some parameters are changed from assignment 3</strong>. We simulate data from a discrete choice model that is the same with in assignment 3 except for the existence of unobserved product-specific fixed effects. There are <span class="math inline">\(T\)</span> markets and each market has <span class="math inline">\(N\)</span> consumers. There are <span class="math inline">\(J\)</span> products and the indirect utility of consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> for product <span class="math inline">\(j\)</span> is:
<span class="math display">\[
u_{itj} = \beta_{it}&#39; x_j + \alpha_{it} p_{jt} + \xi_{jt} + \epsilon_{ijt},
\]</span>
where <span class="math inline">\(\epsilon_{ijt}\)</span> is an i.i.d. type-I extreme random variable. <span class="math inline">\(x_j\)</span> is <span class="math inline">\(K\)</span>-dimensional observed characteristics of the product. <span class="math inline">\(p_{jt}\)</span> is the retail price of the product in the market.</p>
<p><span class="math inline">\(\xi_{jt}\)</span> is product-market specific fixed effect. <span class="math inline">\(p_{jt}\)</span> can be correlated with <span class="math inline">\(\xi_{jt}\)</span> but <span class="math inline">\(x_{jt}\)</span>s are independent of <span class="math inline">\(\xi_{jt}\)</span>. <span class="math inline">\(j = 0\)</span> is an outside option whose indirect utility is:
<span class="math display">\[
u_{it0} = \epsilon_{i0t},
\]</span>
where <span class="math inline">\(\epsilon_{i0t}\)</span> is an i.i.d. type-I extreme random variable.</p>
<p><span class="math inline">\(\beta_{it}\)</span> and <span class="math inline">\(\alpha_{it}\)</span> are different across consumers, and they are distributed as:
<span class="math display">\[
\beta_{itk} = \beta_{0k} + \sigma_k \nu_{itk},
\]</span>
<span class="math display">\[
\alpha_{it} = - \exp(\mu + \omega \upsilon_{it}) = - \exp(\mu + \frac{\omega^2}{2}) + [- \exp(\mu + \omega \upsilon_{it}) + \exp(\mu + \frac{\omega^2}{2})] \equiv \alpha_0 + \tilde{\alpha}_{it},
\]</span>
where <span class="math inline">\(\nu_{itk}\)</span> for <span class="math inline">\(k = 1, \cdots, K\)</span> and <span class="math inline">\(\upsilon_{it}\)</span> are i.i.d. standard normal random variables. <span class="math inline">\(\alpha_0\)</span> is the mean of <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\tilde{\alpha}_i\)</span> is the deviation from the mean.</p>
<p>Given a choice set in the market, <span class="math inline">\(\mathcal{J}_t \cup \{0\}\)</span>, a consumer chooses the alternative that maximizes her utility:
<span class="math display">\[
q_{ijt} = 1\{u_{ijt} = \max_{k \in \mathcal{J}_t \cup \{0\}} u_{ikt}\}.
\]</span>
The choice probability of product <span class="math inline">\(j\)</span> for consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> is:
<span class="math display">\[
\sigma_{jt}(p_t, x_t, \xi_t) = \mathbb{P}\{u_{ijt} = \max_{k \in \mathcal{J}_t \cup \{0\}} u_{ikt}\}.
\]</span></p>
<p>Suppose that we only observe the share data:
<span class="math display">\[
s_{jt} = \frac{1}{N} \sum_{i = 1}^N q_{ijt},
\]</span>
along with the product-market characteristics <span class="math inline">\(x_{jt}\)</span> and the retail prices <span class="math inline">\(p_{jt}\)</span> for <span class="math inline">\(j \in \mathcal{J}_t \cup \{0\}\)</span> for <span class="math inline">\(t = 1, \cdots, T\)</span>. We do not observe the choice data <span class="math inline">\(q_{ijt}\)</span> nor shocks <span class="math inline">\(\xi_{jt}, \nu_{it}, \upsilon_{it}, \epsilon_{ijt}\)</span>.</p>
<p>We draw <span class="math inline">\(\xi_{jt}\)</span> from i.i.d. normal distribution with mean 0 and standard deviation <span class="math inline">\(\sigma_{\xi}\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Set the seed, constants, and parameters of interest as follows.</li>
</ol>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="assignment4.html#cb111-1" tabindex="-1"></a><span class="co"># set the seed</span></span>
<span id="cb111-2"><a href="assignment4.html#cb111-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb111-3"><a href="assignment4.html#cb111-3" tabindex="-1"></a><span class="co"># number of products</span></span>
<span id="cb111-4"><a href="assignment4.html#cb111-4" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb111-5"><a href="assignment4.html#cb111-5" tabindex="-1"></a><span class="co"># dimension of product characteristics including the intercept</span></span>
<span id="cb111-6"><a href="assignment4.html#cb111-6" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb111-7"><a href="assignment4.html#cb111-7" tabindex="-1"></a><span class="co"># number of markets</span></span>
<span id="cb111-8"><a href="assignment4.html#cb111-8" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb111-9"><a href="assignment4.html#cb111-9" tabindex="-1"></a><span class="co"># number of consumers per market</span></span>
<span id="cb111-10"><a href="assignment4.html#cb111-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb111-11"><a href="assignment4.html#cb111-11" tabindex="-1"></a><span class="co"># number of Monte Carlo</span></span>
<span id="cb111-12"><a href="assignment4.html#cb111-12" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="dv">500</span></span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="assignment4.html#cb112-1" tabindex="-1"></a><span class="co"># set parameters of interests</span></span>
<span id="cb112-2"><a href="assignment4.html#cb112-2" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(K); </span>
<span id="cb112-3"><a href="assignment4.html#cb112-3" tabindex="-1"></a>beta[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb112-4"><a href="assignment4.html#cb112-4" tabindex="-1"></a>beta</span></code></pre></div>
<pre><code>## [1]  4.0000000  0.1836433 -0.8356286</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="assignment4.html#cb114-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(K)); sigma</span></code></pre></div>
<pre><code>## [1] 1.5952808 0.3295078 0.8204684</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="assignment4.html#cb116-1" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb116-2"><a href="assignment4.html#cb116-2" tabindex="-1"></a>omega <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div>
<p>Generate the covariates as follows.</p>
<p>The product-market characteristics:
<span class="math display">\[
x_{j1} = 1, x_{jk} \sim N(0, \sigma_x), k = 2, \cdots, K,
\]</span>
where <span class="math inline">\(\sigma_x\)</span> is referred to as <code>sd_x</code> in the code.</p>
<p>The product-market-specific unobserved fixed effect:
<span class="math display">\[
\xi_{jt} \sim N(0, \sigma_\xi),
\]</span>
where <span class="math inline">\(\sigma_xi\)</span> is referred to as <code>sd_xi</code> in the code.</p>
<p>The marginal cost of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span>:
<span class="math display">\[
c_{jt} \sim \text{logNormal}(0, \sigma_c),
\]</span>
where <span class="math inline">\(\sigma_c\)</span> is referred to as <code>sd_c</code> in the code.</p>
<p>The retail price:
<span class="math display">\[
p_{jt} - c_{jt} \sim \text{logNorm}(\gamma \xi_{jt}, \sigma_p^2),
\]</span>
where <span class="math inline">\(\gamma\)</span> is referred to as <code>price_xi</code> and <span class="math inline">\(\sigma_p\)</span> as <code>sd_p</code> in the code. This price is not the equilibrium price. We will revisit this point in a subsequent assignment.</p>
<p>The value of the auxiliary parameters are set as follows:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="assignment4.html#cb117-1" tabindex="-1"></a><span class="co"># set auxiliary parameters</span></span>
<span id="cb117-2"><a href="assignment4.html#cb117-2" tabindex="-1"></a>price_xi <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb117-3"><a href="assignment4.html#cb117-3" tabindex="-1"></a>sd_x <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb117-4"><a href="assignment4.html#cb117-4" tabindex="-1"></a>sd_xi <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb117-5"><a href="assignment4.html#cb117-5" tabindex="-1"></a>sd_c <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb117-6"><a href="assignment4.html#cb117-6" tabindex="-1"></a>sd_p <span class="ot">&lt;-</span> <span class="fl">0.01</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><code>X</code> is the data frame such that a row contains the characteristics vector <span class="math inline">\(x_{j}\)</span> of a product and columns are product index and observed product characteristics. The dimension of the characteristics <span class="math inline">\(K\)</span> is specified above. Add the row of the outside option whose index is <span class="math inline">\(0\)</span> and all the characteristics are zero.</li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="assignment4.html#cb118-1" tabindex="-1"></a><span class="co"># make product characteristics data</span></span>
<span id="cb118-2"><a href="assignment4.html#cb118-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> </span>
<span id="cb118-3"><a href="assignment4.html#cb118-3" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb118-4"><a href="assignment4.html#cb118-4" tabindex="-1"></a>    sd_x <span class="sc">*</span> <span class="fu">rnorm</span>(J <span class="sc">*</span> (K <span class="sc">-</span> <span class="dv">1</span>)), </span>
<span id="cb118-5"><a href="assignment4.html#cb118-5" tabindex="-1"></a>    <span class="at">nrow =</span> J</span>
<span id="cb118-6"><a href="assignment4.html#cb118-6" tabindex="-1"></a>    )</span>
<span id="cb118-7"><a href="assignment4.html#cb118-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> </span>
<span id="cb118-8"><a href="assignment4.html#cb118-8" tabindex="-1"></a>  <span class="fu">cbind</span>(</span>
<span id="cb118-9"><a href="assignment4.html#cb118-9" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">1</span>, J), </span>
<span id="cb118-10"><a href="assignment4.html#cb118-10" tabindex="-1"></a>    X</span>
<span id="cb118-11"><a href="assignment4.html#cb118-11" tabindex="-1"></a>    )</span>
<span id="cb118-12"><a href="assignment4.html#cb118-12" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">1</span><span class="sc">:</span>K, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb118-13"><a href="assignment4.html#cb118-13" tabindex="-1"></a>X <span class="ot">&lt;-</span> </span>
<span id="cb118-14"><a href="assignment4.html#cb118-14" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>J, X) <span class="sc">%&gt;%</span></span>
<span id="cb118-15"><a href="assignment4.html#cb118-15" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span>
<span id="cb118-16"><a href="assignment4.html#cb118-16" tabindex="-1"></a><span class="co"># add outside option</span></span>
<span id="cb118-17"><a href="assignment4.html#cb118-17" tabindex="-1"></a>X <span class="ot">&lt;-</span> </span>
<span id="cb118-18"><a href="assignment4.html#cb118-18" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb118-19"><a href="assignment4.html#cb118-19" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">dim</span>(X)[<span class="dv">2</span>]),</span>
<span id="cb118-20"><a href="assignment4.html#cb118-20" tabindex="-1"></a>    X</span>
<span id="cb118-21"><a href="assignment4.html#cb118-21" tabindex="-1"></a>    ) </span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="assignment4.html#cb119-1" tabindex="-1"></a>X</span></code></pre></div>
<pre><code>## # A tibble: 11  4
##        j   x_1     x_2     x_3
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     0     0  0       0     
##  2     1     1  0.975  -0.0324
##  3     2     1  1.48    1.89  
##  4     3     1  1.15    1.64  
##  5     4     1 -0.611   1.19  
##  6     5     1  3.02    1.84  
##  7     6     1  0.780   1.56  
##  8     7     1 -1.24    0.149 
##  9     8     1 -4.43   -3.98  
## 10     9     1  2.25    1.24  
## 11    10     1 -0.0899 -0.112</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><code>M</code> is the data frame such that a row contains the price <span class="math inline">\(\xi_{jt}\)</span>, marginal cost <span class="math inline">\(c_{jt}\)</span>, and price <span class="math inline">\(p_{jt}\)</span>. After generating the variables, drop some products in each market. <strong>In this assignment, we drop products in a different way from the last assignment</strong>. In order to change the number of available products in each market, for each market, first draw <span class="math inline">\(J_t\)</span> from a discrete uniform distribution between <span class="math inline">\(1\)</span> and <span class="math inline">\(J\)</span>. Then, drop products from each market using <code>dplyr::sample_frac</code> function with the realized number of available products. The variation in the available products is important for the identification of the distribution of consumer-level unobserved heterogeneity. Add the row of the outside option to each market whose index is <span class="math inline">\(0\)</span> and all the variables take value zero.</li>
</ol>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="assignment4.html#cb121-1" tabindex="-1"></a><span class="co"># make market-product data</span></span>
<span id="cb121-2"><a href="assignment4.html#cb121-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> </span>
<span id="cb121-3"><a href="assignment4.html#cb121-3" tabindex="-1"></a>  <span class="fu">expand.grid</span>(</span>
<span id="cb121-4"><a href="assignment4.html#cb121-4" tabindex="-1"></a>    <span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span>J, </span>
<span id="cb121-5"><a href="assignment4.html#cb121-5" tabindex="-1"></a>    <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>T</span>
<span id="cb121-6"><a href="assignment4.html#cb121-6" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb121-7"><a href="assignment4.html#cb121-7" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb121-8"><a href="assignment4.html#cb121-8" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb121-9"><a href="assignment4.html#cb121-9" tabindex="-1"></a>      <span class="at">xi =</span> sd_xi <span class="sc">*</span> <span class="fu">rnorm</span>(J <span class="sc">*</span> T),</span>
<span id="cb121-10"><a href="assignment4.html#cb121-10" tabindex="-1"></a>      <span class="at">c =</span> <span class="fu">exp</span>(sd_c <span class="sc">*</span> <span class="fu">rnorm</span>(J <span class="sc">*</span> T)),</span>
<span id="cb121-11"><a href="assignment4.html#cb121-11" tabindex="-1"></a>      <span class="at">p =</span> <span class="fu">exp</span>(price_xi <span class="sc">*</span> xi <span class="sc">+</span> sd_p <span class="sc">*</span> <span class="fu">rnorm</span>(J <span class="sc">*</span> T)) <span class="sc">+</span> c</span>
<span id="cb121-12"><a href="assignment4.html#cb121-12" tabindex="-1"></a>    ) </span>
<span id="cb121-13"><a href="assignment4.html#cb121-13" tabindex="-1"></a>M <span class="ot">&lt;-</span> </span>
<span id="cb121-14"><a href="assignment4.html#cb121-14" tabindex="-1"></a>  M <span class="sc">%&gt;%</span></span>
<span id="cb121-15"><a href="assignment4.html#cb121-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(t) <span class="sc">%&gt;%</span></span>
<span id="cb121-16"><a href="assignment4.html#cb121-16" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">sample_frac</span>(<span class="at">size =</span> purrr<span class="sc">::</span><span class="fu">rdunif</span>(<span class="dv">1</span>, J) <span class="sc">/</span> J) <span class="sc">%&gt;%</span></span>
<span id="cb121-17"><a href="assignment4.html#cb121-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## Warning: `rdunif()` was deprecated in purrr 1.0.0.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="assignment4.html#cb123-1" tabindex="-1"></a><span class="co"># add outside option</span></span>
<span id="cb123-2"><a href="assignment4.html#cb123-2" tabindex="-1"></a>outside <span class="ot">&lt;-</span> </span>
<span id="cb123-3"><a href="assignment4.html#cb123-3" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb123-4"><a href="assignment4.html#cb123-4" tabindex="-1"></a>    <span class="at">j =</span> <span class="dv">0</span>, </span>
<span id="cb123-5"><a href="assignment4.html#cb123-5" tabindex="-1"></a>    <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>T, </span>
<span id="cb123-6"><a href="assignment4.html#cb123-6" tabindex="-1"></a>    <span class="at">xi =</span> <span class="dv">0</span>, </span>
<span id="cb123-7"><a href="assignment4.html#cb123-7" tabindex="-1"></a>    <span class="at">c =</span> <span class="dv">0</span>, </span>
<span id="cb123-8"><a href="assignment4.html#cb123-8" tabindex="-1"></a>    <span class="at">p =</span> <span class="dv">0</span></span>
<span id="cb123-9"><a href="assignment4.html#cb123-9" tabindex="-1"></a>    )</span>
<span id="cb123-10"><a href="assignment4.html#cb123-10" tabindex="-1"></a>M <span class="ot">&lt;-</span> </span>
<span id="cb123-11"><a href="assignment4.html#cb123-11" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb123-12"><a href="assignment4.html#cb123-12" tabindex="-1"></a>    M,</span>
<span id="cb123-13"><a href="assignment4.html#cb123-13" tabindex="-1"></a>    outside</span>
<span id="cb123-14"><a href="assignment4.html#cb123-14" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb123-15"><a href="assignment4.html#cb123-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(</span>
<span id="cb123-16"><a href="assignment4.html#cb123-16" tabindex="-1"></a>    t, </span>
<span id="cb123-17"><a href="assignment4.html#cb123-17" tabindex="-1"></a>    j</span>
<span id="cb123-18"><a href="assignment4.html#cb123-18" tabindex="-1"></a>    )</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="assignment4.html#cb124-1" tabindex="-1"></a>M</span></code></pre></div>
<pre><code>## # A tibble: 633  5
##        j     t      xi     c     p
##    &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     0     1  0      0      0   
##  2     1     1 -0.0156 0.604  1.58
##  3     4     1  0.0418 1.30   2.35
##  4     0     2  0      0      0   
##  5     1     2 -0.0394 0.890  1.87
##  6     3     2  0.110  2.29   3.40
##  7     4     2  0.0763 0.997  2.09
##  8     6     2 -0.0253 1.15   2.13
##  9     7     2  0.0697 0.613  1.68
## 10     8     2  0.0557 0.629  1.67
## #  623 more rows</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Generate the consumer-level heterogeneity. <code>V</code> is the data frame such that a row contains the vector of shocks to consumer-level heterogeneity, <span class="math inline">\((\nu_{i}&#39;, \upsilon_i)\)</span>. They are all i.i.d. standard normal random variables.</li>
</ol>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="assignment4.html#cb126-1" tabindex="-1"></a><span class="co"># make consumer-market data</span></span>
<span id="cb126-2"><a href="assignment4.html#cb126-2" tabindex="-1"></a>V <span class="ot">&lt;-</span> </span>
<span id="cb126-3"><a href="assignment4.html#cb126-3" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb126-4"><a href="assignment4.html#cb126-4" tabindex="-1"></a>    <span class="fu">rnorm</span>(N <span class="sc">*</span> T <span class="sc">*</span> (K <span class="sc">+</span> <span class="dv">1</span>)), </span>
<span id="cb126-5"><a href="assignment4.html#cb126-5" tabindex="-1"></a>    <span class="at">nrow =</span> N <span class="sc">*</span> T</span>
<span id="cb126-6"><a href="assignment4.html#cb126-6" tabindex="-1"></a>    ) </span>
<span id="cb126-7"><a href="assignment4.html#cb126-7" tabindex="-1"></a><span class="fu">colnames</span>(V) <span class="ot">&lt;-</span> </span>
<span id="cb126-8"><a href="assignment4.html#cb126-8" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb126-9"><a href="assignment4.html#cb126-9" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;v_x&quot;</span>, <span class="dv">1</span><span class="sc">:</span>K, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), </span>
<span id="cb126-10"><a href="assignment4.html#cb126-10" tabindex="-1"></a>    <span class="st">&quot;v_p&quot;</span></span>
<span id="cb126-11"><a href="assignment4.html#cb126-11" tabindex="-1"></a>    )</span>
<span id="cb126-12"><a href="assignment4.html#cb126-12" tabindex="-1"></a>V <span class="ot">&lt;-</span> </span>
<span id="cb126-13"><a href="assignment4.html#cb126-13" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb126-14"><a href="assignment4.html#cb126-14" tabindex="-1"></a>    <span class="fu">expand.grid</span>(</span>
<span id="cb126-15"><a href="assignment4.html#cb126-15" tabindex="-1"></a>      <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>N, </span>
<span id="cb126-16"><a href="assignment4.html#cb126-16" tabindex="-1"></a>      <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>T</span>
<span id="cb126-17"><a href="assignment4.html#cb126-17" tabindex="-1"></a>      ),</span>
<span id="cb126-18"><a href="assignment4.html#cb126-18" tabindex="-1"></a>    V</span>
<span id="cb126-19"><a href="assignment4.html#cb126-19" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb126-20"><a href="assignment4.html#cb126-20" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>()</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="assignment4.html#cb127-1" tabindex="-1"></a>V</span></code></pre></div>
<pre><code>## # A tibble: 50,000  6
##        i     t  v_x_1   v_x_2  v_x_3     v_p
##    &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1 -1.37   0.211   1.65   0.0141
##  2     2     1  1.37   0.378   1.35   0.387 
##  3     3     1 -2.06  -0.0662 -2.45  -1.17  
##  4     4     1 -0.992 -0.727  -1.33  -1.42  
##  5     5     1  0.252  1.87    0.751  0.317 
##  6     6     1 -1.06  -0.531   1.34  -0.224 
##  7     7     1 -0.217  1.03    0.909 -0.593 
##  8     8     1 -0.838 -0.861  -0.612  1.54  
##  9     9     1  0.659 -1.43   -1.77   0.340 
## 10    10     1  0.452 -0.239   0.138  0.695 
## #  49,990 more rows</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Join <code>X</code>, <code>M</code>, <code>V</code> using <code>dplyr::left_join</code> and name it <code>df</code>. <code>df</code> is the data frame such that a row contains variables for a consumer about a product that is available in a market.</li>
</ol>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="assignment4.html#cb129-1" tabindex="-1"></a><span class="co"># make choice data</span></span>
<span id="cb129-2"><a href="assignment4.html#cb129-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> </span>
<span id="cb129-3"><a href="assignment4.html#cb129-3" tabindex="-1"></a>  <span class="fu">expand.grid</span>(</span>
<span id="cb129-4"><a href="assignment4.html#cb129-4" tabindex="-1"></a>    <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>T, </span>
<span id="cb129-5"><a href="assignment4.html#cb129-5" tabindex="-1"></a>    <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>N, </span>
<span id="cb129-6"><a href="assignment4.html#cb129-6" tabindex="-1"></a>    <span class="at">j =</span> <span class="dv">0</span><span class="sc">:</span>J</span>
<span id="cb129-7"><a href="assignment4.html#cb129-7" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb129-8"><a href="assignment4.html#cb129-8" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-9"><a href="assignment4.html#cb129-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb129-10"><a href="assignment4.html#cb129-10" tabindex="-1"></a>      V, </span>
<span id="cb129-11"><a href="assignment4.html#cb129-11" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;i&quot;</span>, <span class="st">&quot;t&quot;</span>)</span>
<span id="cb129-12"><a href="assignment4.html#cb129-12" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb129-13"><a href="assignment4.html#cb129-13" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb129-14"><a href="assignment4.html#cb129-14" tabindex="-1"></a>      X, </span>
<span id="cb129-15"><a href="assignment4.html#cb129-15" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;j&quot;</span>)</span>
<span id="cb129-16"><a href="assignment4.html#cb129-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb129-17"><a href="assignment4.html#cb129-17" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb129-18"><a href="assignment4.html#cb129-18" tabindex="-1"></a>      M, </span>
<span id="cb129-19"><a href="assignment4.html#cb129-19" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;j&quot;</span>, <span class="st">&quot;t&quot;</span>)</span>
<span id="cb129-20"><a href="assignment4.html#cb129-20" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb129-21"><a href="assignment4.html#cb129-21" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p)) <span class="sc">%&gt;%</span></span>
<span id="cb129-22"><a href="assignment4.html#cb129-22" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(</span>
<span id="cb129-23"><a href="assignment4.html#cb129-23" tabindex="-1"></a>      t, </span>
<span id="cb129-24"><a href="assignment4.html#cb129-24" tabindex="-1"></a>      i, </span>
<span id="cb129-25"><a href="assignment4.html#cb129-25" tabindex="-1"></a>      j</span>
<span id="cb129-26"><a href="assignment4.html#cb129-26" tabindex="-1"></a>      )</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="assignment4.html#cb130-1" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 316,500  13
##        t     i     j  v_x_1   v_x_2 v_x_3     v_p   x_1    x_2     x_3      xi
##    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1     0 -1.37   0.211   1.65  0.0141     0  0      0       0     
##  2     1     1     1 -1.37   0.211   1.65  0.0141     1  0.975 -0.0324 -0.0156
##  3     1     1     4 -1.37   0.211   1.65  0.0141     1 -0.611  1.19    0.0418
##  4     1     2     0  1.37   0.378   1.35  0.387      0  0      0       0     
##  5     1     2     1  1.37   0.378   1.35  0.387      1  0.975 -0.0324 -0.0156
##  6     1     2     4  1.37   0.378   1.35  0.387      1 -0.611  1.19    0.0418
##  7     1     3     0 -2.06  -0.0662 -2.45 -1.17       0  0      0       0     
##  8     1     3     1 -2.06  -0.0662 -2.45 -1.17       1  0.975 -0.0324 -0.0156
##  9     1     3     4 -2.06  -0.0662 -2.45 -1.17       1 -0.611  1.19    0.0418
## 10     1     4     0 -0.992 -0.727  -1.33 -1.42       0  0      0       0     
## #  316,490 more rows
## #  2 more variables: c &lt;dbl&gt;, p &lt;dbl&gt;</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Draw a vector of preference shocks <code>e</code> whose length is the same as the number of rows of <code>df</code>.</li>
</ol>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="assignment4.html#cb132-1" tabindex="-1"></a><span class="co"># draw idiosyncratic shocks</span></span>
<span id="cb132-2"><a href="assignment4.html#cb132-2" tabindex="-1"></a>e <span class="ot">&lt;-</span> evd<span class="sc">::</span><span class="fu">rgev</span>(<span class="fu">dim</span>(df)[<span class="dv">1</span>])</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="assignment4.html#cb133-1" tabindex="-1"></a><span class="fu">head</span>(e)</span></code></pre></div>
<pre><code>## [1]  0.1917775 -0.3312816  0.2428217  1.0164097  1.4761643  2.8297340</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Write a function <code>compute_indirect_utility(df, beta, sigma, mu, omega)</code> that returns a vector whose element is the mean indirect utility of a product for a consumer in a market. The output should have the same length with <span class="math inline">\(e\)</span>. (This function is the same with assignment 3. You can use the function.)</li>
</ol>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="assignment4.html#cb135-1" tabindex="-1"></a><span class="co"># compute indirect utility</span></span>
<span id="cb135-2"><a href="assignment4.html#cb135-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> </span>
<span id="cb135-3"><a href="assignment4.html#cb135-3" tabindex="-1"></a>  <span class="fu">compute_indirect_utility</span>(</span>
<span id="cb135-4"><a href="assignment4.html#cb135-4" tabindex="-1"></a>    <span class="at">df =</span> df, </span>
<span id="cb135-5"><a href="assignment4.html#cb135-5" tabindex="-1"></a>    <span class="at">beta =</span> beta, </span>
<span id="cb135-6"><a href="assignment4.html#cb135-6" tabindex="-1"></a>    <span class="at">sigma =</span> sigma, </span>
<span id="cb135-7"><a href="assignment4.html#cb135-7" tabindex="-1"></a>    <span class="at">mu =</span> mu, </span>
<span id="cb135-8"><a href="assignment4.html#cb135-8" tabindex="-1"></a>    <span class="at">omega =</span> omega</span>
<span id="cb135-9"><a href="assignment4.html#cb135-9" tabindex="-1"></a>    )</span>
<span id="cb135-10"><a href="assignment4.html#cb135-10" tabindex="-1"></a><span class="fu">head</span>(u)</span></code></pre></div>
<pre><code>##               u
## [1,]  0.0000000
## [2,] -0.6238974
## [3,] -1.6225075
## [4,]  0.0000000
## [5,]  2.6171184
## [6,]  0.6490776</code></pre>
<p>In the previous assingment, we computed predicted share by simulating choice and taking their average. Instead, we compute the actual share by:
<span class="math display">\[
s_{jt} = \frac{1}{N} \sum_{i = 1}^N \frac{\exp[\beta_{it}&#39; x_j + \alpha_{it} p_{jt} + \xi_{jt}]}{1 + \sum_{k \in \mathcal{J}_t} \exp[\beta_{it}&#39; x_k + \alpha_{it} p_{kt} + \xi_{jt}]}
\]</span>
and the predicted share by:
<span class="math display">\[
\widehat{\sigma}_{j}(x, p_t, \xi_t) = \frac{1}{L} \sum_{l = 1}^L \frac{\exp[\beta_{t}^{(l)\prime} x_j + \alpha_{t}^{(l)} p_{jt} + \xi_{jt}]}{1 + \sum_{k \in \mathcal{J}_t} \exp[\beta_{t}^{(l)\prime} x_k + \alpha_{t}^{(l)} p_{kt} + \xi_{jt}]}.
\]</span></p>
<ol start="8" style="list-style-type: decimal">
<li>To do so, write a function <code>compute_choice_smooth(X, M, V, beta, sigma, mu, omega)</code> in which the choice of each consumer is not:
<span class="math display">\[
q_{ijt} = 1\{u_{ijt} = \max_{k \in \mathcal{J}_t \cup \{0\}} u_{ikt}\},
\]</span>
but
<span class="math display">\[
\tilde{q}_{ijt} = \frac{\exp(\bar{u}_{ijt})}{1 + \sum_{k \in \mathcal{J}_t} \exp(\bar{u}_{ikt})},
\]</span>
where <span class="math inline">\(\bar{u}_{ijt} = \beta_{it}&#39; x_j + \alpha_{it} p_{jt} + \xi_{jt}\)</span>.</li>
</ol>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="assignment4.html#cb137-1" tabindex="-1"></a>df_choice_smooth <span class="ot">&lt;-</span></span>
<span id="cb137-2"><a href="assignment4.html#cb137-2" tabindex="-1"></a>  <span class="fu">compute_choice_smooth</span>(</span>
<span id="cb137-3"><a href="assignment4.html#cb137-3" tabindex="-1"></a>    <span class="at">X =</span> X, </span>
<span id="cb137-4"><a href="assignment4.html#cb137-4" tabindex="-1"></a>    <span class="at">M =</span> M, </span>
<span id="cb137-5"><a href="assignment4.html#cb137-5" tabindex="-1"></a>    <span class="at">V =</span> V, </span>
<span id="cb137-6"><a href="assignment4.html#cb137-6" tabindex="-1"></a>    <span class="at">beta =</span> beta, </span>
<span id="cb137-7"><a href="assignment4.html#cb137-7" tabindex="-1"></a>    <span class="at">sigma =</span> sigma, </span>
<span id="cb137-8"><a href="assignment4.html#cb137-8" tabindex="-1"></a>    <span class="at">mu =</span> mu, </span>
<span id="cb137-9"><a href="assignment4.html#cb137-9" tabindex="-1"></a>    <span class="at">omega =</span> omega</span>
<span id="cb137-10"><a href="assignment4.html#cb137-10" tabindex="-1"></a>    )</span>
<span id="cb137-11"><a href="assignment4.html#cb137-11" tabindex="-1"></a><span class="fu">summary</span>(df_choice_smooth)</span></code></pre></div>
<pre><code>##        t                i               j             v_x_1          
##  Min.   :  1.00   Min.   :  1.0   Min.   : 0.00   Min.   :-4.302781  
##  1st Qu.: 23.00   1st Qu.:125.8   1st Qu.: 2.00   1st Qu.:-0.685539  
##  Median : 48.00   Median :250.5   Median : 4.00   Median : 0.001041  
##  Mean   : 49.67   Mean   :250.5   Mean   : 4.49   Mean   :-0.002541  
##  3rd Qu.: 77.00   3rd Qu.:375.2   3rd Qu.: 7.00   3rd Qu.: 0.673061  
##  Max.   :100.00   Max.   :500.0   Max.   :10.00   Max.   : 3.809895  
##      v_x_2               v_x_3                v_p                 x_1       
##  Min.   :-4.542122   Min.   :-3.957618   Min.   :-4.218131   Min.   :0.000  
##  1st Qu.:-0.679702   1st Qu.:-0.672701   1st Qu.:-0.669446   1st Qu.:1.000  
##  Median : 0.000935   Median : 0.003104   Median : 0.001976   Median :1.000  
##  Mean   : 0.000478   Mean   : 0.003428   Mean   : 0.000017   Mean   :0.842  
##  3rd Qu.: 0.673109   3rd Qu.: 0.678344   3rd Qu.: 0.670699   3rd Qu.:1.000  
##  Max.   : 4.313621   Max.   : 4.244194   Max.   : 4.074300   Max.   :1.000  
##       x_2               x_3                xi                   c         
##  Min.   :-4.4294   Min.   :-3.9787   Min.   :-0.2996949   Min.   :0.0000  
##  1st Qu.:-0.6108   1st Qu.: 0.0000   1st Qu.:-0.0527368   1st Qu.:0.5250  
##  Median : 0.7797   Median : 1.1878   Median : 0.0000000   Median :0.8775  
##  Mean   : 0.3015   Mean   : 0.5034   Mean   :-0.0005149   Mean   :0.9507  
##  3rd Qu.: 1.4766   3rd Qu.: 1.6424   3rd Qu.: 0.0556663   3rd Qu.:1.3203  
##  Max.   : 3.0236   Max.   : 1.8877   Max.   : 0.3810277   Max.   :4.3043  
##        p               u                  q           
##  Min.   :0.000   Min.   :-345.287   Min.   :0.000000  
##  1st Qu.:1.516   1st Qu.:  -3.030   1st Qu.:0.001435  
##  Median :1.916   Median :   0.000   Median :0.030121  
##  Mean   :1.797   Mean   :  -1.869   Mean   :0.157978  
##  3rd Qu.:2.336   3rd Qu.:   1.559   3rd Qu.:0.161379  
##  Max.   :5.513   Max.   :  22.434   Max.   :1.000000</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Next, write a function <code>compute_share_smooth(X, M, V, beta, sigma, mu, omega)</code> that calls <code>compute_choice_smooth</code> and then returns the share based on above <span class="math inline">\(\tilde{q}_{ijt}\)</span>. If we use these functions with the Monte Carlo shocks, it gives us the predicted share of the products.</li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="assignment4.html#cb139-1" tabindex="-1"></a>df_share_smooth <span class="ot">&lt;-</span> </span>
<span id="cb139-2"><a href="assignment4.html#cb139-2" tabindex="-1"></a>  <span class="fu">compute_share_smooth</span>(</span>
<span id="cb139-3"><a href="assignment4.html#cb139-3" tabindex="-1"></a>    <span class="at">X =</span> X, </span>
<span id="cb139-4"><a href="assignment4.html#cb139-4" tabindex="-1"></a>    <span class="at">M =</span> M, </span>
<span id="cb139-5"><a href="assignment4.html#cb139-5" tabindex="-1"></a>    <span class="at">V =</span> V, </span>
<span id="cb139-6"><a href="assignment4.html#cb139-6" tabindex="-1"></a>    <span class="at">beta =</span> beta, </span>
<span id="cb139-7"><a href="assignment4.html#cb139-7" tabindex="-1"></a>    <span class="at">sigma =</span> sigma, </span>
<span id="cb139-8"><a href="assignment4.html#cb139-8" tabindex="-1"></a>    <span class="at">mu =</span> mu, </span>
<span id="cb139-9"><a href="assignment4.html#cb139-9" tabindex="-1"></a>    <span class="at">omega =</span> omega</span>
<span id="cb139-10"><a href="assignment4.html#cb139-10" tabindex="-1"></a>    )</span>
<span id="cb139-11"><a href="assignment4.html#cb139-11" tabindex="-1"></a><span class="fu">summary</span>(df_share_smooth)</span></code></pre></div>
<pre><code>##        t                j              x_1             x_2         
##  Min.   :  1.00   Min.   : 0.00   Min.   :0.000   Min.   :-4.4294  
##  1st Qu.: 23.00   1st Qu.: 2.00   1st Qu.:1.000   1st Qu.:-0.6108  
##  Median : 48.00   Median : 4.00   Median :1.000   Median : 0.7797  
##  Mean   : 49.67   Mean   : 4.49   Mean   :0.842   Mean   : 0.3015  
##  3rd Qu.: 77.00   3rd Qu.: 7.00   3rd Qu.:1.000   3rd Qu.: 1.4766  
##  Max.   :100.00   Max.   :10.00   Max.   :1.000   Max.   : 3.0236  
##       x_3                xi                   c                p        
##  Min.   :-3.9787   Min.   :-0.2996949   Min.   :0.0000   Min.   :0.000  
##  1st Qu.: 0.0000   1st Qu.:-0.0527368   1st Qu.:0.5250   1st Qu.:1.516  
##  Median : 1.1878   Median : 0.0000000   Median :0.8775   Median :1.916  
##  Mean   : 0.5034   Mean   :-0.0005149   Mean   :0.9507   Mean   :1.797  
##  3rd Qu.: 1.6424   3rd Qu.: 0.0556663   3rd Qu.:1.3203   3rd Qu.:2.336  
##  Max.   : 1.8877   Max.   : 0.3810277   Max.   :4.3043   Max.   :5.513  
##        q                 s                  y           
##  Min.   :  1.748   Min.   :0.003497   Min.   :-4.23971  
##  1st Qu.: 17.982   1st Qu.:0.035964   1st Qu.:-1.95098  
##  Median : 40.241   Median :0.080483   Median :-1.22808  
##  Mean   : 78.989   Mean   :0.157978   Mean   :-1.15979  
##  3rd Qu.:123.006   3rd Qu.:0.246011   3rd Qu.:-0.03626  
##  Max.   :325.631   Max.   :0.651262   Max.   : 1.26578</code></pre>
<p>Use this <code>df_share_smooth</code> as the data to estimate the parameters in the following section.</p>
</div>
<div id="estimate-the-parameters-2" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Estimate the parameters<a href="assignment4.html#estimate-the-parameters-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>First draw Monte Carlo consumer-level heterogeneity <code>V_mcmc</code> and Monte Carlo preference shocks <code>e_mcmc</code>. The number of simulations is <code>L</code>. This does not have to be the same with the actual number of consumers <code>N</code>.</li>
</ol>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="assignment4.html#cb141-1" tabindex="-1"></a><span class="co"># mixed logit estimation</span></span>
<span id="cb141-2"><a href="assignment4.html#cb141-2" tabindex="-1"></a><span class="do">## draw mcmc V</span></span>
<span id="cb141-3"><a href="assignment4.html#cb141-3" tabindex="-1"></a>V_mcmc <span class="ot">&lt;-</span> </span>
<span id="cb141-4"><a href="assignment4.html#cb141-4" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb141-5"><a href="assignment4.html#cb141-5" tabindex="-1"></a>    <span class="fu">rnorm</span>(L <span class="sc">*</span> T <span class="sc">*</span> (K <span class="sc">+</span> <span class="dv">1</span>)), </span>
<span id="cb141-6"><a href="assignment4.html#cb141-6" tabindex="-1"></a>    <span class="at">nrow =</span> L <span class="sc">*</span> T</span>
<span id="cb141-7"><a href="assignment4.html#cb141-7" tabindex="-1"></a>    ) </span>
<span id="cb141-8"><a href="assignment4.html#cb141-8" tabindex="-1"></a><span class="fu">colnames</span>(V_mcmc) <span class="ot">&lt;-</span> </span>
<span id="cb141-9"><a href="assignment4.html#cb141-9" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb141-10"><a href="assignment4.html#cb141-10" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;v_x&quot;</span>, <span class="dv">1</span><span class="sc">:</span>K, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>), </span>
<span id="cb141-11"><a href="assignment4.html#cb141-11" tabindex="-1"></a>    <span class="st">&quot;v_p&quot;</span></span>
<span id="cb141-12"><a href="assignment4.html#cb141-12" tabindex="-1"></a>    )</span>
<span id="cb141-13"><a href="assignment4.html#cb141-13" tabindex="-1"></a>V_mcmc <span class="ot">&lt;-</span> </span>
<span id="cb141-14"><a href="assignment4.html#cb141-14" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb141-15"><a href="assignment4.html#cb141-15" tabindex="-1"></a>  <span class="fu">expand.grid</span>(</span>
<span id="cb141-16"><a href="assignment4.html#cb141-16" tabindex="-1"></a>    <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>L, </span>
<span id="cb141-17"><a href="assignment4.html#cb141-17" tabindex="-1"></a>    <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>T</span>
<span id="cb141-18"><a href="assignment4.html#cb141-18" tabindex="-1"></a>    ),</span>
<span id="cb141-19"><a href="assignment4.html#cb141-19" tabindex="-1"></a>  V_mcmc</span>
<span id="cb141-20"><a href="assignment4.html#cb141-20" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb141-21"><a href="assignment4.html#cb141-21" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() </span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="assignment4.html#cb142-1" tabindex="-1"></a>V_mcmc</span></code></pre></div>
<pre><code>## # A tibble: 50,000  6
##        i     t   v_x_1  v_x_2   v_x_3    v_p
##    &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
##  1     1     1  0.488  -1.51   0.528  -0.468
##  2     2     1  1.16    0.507 -0.527  -0.516
##  3     3     1 -2.49   -0.318 -0.0996 -0.893
##  4     4     1  0.0952 -0.133 -2.05    1.92 
##  5     5     1 -1.11    0.103  2.24    0.753
##  6     6     1  0.903   0.496  0.287   1.53 
##  7     7     1  0.913  -0.144  0.129  -1.17 
##  8     8     1 -1.52    0.357 -0.475  -0.736
##  9     9     1  0.643   0.219  0.815  -1.27 
## 10    10     1 -0.358   0.272 -0.650  -2.09 
## #  49,990 more rows</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="assignment4.html#cb144-1" tabindex="-1"></a><span class="do">## draw mcmc e</span></span>
<span id="cb144-2"><a href="assignment4.html#cb144-2" tabindex="-1"></a>df_mcmc <span class="ot">&lt;-</span> </span>
<span id="cb144-3"><a href="assignment4.html#cb144-3" tabindex="-1"></a>  <span class="fu">expand.grid</span>(</span>
<span id="cb144-4"><a href="assignment4.html#cb144-4" tabindex="-1"></a>    <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span>T, </span>
<span id="cb144-5"><a href="assignment4.html#cb144-5" tabindex="-1"></a>    <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span>L, </span>
<span id="cb144-6"><a href="assignment4.html#cb144-6" tabindex="-1"></a>    <span class="at">j =</span> <span class="dv">0</span><span class="sc">:</span>J</span>
<span id="cb144-7"><a href="assignment4.html#cb144-7" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb144-8"><a href="assignment4.html#cb144-8" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb144-9"><a href="assignment4.html#cb144-9" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb144-10"><a href="assignment4.html#cb144-10" tabindex="-1"></a>      V_mcmc, </span>
<span id="cb144-11"><a href="assignment4.html#cb144-11" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;i&quot;</span>, <span class="st">&quot;t&quot;</span>)</span>
<span id="cb144-12"><a href="assignment4.html#cb144-12" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb144-13"><a href="assignment4.html#cb144-13" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb144-14"><a href="assignment4.html#cb144-14" tabindex="-1"></a>      X, </span>
<span id="cb144-15"><a href="assignment4.html#cb144-15" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;j&quot;</span>)</span>
<span id="cb144-16"><a href="assignment4.html#cb144-16" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb144-17"><a href="assignment4.html#cb144-17" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb144-18"><a href="assignment4.html#cb144-18" tabindex="-1"></a>      M, </span>
<span id="cb144-19"><a href="assignment4.html#cb144-19" tabindex="-1"></a>      <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;j&quot;</span>, <span class="st">&quot;t&quot;</span>)</span>
<span id="cb144-20"><a href="assignment4.html#cb144-20" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb144-21"><a href="assignment4.html#cb144-21" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p)) <span class="sc">%&gt;%</span></span>
<span id="cb144-22"><a href="assignment4.html#cb144-22" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(</span>
<span id="cb144-23"><a href="assignment4.html#cb144-23" tabindex="-1"></a>      t, </span>
<span id="cb144-24"><a href="assignment4.html#cb144-24" tabindex="-1"></a>      i, </span>
<span id="cb144-25"><a href="assignment4.html#cb144-25" tabindex="-1"></a>      j</span>
<span id="cb144-26"><a href="assignment4.html#cb144-26" tabindex="-1"></a>      )</span>
<span id="cb144-27"><a href="assignment4.html#cb144-27" tabindex="-1"></a><span class="co"># draw idiosyncratic shocks</span></span>
<span id="cb144-28"><a href="assignment4.html#cb144-28" tabindex="-1"></a>e_mcmc <span class="ot">&lt;-</span> evd<span class="sc">::</span><span class="fu">rgev</span>(<span class="fu">dim</span>(df_mcmc)[<span class="dv">1</span>])</span></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="assignment4.html#cb145-1" tabindex="-1"></a><span class="fu">head</span>(e_mcmc)</span></code></pre></div>
<pre><code>## [1]  0.1006013  2.7039824  1.0540278  2.4697389  1.6721181 -1.0283872</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Vectorize the parameters to a vector <code>theta</code> because <code>optim</code> requires the maximiand to be a vector.</li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="assignment4.html#cb147-1" tabindex="-1"></a><span class="co"># set parameters</span></span>
<span id="cb147-2"><a href="assignment4.html#cb147-2" tabindex="-1"></a>theta <span class="ot">&lt;-</span> </span>
<span id="cb147-3"><a href="assignment4.html#cb147-3" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb147-4"><a href="assignment4.html#cb147-4" tabindex="-1"></a>    beta, </span>
<span id="cb147-5"><a href="assignment4.html#cb147-5" tabindex="-1"></a>    sigma, </span>
<span id="cb147-6"><a href="assignment4.html#cb147-6" tabindex="-1"></a>    mu, </span>
<span id="cb147-7"><a href="assignment4.html#cb147-7" tabindex="-1"></a>    omega</span>
<span id="cb147-8"><a href="assignment4.html#cb147-8" tabindex="-1"></a>    )</span>
<span id="cb147-9"><a href="assignment4.html#cb147-9" tabindex="-1"></a>theta</span></code></pre></div>
<pre><code>## [1]  4.0000000  0.1836433 -0.8356286  1.5952808  0.3295078  0.8204684  0.5000000
## [8]  1.0000000</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Estimate the parameters assuming there is no product-specific unobserved fixed effects <span class="math inline">\(\xi_{jt}\)</span>, i.e., using the functions in assignment 3. To do so, first modify <code>M</code> to <code>M_no</code> in which <code>xi</code> is replaced with 0 and estimate the model with <code>M_no</code>. Otherwise, your function will compute the share with the true <code>xi</code>.</li>
</ol>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="assignment4.html#cb149-1" tabindex="-1"></a>M_no <span class="ot">&lt;-</span> </span>
<span id="cb149-2"><a href="assignment4.html#cb149-2" tabindex="-1"></a>  M <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="assignment4.html#cb149-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">xi =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## $par
## [1]  4.0467164  0.1707430 -0.8092369  1.8086380  0.3718435  0.7275257  0.4892642
## [8]  1.0453963
## 
## $value
## [1] 0.0003270119
## 
## $counts
## function gradient 
##      221       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<pre><code>##         true  estimates
## 1  4.0000000  4.0467164
## 2  0.1836433  0.1707430
## 3 -0.8356286 -0.8092369
## 4  1.5952808  1.8086380
## 5  0.3295078  0.3718435
## 6  0.8204684  0.7275257
## 7  0.5000000  0.4892642
## 8  1.0000000  1.0453963</code></pre>
<p>Next, we estimate the model allowing for the product-market-specific unobserved fixed effect <span class="math inline">\(\xi_{jt}\)</span> using the BLP algorithm. To do so, we slightly modify the <code>compute_indirect_utility</code>, <code>compute_choice_smooth</code>, and <code>compute_share_smooth</code> functions so that they receive <span class="math inline">\(\delta_{jt}\)</span> to compute the indirect utilities, choices, and shares. Be careful that the treatment of <span class="math inline">\(\alpha_i\)</span> is slightly different from the lecture note, because we assumed that <span class="math inline">\(\alpha_i\)</span>s are log-normal random variables.</p>
<ol start="4" style="list-style-type: decimal">
<li>Compute and print out <span class="math inline">\(\delta_{jt}\)</span> at the true parameters, i.e.:
<span class="math display">\[
\delta_{jt} = \beta_0&#39; x_j + \alpha_0&#39; p_{jt} + \xi_{jt}.
\]</span></li>
</ol>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="assignment4.html#cb152-1" tabindex="-1"></a>delta</span></code></pre></div>
<pre><code>## # A tibble: 633  3
##        t     j  delta
##    &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1     1     0  0    
##  2     1     1 -0.115
##  3     1     4 -3.46 
##  4     2     0  0    
##  5     2     1 -0.920
##  6     2     3 -6.29 
##  7     2     4 -2.70 
##  8     2     6 -2.97 
##  9     2     7 -0.846
## 10     2     8  2.04 
## #  623 more rows</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Write a function <code>compute_indirect_utility_delta(df, delta, sigma, mu, omega)</code> that returns a vector whose element is the mean indirect utility of a product for a consumer in a market. The output should have the same length with <span class="math inline">\(e\)</span>. Print out the output with <span class="math inline">\(\delta_{jt}\)</span> evaluated at the true parameters. Check if the output is close to the true indirect utilities.</li>
</ol>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="assignment4.html#cb154-1" tabindex="-1"></a><span class="co"># compute indirect utility from delta</span></span>
<span id="cb154-2"><a href="assignment4.html#cb154-2" tabindex="-1"></a>u_delta <span class="ot">&lt;-</span></span>
<span id="cb154-3"><a href="assignment4.html#cb154-3" tabindex="-1"></a>  <span class="fu">compute_indirect_utility_delta</span>(</span>
<span id="cb154-4"><a href="assignment4.html#cb154-4" tabindex="-1"></a>    df, </span>
<span id="cb154-5"><a href="assignment4.html#cb154-5" tabindex="-1"></a>    delta, </span>
<span id="cb154-6"><a href="assignment4.html#cb154-6" tabindex="-1"></a>    sigma,</span>
<span id="cb154-7"><a href="assignment4.html#cb154-7" tabindex="-1"></a>    mu, </span>
<span id="cb154-8"><a href="assignment4.html#cb154-8" tabindex="-1"></a>    omega</span>
<span id="cb154-9"><a href="assignment4.html#cb154-9" tabindex="-1"></a>    )</span>
<span id="cb154-10"><a href="assignment4.html#cb154-10" tabindex="-1"></a><span class="fu">head</span>(u_delta)</span></code></pre></div>
<pre><code>##               u
## [1,]  0.0000000
## [2,] -0.6238974
## [3,] -1.6225075
## [4,]  0.0000000
## [5,]  2.6171184
## [6,]  0.6490776</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="assignment4.html#cb156-1" tabindex="-1"></a><span class="fu">summary</span>(u <span class="sc">-</span> u_delta)</span></code></pre></div>
<pre><code>##        u             
##  Min.   :-5.684e-14  
##  1st Qu.:-4.441e-16  
##  Median : 0.000e+00  
##  Mean   : 1.388e-17  
##  3rd Qu.: 3.331e-16  
##  Max.   : 5.684e-14</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Write a function <code>compute_choice_smooth_delta(X, M, V, delta, sigma, mu, omega)</code> that first construct <code>df</code> from <code>X</code>, <code>M</code>, <code>V</code>, second call <code>compute_indirect_utility_delta</code> to obtain the vector of mean indirect utilities <code>u</code>, third compute the (smooth) choice vector <code>q</code> based on the vector of mean indirect utilities, and finally return the data frame to which <code>u</code> and <code>q</code> are added as columns. Print out the output with <span class="math inline">\(\delta_{jt}\)</span> evaluated at the true parameters. Check if the output is close to the true (smooth) choice vector.</li>
</ol>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="assignment4.html#cb158-1" tabindex="-1"></a><span class="co"># compute choice</span></span>
<span id="cb158-2"><a href="assignment4.html#cb158-2" tabindex="-1"></a>df_choice_smooth_delta <span class="ot">&lt;-</span> </span>
<span id="cb158-3"><a href="assignment4.html#cb158-3" tabindex="-1"></a>  <span class="fu">compute_choice_smooth_delta</span>(</span>
<span id="cb158-4"><a href="assignment4.html#cb158-4" tabindex="-1"></a>    X, </span>
<span id="cb158-5"><a href="assignment4.html#cb158-5" tabindex="-1"></a>    M, </span>
<span id="cb158-6"><a href="assignment4.html#cb158-6" tabindex="-1"></a>    V, </span>
<span id="cb158-7"><a href="assignment4.html#cb158-7" tabindex="-1"></a>    delta, </span>
<span id="cb158-8"><a href="assignment4.html#cb158-8" tabindex="-1"></a>    sigma, </span>
<span id="cb158-9"><a href="assignment4.html#cb158-9" tabindex="-1"></a>    mu, </span>
<span id="cb158-10"><a href="assignment4.html#cb158-10" tabindex="-1"></a>    omega</span>
<span id="cb158-11"><a href="assignment4.html#cb158-11" tabindex="-1"></a>    )</span>
<span id="cb158-12"><a href="assignment4.html#cb158-12" tabindex="-1"></a>df_choice_smooth_delta</span></code></pre></div>
<pre><code>## # A tibble: 316,500  15
##        t     i     j  v_x_1   v_x_2 v_x_3     v_p   x_1    x_2     x_3      xi
##    &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1     0 -1.37   0.211   1.65  0.0141     0  0      0       0     
##  2     1     1     1 -1.37   0.211   1.65  0.0141     1  0.975 -0.0324 -0.0156
##  3     1     1     4 -1.37   0.211   1.65  0.0141     1 -0.611  1.19    0.0418
##  4     1     2     0  1.37   0.378   1.35  0.387      0  0      0       0     
##  5     1     2     1  1.37   0.378   1.35  0.387      1  0.975 -0.0324 -0.0156
##  6     1     2     4  1.37   0.378   1.35  0.387      1 -0.611  1.19    0.0418
##  7     1     3     0 -2.06  -0.0662 -2.45 -1.17       0  0      0       0     
##  8     1     3     1 -2.06  -0.0662 -2.45 -1.17       1  0.975 -0.0324 -0.0156
##  9     1     3     4 -2.06  -0.0662 -2.45 -1.17       1 -0.611  1.19    0.0418
## 10     1     4     0 -0.992 -0.727  -1.33 -1.42       0  0      0       0     
## #  316,490 more rows
## #  4 more variables: c &lt;dbl&gt;, p &lt;dbl&gt;, u &lt;dbl&gt;, q &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="assignment4.html#cb160-1" tabindex="-1"></a><span class="fu">summary</span>(df_choice_smooth_delta)</span></code></pre></div>
<pre><code>##        t                i               j             v_x_1          
##  Min.   :  1.00   Min.   :  1.0   Min.   : 0.00   Min.   :-4.302781  
##  1st Qu.: 23.00   1st Qu.:125.8   1st Qu.: 2.00   1st Qu.:-0.685539  
##  Median : 48.00   Median :250.5   Median : 4.00   Median : 0.001041  
##  Mean   : 49.67   Mean   :250.5   Mean   : 4.49   Mean   :-0.002541  
##  3rd Qu.: 77.00   3rd Qu.:375.2   3rd Qu.: 7.00   3rd Qu.: 0.673061  
##  Max.   :100.00   Max.   :500.0   Max.   :10.00   Max.   : 3.809895  
##      v_x_2               v_x_3                v_p                 x_1       
##  Min.   :-4.542122   Min.   :-3.957618   Min.   :-4.218131   Min.   :0.000  
##  1st Qu.:-0.679702   1st Qu.:-0.672701   1st Qu.:-0.669446   1st Qu.:1.000  
##  Median : 0.000935   Median : 0.003104   Median : 0.001976   Median :1.000  
##  Mean   : 0.000478   Mean   : 0.003428   Mean   : 0.000017   Mean   :0.842  
##  3rd Qu.: 0.673109   3rd Qu.: 0.678344   3rd Qu.: 0.670699   3rd Qu.:1.000  
##  Max.   : 4.313621   Max.   : 4.244194   Max.   : 4.074300   Max.   :1.000  
##       x_2               x_3                xi                   c         
##  Min.   :-4.4294   Min.   :-3.9787   Min.   :-0.2996949   Min.   :0.0000  
##  1st Qu.:-0.6108   1st Qu.: 0.0000   1st Qu.:-0.0527368   1st Qu.:0.5250  
##  Median : 0.7797   Median : 1.1878   Median : 0.0000000   Median :0.8775  
##  Mean   : 0.3015   Mean   : 0.5034   Mean   :-0.0005149   Mean   :0.9507  
##  3rd Qu.: 1.4766   3rd Qu.: 1.6424   3rd Qu.: 0.0556663   3rd Qu.:1.3203  
##  Max.   : 3.0236   Max.   : 1.8877   Max.   : 0.3810277   Max.   :4.3043  
##        p               u                  q           
##  Min.   :0.000   Min.   :-345.287   Min.   :0.000000  
##  1st Qu.:1.516   1st Qu.:  -3.030   1st Qu.:0.001435  
##  Median :1.916   Median :   0.000   Median :0.030121  
##  Mean   :1.797   Mean   :  -1.869   Mean   :0.157978  
##  3rd Qu.:2.336   3rd Qu.:   1.559   3rd Qu.:0.161379  
##  Max.   :5.513   Max.   :  22.434   Max.   :1.000000</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="assignment4.html#cb162-1" tabindex="-1"></a><span class="fu">summary</span>(df_choice_smooth<span class="sc">$</span>q <span class="sc">-</span> df_choice_smooth_delta<span class="sc">$</span>q)</span></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -9.437e-16 -6.939e-18  0.000e+00 -1.050e-19  1.843e-18  9.992e-16</code></pre>
<ol start="7" style="list-style-type: decimal">
<li>Write a function <code>compute_share_delta(X, M, V, delta, sigma, mu, omega)</code> that first construct <code>df</code> from <code>X</code>, <code>M</code>, <code>V</code>, second call <code>compute_choice_delta</code> to obtain a data frame with <code>u</code> and <code>q</code>, third compute the share of each product at each market <code>s</code> and the log difference in the share from the outside option, <span class="math inline">\(\ln(s_{jt}/s_{0t})\)</span>, denoted by <code>y</code>, and finally return the data frame that is summarized at the product-market level, dropped consumer-level variables, and added <code>s</code> and <code>y</code>.</li>
</ol>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="assignment4.html#cb164-1" tabindex="-1"></a><span class="co"># compute share</span></span>
<span id="cb164-2"><a href="assignment4.html#cb164-2" tabindex="-1"></a>df_share_smooth_delta <span class="ot">&lt;-</span></span>
<span id="cb164-3"><a href="assignment4.html#cb164-3" tabindex="-1"></a>  <span class="fu">compute_share_smooth_delta</span>(</span>
<span id="cb164-4"><a href="assignment4.html#cb164-4" tabindex="-1"></a>    X, </span>
<span id="cb164-5"><a href="assignment4.html#cb164-5" tabindex="-1"></a>    M, </span>
<span id="cb164-6"><a href="assignment4.html#cb164-6" tabindex="-1"></a>    V, </span>
<span id="cb164-7"><a href="assignment4.html#cb164-7" tabindex="-1"></a>    delta, </span>
<span id="cb164-8"><a href="assignment4.html#cb164-8" tabindex="-1"></a>    sigma, </span>
<span id="cb164-9"><a href="assignment4.html#cb164-9" tabindex="-1"></a>    mu, </span>
<span id="cb164-10"><a href="assignment4.html#cb164-10" tabindex="-1"></a>    omega</span>
<span id="cb164-11"><a href="assignment4.html#cb164-11" tabindex="-1"></a>    ) </span>
<span id="cb164-12"><a href="assignment4.html#cb164-12" tabindex="-1"></a>df_share_smooth_delta</span></code></pre></div>
<pre><code>## # A tibble: 633  11
##        t     j   x_1    x_2     x_3      xi     c     p      q      s      y
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1     1     0     0  0      0       0      0      0    199.   0.398   0    
##  2     1     1     1  0.975 -0.0324 -0.0156 0.604  1.58 260.   0.521   0.270
##  3     1     4     1 -0.611  1.19    0.0418 1.30   2.35  40.8  0.0816 -1.58 
##  4     2     0     0  0      0       0      0      0    106.   0.211   0    
##  5     2     1     1  0.975 -0.0324 -0.0394 0.890  1.87  32.9  0.0658 -1.17 
##  6     2     3     1  1.15   1.64    0.110  2.29   3.40   6.78 0.0136 -2.75 
##  7     2     4     1 -0.611  1.19    0.0763 0.997  2.09  14.1  0.0282 -2.01 
##  8     2     6     1  0.780  1.56   -0.0253 1.15   2.13  17.4  0.0347 -1.81 
##  9     2     7     1 -1.24   0.149   0.0697 0.613  1.68  25.2  0.0504 -1.43 
## 10     2     8     1 -4.43  -3.98    0.0557 0.629  1.67 290.   0.580   1.01 
## #  623 more rows</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="assignment4.html#cb166-1" tabindex="-1"></a><span class="fu">summary</span>(df_share_smooth_delta)</span></code></pre></div>
<pre><code>##        t                j              x_1             x_2         
##  Min.   :  1.00   Min.   : 0.00   Min.   :0.000   Min.   :-4.4294  
##  1st Qu.: 23.00   1st Qu.: 2.00   1st Qu.:1.000   1st Qu.:-0.6108  
##  Median : 48.00   Median : 4.00   Median :1.000   Median : 0.7797  
##  Mean   : 49.67   Mean   : 4.49   Mean   :0.842   Mean   : 0.3015  
##  3rd Qu.: 77.00   3rd Qu.: 7.00   3rd Qu.:1.000   3rd Qu.: 1.4766  
##  Max.   :100.00   Max.   :10.00   Max.   :1.000   Max.   : 3.0236  
##       x_3                xi                   c                p        
##  Min.   :-3.9787   Min.   :-0.2996949   Min.   :0.0000   Min.   :0.000  
##  1st Qu.: 0.0000   1st Qu.:-0.0527368   1st Qu.:0.5250   1st Qu.:1.516  
##  Median : 1.1878   Median : 0.0000000   Median :0.8775   Median :1.916  
##  Mean   : 0.5034   Mean   :-0.0005149   Mean   :0.9507   Mean   :1.797  
##  3rd Qu.: 1.6424   3rd Qu.: 0.0556663   3rd Qu.:1.3203   3rd Qu.:2.336  
##  Max.   : 1.8877   Max.   : 0.3810277   Max.   :4.3043   Max.   :5.513  
##        q                 s                  y           
##  Min.   :  1.748   Min.   :0.003497   Min.   :-4.23971  
##  1st Qu.: 17.982   1st Qu.:0.035964   1st Qu.:-1.95098  
##  Median : 40.241   Median :0.080483   Median :-1.22808  
##  Mean   : 78.989   Mean   :0.157978   Mean   :-1.15979  
##  3rd Qu.:123.006   3rd Qu.:0.246011   3rd Qu.:-0.03626  
##  Max.   :325.631   Max.   :0.651262   Max.   : 1.26578</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="assignment4.html#cb168-1" tabindex="-1"></a><span class="fu">summary</span>(df_share_smooth<span class="sc">$</span>s <span class="sc">-</span> df_share_smooth_delta<span class="sc">$</span>s)</span></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -1.665e-16 -1.388e-17  0.000e+00  5.549e-20  6.939e-18  2.220e-16</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Write a function <code>solve_delta(df_share_smooth, X, M, V, delta, sigma, mu, omega)</code> that finds <span class="math inline">\(\delta_{jt}\)</span> that equates the actua share and the predicted share based on <code>compute_share_smooth_delta</code> by the fixed-point algorithm with an operator:
<span class="math display">\[
T(\delta_{jt}^{(r)}) = \delta_{jt}^{(r)} + \kappa \cdot \log\left(\frac{s_{jt}}{\sigma_{jt}[\delta^{(r)}]}\right),
\]</span>
where <span class="math inline">\(s_{jt}\)</span> is the actual share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> and <span class="math inline">\(\sigma_{jt}[\delta^{(r)}]\)</span> is the predicted share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> given <span class="math inline">\(\delta^{(r)}\)</span>. Multiplying <span class="math inline">\(\kappa\)</span> is for the numerical stability. I set the value at <span class="math inline">\(\kappa = 1\)</span>. Adjust it if the algorithm did not work. Set the stopping criterion at <span class="math inline">\(\max_{jt}|\delta_{jt}^{(r + 1)} - \delta_{jt}^{(r)}| &lt; \lambda\)</span>. Set <span class="math inline">\(\lambda\)</span> at <span class="math inline">\(10^{-6}\)</span>. Make sure that <span class="math inline">\(\delta_{i0t}\)</span> is always set at zero while the iteration.</li>
</ol>
<p>Start the algorithm with the true <span class="math inline">\(\delta_{jt}\)</span> and check if the algorithm returns (almost) the same <span class="math inline">\(\delta_{jt}\)</span> when the actual and predicted smooth share are equated.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="assignment4.html#cb170-1" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb170-2"><a href="assignment4.html#cb170-2" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb170-3"><a href="assignment4.html#cb170-3" tabindex="-1"></a>delta_new <span class="ot">&lt;-</span></span>
<span id="cb170-4"><a href="assignment4.html#cb170-4" tabindex="-1"></a>  <span class="fu">solve_delta</span>(</span>
<span id="cb170-5"><a href="assignment4.html#cb170-5" tabindex="-1"></a>    df_share_smooth, </span>
<span id="cb170-6"><a href="assignment4.html#cb170-6" tabindex="-1"></a>    X, </span>
<span id="cb170-7"><a href="assignment4.html#cb170-7" tabindex="-1"></a>    M, </span>
<span id="cb170-8"><a href="assignment4.html#cb170-8" tabindex="-1"></a>    V, </span>
<span id="cb170-9"><a href="assignment4.html#cb170-9" tabindex="-1"></a>    delta, </span>
<span id="cb170-10"><a href="assignment4.html#cb170-10" tabindex="-1"></a>    sigma, </span>
<span id="cb170-11"><a href="assignment4.html#cb170-11" tabindex="-1"></a>    mu, </span>
<span id="cb170-12"><a href="assignment4.html#cb170-12" tabindex="-1"></a>    omega, </span>
<span id="cb170-13"><a href="assignment4.html#cb170-13" tabindex="-1"></a>    kappa, </span>
<span id="cb170-14"><a href="assignment4.html#cb170-14" tabindex="-1"></a>    lambda</span>
<span id="cb170-15"><a href="assignment4.html#cb170-15" tabindex="-1"></a>    )</span>
<span id="cb170-16"><a href="assignment4.html#cb170-16" tabindex="-1"></a><span class="fu">head</span>(delta_new)</span></code></pre></div>
<pre><code>## # A tibble: 6  3
##       t     j  delta
##   &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1     1     0  0    
## 2     1     1 -0.115
## 3     1     4 -3.46 
## 4     2     0  0    
## 5     2     1 -0.920
## 6     2     3 -6.29</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="assignment4.html#cb172-1" tabindex="-1"></a><span class="fu">summary</span>(delta_new<span class="sc">$</span>delta <span class="sc">-</span> delta<span class="sc">$</span>delta)</span></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -1.776e-15 -2.220e-16  0.000e+00 -1.193e-17  0.000e+00  1.776e-15</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Check how long it takes to compute the limit <span class="math inline">\(\delta\)</span> under the Monte Carlo shocks starting from the true <span class="math inline">\(\delta\)</span> to match with <code>df_share_smooth</code>. This is approximately the time to evaluate the objective function.</li>
</ol>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="assignment4.html#cb174-1" tabindex="-1"></a>delta_new <span class="ot">&lt;-</span></span>
<span id="cb174-2"><a href="assignment4.html#cb174-2" tabindex="-1"></a>  <span class="fu">solve_delta</span>(</span>
<span id="cb174-3"><a href="assignment4.html#cb174-3" tabindex="-1"></a>    df_share_smooth, </span>
<span id="cb174-4"><a href="assignment4.html#cb174-4" tabindex="-1"></a>    X, </span>
<span id="cb174-5"><a href="assignment4.html#cb174-5" tabindex="-1"></a>    M, </span>
<span id="cb174-6"><a href="assignment4.html#cb174-6" tabindex="-1"></a>    V_mcmc, </span>
<span id="cb174-7"><a href="assignment4.html#cb174-7" tabindex="-1"></a>    delta, </span>
<span id="cb174-8"><a href="assignment4.html#cb174-8" tabindex="-1"></a>    sigma, </span>
<span id="cb174-9"><a href="assignment4.html#cb174-9" tabindex="-1"></a>    mu, </span>
<span id="cb174-10"><a href="assignment4.html#cb174-10" tabindex="-1"></a>    omega, </span>
<span id="cb174-11"><a href="assignment4.html#cb174-11" tabindex="-1"></a>    kappa, </span>
<span id="cb174-12"><a href="assignment4.html#cb174-12" tabindex="-1"></a>    lambda</span>
<span id="cb174-13"><a href="assignment4.html#cb174-13" tabindex="-1"></a>  )</span>
<span id="cb174-14"><a href="assignment4.html#cb174-14" tabindex="-1"></a><span class="fu">saveRDS</span>(</span>
<span id="cb174-15"><a href="assignment4.html#cb174-15" tabindex="-1"></a>  delta_new, </span>
<span id="cb174-16"><a href="assignment4.html#cb174-16" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;lecture/data/a4/delta_new.rds&quot;</span> <span class="sc">%&gt;%</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb174-17"><a href="assignment4.html#cb174-17" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="assignment4.html#cb175-1" tabindex="-1"></a>delta_new <span class="ot">&lt;-</span> </span>
<span id="cb175-2"><a href="assignment4.html#cb175-2" tabindex="-1"></a>  <span class="fu">readRDS</span>(</span>
<span id="cb175-3"><a href="assignment4.html#cb175-3" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">&quot;lecture/data/a4/delta_new.rds&quot;</span> <span class="sc">%&gt;%</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb175-4"><a href="assignment4.html#cb175-4" tabindex="-1"></a>  )</span>
<span id="cb175-5"><a href="assignment4.html#cb175-5" tabindex="-1"></a><span class="fu">summary</span>(delta_new<span class="sc">$</span>delta <span class="sc">-</span> delta<span class="sc">$</span>delta)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -1.43733 -0.28081  0.00000 -0.01762  0.22132  1.12425</code></pre>
<ol start="10" style="list-style-type: decimal">
<li>We use the marginal cost <span class="math inline">\(c_{jt}\)</span> as the excluded instrumental variable for <span class="math inline">\(p_{jt}\)</span>. Let <span class="math inline">\(\Psi\)</span> be the weighing matrix for the GMM estimator. For now, let it be the identity matrix. Write a function <code>compute_theta_linear(df_share_smooth, delta, mu, omega, Psi)</code> that returns the optimal linear parameters associated with the data and <span class="math inline">\(\delta\)</span>. Notice that we only obtain <span class="math inline">\(\beta_0\)</span> in this way because <span class="math inline">\(\alpha_0\)</span> is directly computed from the non-linear parameters by <span class="math inline">\(-\exp(\mu + \omega^2/2)\)</span>. The first order condition for <span class="math inline">\(\beta_0\)</span> is:
<span class="math display">\[\begin{equation}
\beta_0 = (X&#39;W \Phi^{-1} W&#39;X)^{-1} X&#39; W \Phi^{-1} W&#39; [\delta - \alpha_0 p],
\end{equation}\]</span>
where</li>
</ol>
<p><span class="math display">\[\begin{equation}
X =
\begin{pmatrix}
x_{11}&#39;\\
\vdots \\
x_{J_1 1}&#39;\\
\vdots \\
x_{1T}&#39; \\
\vdots \\
x_{J_T T}
\end{pmatrix}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
W =
\begin{pmatrix}
x_{11}&#39; &amp; c_{11}\\
\vdots &amp; \vdots \\
x_{J_1 1}&#39; &amp; c_{J_1 1}\\
\vdots &amp; \vdots \\
x_{1T}&#39; &amp; c_{1T}\\
\vdots &amp; \vdots \\
x_{J_T T} &amp; c_{J_T T}
\end{pmatrix},
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\delta =
\begin{pmatrix}
\delta_11\\
\vdots\\
\delta_{J_1 1}\\
\vdots\\
\delta_1T\\
\vdots\\
\delta_{J_T T}\\
\end{pmatrix}
\end{equation}\]</span>,</p>
<p>where <span class="math inline">\(\alpha_0 = - \exp(\mu + \omega^2/2)\)</span>. Notice that <span class="math inline">\(X\)</span> and <span class="math inline">\(W\)</span> does not include rows for the outwide option.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="assignment4.html#cb177-1" tabindex="-1"></a>Psi <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">length</span>(beta) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb177-2"><a href="assignment4.html#cb177-2" tabindex="-1"></a>theta_linear <span class="ot">&lt;-</span></span>
<span id="cb177-3"><a href="assignment4.html#cb177-3" tabindex="-1"></a>  <span class="fu">compute_theta_linear</span>(</span>
<span id="cb177-4"><a href="assignment4.html#cb177-4" tabindex="-1"></a>    df_share_smooth, </span>
<span id="cb177-5"><a href="assignment4.html#cb177-5" tabindex="-1"></a>    delta, </span>
<span id="cb177-6"><a href="assignment4.html#cb177-6" tabindex="-1"></a>    mu, </span>
<span id="cb177-7"><a href="assignment4.html#cb177-7" tabindex="-1"></a>    omega, </span>
<span id="cb177-8"><a href="assignment4.html#cb177-8" tabindex="-1"></a>    Psi</span>
<span id="cb177-9"><a href="assignment4.html#cb177-9" tabindex="-1"></a>    ) </span>
<span id="cb177-10"><a href="assignment4.html#cb177-10" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb177-11"><a href="assignment4.html#cb177-11" tabindex="-1"></a>  theta_linear, </span>
<span id="cb177-12"><a href="assignment4.html#cb177-12" tabindex="-1"></a>  beta</span>
<span id="cb177-13"><a href="assignment4.html#cb177-13" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>##          delta       beta
## x_1  3.9946731  4.0000000
## x_2  0.1747411  0.1836433
## x_3 -0.8244048 -0.8356286</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Write a function <code>solve_xi(df_share_smooth, delta, beta, mu, omega)</code> that computes the values of <span class="math inline">\(\xi\)</span> that are implied from the data, <span class="math inline">\(\delta\)</span>, and the linear parameters. Check that the (almost) true values are returned when true <span class="math inline">\(\delta\)</span> and the true linear parmaeters are passed to the function. Notice that the returend <span class="math inline">\(\xi\)</span> should not include rows for the outside option.</li>
</ol>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="assignment4.html#cb179-1" tabindex="-1"></a>xi_new <span class="ot">&lt;-</span> </span>
<span id="cb179-2"><a href="assignment4.html#cb179-2" tabindex="-1"></a>  <span class="fu">solve_xi</span>(</span>
<span id="cb179-3"><a href="assignment4.html#cb179-3" tabindex="-1"></a>    df_share_smooth, </span>
<span id="cb179-4"><a href="assignment4.html#cb179-4" tabindex="-1"></a>    delta, </span>
<span id="cb179-5"><a href="assignment4.html#cb179-5" tabindex="-1"></a>    beta, </span>
<span id="cb179-6"><a href="assignment4.html#cb179-6" tabindex="-1"></a>    mu, </span>
<span id="cb179-7"><a href="assignment4.html#cb179-7" tabindex="-1"></a>    omega</span>
<span id="cb179-8"><a href="assignment4.html#cb179-8" tabindex="-1"></a>    )</span>
<span id="cb179-9"><a href="assignment4.html#cb179-9" tabindex="-1"></a><span class="fu">head</span>(xi_new)</span></code></pre></div>
<pre><code>##               xi
## [1,] -0.01557955
## [2,]  0.04179416
## [3,] -0.03942900
## [4,]  0.11000254
## [5,]  0.07631757
## [6,] -0.02533617</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="assignment4.html#cb181-1" tabindex="-1"></a>xi_true <span class="ot">&lt;-</span></span>
<span id="cb181-2"><a href="assignment4.html#cb181-2" tabindex="-1"></a>  df_share_smooth <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="assignment4.html#cb181-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(j <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="assignment4.html#cb181-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(xi)</span>
<span id="cb181-5"><a href="assignment4.html#cb181-5" tabindex="-1"></a><span class="fu">summary</span>(xi_true <span class="sc">-</span> xi_new)</span></code></pre></div>
<pre><code>##        xi            
##  Min.   :-4.233e-16  
##  1st Qu.:-5.551e-17  
##  Median : 0.000e+00  
##  Mean   : 1.347e-17  
##  3rd Qu.: 8.327e-17  
##  Max.   : 8.604e-16</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Write a function <code>compute_gmm_objective_a4(theta_nonlinear, delta, df_share_smooth, Psi, X, M, V_mcmc, kappa, lambda)</code> that returns the value of the GMM objective function as a function of non-linear parameters <code>mu</code>, <code>omega</code>, and <code>sigma</code>:
<span class="math display">\[
\min_{\theta} \xi(\theta)&#39; W \Phi^{-1} W&#39; \xi(\theta),
\]</span>
where <span class="math inline">\(\xi(\theta)\)</span> is the values of <span class="math inline">\(\xi\)</span> that solves:
<span class="math display">\[
s = \sigma(p, x, \xi),
\]</span>
given parameters <span class="math inline">\(\theta\)</span>. Note that the row of <span class="math inline">\(\xi(\theta)\)</span> and <span class="math inline">\(W\)</span> do not include the rows for the outside options.</li>
</ol>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="assignment4.html#cb183-1" tabindex="-1"></a><span class="co"># non-linear parmaeters</span></span>
<span id="cb183-2"><a href="assignment4.html#cb183-2" tabindex="-1"></a>theta_nonlinear <span class="ot">&lt;-</span> </span>
<span id="cb183-3"><a href="assignment4.html#cb183-3" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb183-4"><a href="assignment4.html#cb183-4" tabindex="-1"></a>    mu, </span>
<span id="cb183-5"><a href="assignment4.html#cb183-5" tabindex="-1"></a>    omega, </span>
<span id="cb183-6"><a href="assignment4.html#cb183-6" tabindex="-1"></a>    sigma</span>
<span id="cb183-7"><a href="assignment4.html#cb183-7" tabindex="-1"></a>    )</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="assignment4.html#cb184-1" tabindex="-1"></a><span class="co"># compute GMM objective function</span></span>
<span id="cb184-2"><a href="assignment4.html#cb184-2" tabindex="-1"></a>objective <span class="ot">&lt;-</span></span>
<span id="cb184-3"><a href="assignment4.html#cb184-3" tabindex="-1"></a>  <span class="fu">compute_gmm_objective_a4</span>(</span>
<span id="cb184-4"><a href="assignment4.html#cb184-4" tabindex="-1"></a>    theta_nonlinear, </span>
<span id="cb184-5"><a href="assignment4.html#cb184-5" tabindex="-1"></a>    delta, </span>
<span id="cb184-6"><a href="assignment4.html#cb184-6" tabindex="-1"></a>    df_share_smooth, </span>
<span id="cb184-7"><a href="assignment4.html#cb184-7" tabindex="-1"></a>    Psi, </span>
<span id="cb184-8"><a href="assignment4.html#cb184-8" tabindex="-1"></a>    X, </span>
<span id="cb184-9"><a href="assignment4.html#cb184-9" tabindex="-1"></a>    M, </span>
<span id="cb184-10"><a href="assignment4.html#cb184-10" tabindex="-1"></a>    V_mcmc, </span>
<span id="cb184-11"><a href="assignment4.html#cb184-11" tabindex="-1"></a>    kappa, </span>
<span id="cb184-12"><a href="assignment4.html#cb184-12" tabindex="-1"></a>    lambda</span>
<span id="cb184-13"><a href="assignment4.html#cb184-13" tabindex="-1"></a>    ) </span>
<span id="cb184-14"><a href="assignment4.html#cb184-14" tabindex="-1"></a><span class="fu">saveRDS</span>(</span>
<span id="cb184-15"><a href="assignment4.html#cb184-15" tabindex="-1"></a>  objective, </span>
<span id="cb184-16"><a href="assignment4.html#cb184-16" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;lecture/data/a4/objective.rds&quot;</span> <span class="sc">%&gt;%</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb184-17"><a href="assignment4.html#cb184-17" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="assignment4.html#cb185-1" tabindex="-1"></a>objective <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb185-2"><a href="assignment4.html#cb185-2" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;lecture/data/a4/objective.rds&quot;</span> <span class="sc">%&gt;%</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb185-3"><a href="assignment4.html#cb185-3" tabindex="-1"></a>)</span>
<span id="cb185-4"><a href="assignment4.html#cb185-4" tabindex="-1"></a>objective</span></code></pre></div>
<pre><code>##          xi
## xi 16.37845</code></pre>
<ol start="12" style="list-style-type: decimal">
<li>Draw a graph of the objective function that varies each non-linear parameter from 0, 0.2, <span class="math inline">\(\cdots\)</span>, 2.0 of the true value. Try with the actual shocks <code>V</code>.</li>
</ol>
<pre><code>## [[1]]</code></pre>
<p><img src="lecture_files/figure-html/unnamed-chunk-119-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[2]]</code></pre>
<p><img src="lecture_files/figure-html/unnamed-chunk-119-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[3]]</code></pre>
<p><img src="lecture_files/figure-html/unnamed-chunk-119-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[4]]</code></pre>
<p><img src="lecture_files/figure-html/unnamed-chunk-119-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code>## 
## [[5]]</code></pre>
<p><img src="lecture_files/figure-html/unnamed-chunk-119-5.png" width="672" style="display: block; margin: auto;" /></p>
<ol start="13" style="list-style-type: decimal">
<li>Find non-linear parameters that minimize the GMM objective function. Because standard deviations of the same absolute value with positive and negative values have almost the same implication for the data, you can take the absolute value if the estimates of the standard deviations happened to be negative (Another way is to set the non-negativity constraints on the standard deviations).</li>
</ol>
<pre><code>## $par
## [1] 0.4928139 1.0228455 1.5913062 0.3913233 0.8707353
## 
## $value
## [1] 7.353949e-08
## 
## $counts
## function gradient 
##      140       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<pre><code>##           true  estimate
## [1,] 0.5000000 0.4928139
## [2,] 1.0000000 1.0228455
## [3,] 1.5952808 1.5913062
## [4,] 0.3295078 0.3913233
## [5,] 0.8204684 0.8707353</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="assignment3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="assignment5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["lecture.pdf", "lecture.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
