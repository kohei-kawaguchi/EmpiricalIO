<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Integrating with C++ using Rcpp and RcppEigen | ECON5630 Topics in Empirical Industrial Organization</title>
  <meta name="description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Integrating with C++ using Rcpp and RcppEigen | ECON5630 Topics in Empirical Industrial Organization" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Integrating with C++ using Rcpp and RcppEigen | ECON5630 Topics in Empirical Industrial Organization" />
  
  <meta name="twitter:description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  

<meta name="author" content="Kohei Kawaguchi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="assignment9.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECON5630</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#general-information"><i class="fa fa-check"></i><b>1.2</b> General Information</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#class-time"><i class="fa fa-check"></i><b>1.2.1</b> Class Time</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>1.2.2</b> Description</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#expectation-and-goals"><i class="fa fa-check"></i><b>1.2.3</b> Expectation and Goals</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#required-environment"><i class="fa fa-check"></i><b>1.3</b> Required Environment</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#evaluation"><i class="fa fa-check"></i><b>1.4</b> Evaluation</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#academic-integrity"><i class="fa fa-check"></i><b>1.5</b> Academic Integrity</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.6</b> Schedule</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#course-materials"><i class="fa fa-check"></i><b>1.7</b> Course Materials</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#code"><i class="fa fa-check"></i><b>1.7.1</b> Code</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.7.2</b> R and RStudio</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#handbook-chapters"><i class="fa fa-check"></i><b>1.7.3</b> Handbook Chapters</a></li>
<li class="chapter" data-level="1.7.4" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i><b>1.7.4</b> Books</a></li>
<li class="chapter" data-level="1.7.5" data-path="index.html"><a href="index.html#papers"><i class="fa fa-check"></i><b>1.7.5</b> Papers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-are-structural-models"><i class="fa fa-check"></i><b>2.1</b> What are structural models?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#example-linear-demand-and-supply-model"><i class="fa fa-check"></i><b>2.2</b> Example: Linear demand and supply model</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ordinary-least-squares-ols-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.3</b> Ordinary-Least-Squares (OLS) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#maximum-likelihood-estimation-mle-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.4</b> Maximum-Likelihood Estimation (MLE) of the demand and supply model</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#simulation-based-simulated-likelihood-or-simulated-method-of-moments-methods"><i class="fa fa-check"></i><b>2.5</b> Simulation-based (Simulated-Likelihood or Simulated-Method-of-Moments) methods</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#two-stage-least-squares-2sls-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.6</b> Two-Stage Least Squares (2SLS) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#instrumental-variables-iv-and-generalized-method-of-moments-gmm-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.7</b> Instrumental-Variables (IV) and Generalized Method of Moments (GMM) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#general-case"><i class="fa fa-check"></i><b>2.8</b> General Case</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#structural-estimation-and-counterfactual-analysis"><i class="fa fa-check"></i><b>2.9</b> Structural Estimation and Counterfactual Analysis</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="intro.html"><a href="intro.html#example"><i class="fa fa-check"></i><b>2.9.1</b> Example</a></li>
<li class="chapter" data-level="2.9.2" data-path="intro.html"><a href="intro.html#recap"><i class="fa fa-check"></i><b>2.9.2</b> Recap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="production.html"><a href="production.html"><i class="fa fa-check"></i><b>3</b> Production and Cost Function Estimation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="production.html"><a href="production.html#motivations"><i class="fa fa-check"></i><b>3.1</b> Motivations</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="production.html"><a href="production.html#io"><i class="fa fa-check"></i><b>3.1.1</b> IO</a></li>
<li class="chapter" data-level="3.1.2" data-path="production.html"><a href="production.html#development"><i class="fa fa-check"></i><b>3.1.2</b> Development</a></li>
<li class="chapter" data-level="3.1.3" data-path="production.html"><a href="production.html#trade"><i class="fa fa-check"></i><b>3.1.3</b> Trade</a></li>
<li class="chapter" data-level="3.1.4" data-path="production.html"><a href="production.html#management"><i class="fa fa-check"></i><b>3.1.4</b> Management</a></li>
<li class="chapter" data-level="3.1.5" data-path="production.html"><a href="production.html#education"><i class="fa fa-check"></i><b>3.1.5</b> Education</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="production.html"><a href="production.html#analyzing-producer-behaviors"><i class="fa fa-check"></i><b>3.2</b> Analyzing Producer Behaviors</a></li>
<li class="chapter" data-level="3.3" data-path="production.html"><a href="production.html#production-function-estimation"><i class="fa fa-check"></i><b>3.3</b> Production Function Estimation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="production.html"><a href="production.html#cobb-douglas-specification-as-a-benchmark"><i class="fa fa-check"></i><b>3.3.1</b> Cobb-Douglas Specification as a Benchmark</a></li>
<li class="chapter" data-level="3.3.2" data-path="production.html"><a href="production.html#potential-bias-i-endogeneity"><i class="fa fa-check"></i><b>3.3.2</b> Potential Bias I: Endogeneity</a></li>
<li class="chapter" data-level="3.3.3" data-path="production.html"><a href="production.html#potential-bias-ii-selection"><i class="fa fa-check"></i><b>3.3.3</b> Potential Bias II: Selection</a></li>
<li class="chapter" data-level="3.3.4" data-path="production.html"><a href="production.html#how-to-resolve-endogeneity-bias"><i class="fa fa-check"></i><b>3.3.4</b> How to Resolve Endogeneity Bias?</a></li>
<li class="chapter" data-level="3.3.5" data-path="production.html"><a href="production.html#panel-data"><i class="fa fa-check"></i><b>3.3.5</b> Panel Data</a></li>
<li class="chapter" data-level="3.3.6" data-path="production.html"><a href="production.html#first-order-condition-for-inputs"><i class="fa fa-check"></i><b>3.3.6</b> First-Order Condition for Inputs</a></li>
<li class="chapter" data-level="3.3.7" data-path="production.html"><a href="production.html#productioniv"><i class="fa fa-check"></i><b>3.3.7</b> Instrumental Variable</a></li>
<li class="chapter" data-level="3.3.8" data-path="production.html"><a href="production.html#olley-pakes-approach"><i class="fa fa-check"></i><b>3.3.8</b> Olley-Pakes Approach</a></li>
<li class="chapter" data-level="3.3.9" data-path="production.html"><a href="production.html#assumption-i-information-set"><i class="fa fa-check"></i><b>3.3.9</b> Assumption I: Information Set</a></li>
<li class="chapter" data-level="3.3.10" data-path="production.html"><a href="production.html#assumption-ii-first-order-markov"><i class="fa fa-check"></i><b>3.3.10</b> Assumption II: First Order Markov</a></li>
<li class="chapter" data-level="3.3.11" data-path="production.html"><a href="production.html#assumption-iii-timing-of-input-choices"><i class="fa fa-check"></i><b>3.3.11</b> Assumption III: Timing of Input Choices</a></li>
<li class="chapter" data-level="3.3.12" data-path="production.html"><a href="production.html#assumption-iv-scalar-unobservable"><i class="fa fa-check"></i><b>3.3.12</b> Assumption IV: Scalar Unobservable</a></li>
<li class="chapter" data-level="3.3.13" data-path="production.html"><a href="production.html#assumption-iv-strict-monotonicity"><i class="fa fa-check"></i><b>3.3.13</b> Assumption IV: Strict Monotonicity</a></li>
<li class="chapter" data-level="3.3.14" data-path="production.html"><a href="production.html#two-step-approach-the-first-step"><i class="fa fa-check"></i><b>3.3.14</b> Two-step Approach: The First Step</a></li>
<li class="chapter" data-level="3.3.15" data-path="production.html"><a href="production.html#two-step-approach-the-second-step"><i class="fa fa-check"></i><b>3.3.15</b> Two-step Approach: The Second Step</a></li>
<li class="chapter" data-level="3.3.16" data-path="production.html"><a href="production.html#identification-of-the-anticipated-shocks"><i class="fa fa-check"></i><b>3.3.16</b> Identification of the Anticipated Shocks</a></li>
<li class="chapter" data-level="3.3.17" data-path="production.html"><a href="production.html#two-step-estimation-of-olley1996."><i class="fa fa-check"></i><b>3.3.17</b> Two-Step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span>.</a></li>
<li class="chapter" data-level="3.3.18" data-path="production.html"><a href="production.html#from-an-economic-models-to-an-econometric-model"><i class="fa fa-check"></i><b>3.3.18</b> From An Economic Models to An Econometric Model</a></li>
<li class="chapter" data-level="3.3.19" data-path="production.html"><a href="production.html#how-to-resolve-selection-bias"><i class="fa fa-check"></i><b>3.3.19</b> How to Resolve Selection Bias</a></li>
<li class="chapter" data-level="3.3.20" data-path="production.html"><a href="production.html#correction-in-the-first-step"><i class="fa fa-check"></i><b>3.3.20</b> Correction in the First Step</a></li>
<li class="chapter" data-level="3.3.21" data-path="production.html"><a href="production.html#correction-in-the-second-step-i-the-source-of-bias"><i class="fa fa-check"></i><b>3.3.21</b> Correction in the Second Step I: The Source of Bias</a></li>
<li class="chapter" data-level="3.3.22" data-path="production.html"><a href="production.html#correction-in-the-second-step-ii-conditional-exit-probability"><i class="fa fa-check"></i><b>3.3.22</b> Correction in the Second Step II: Conditional Exit Probability</a></li>
<li class="chapter" data-level="3.3.23" data-path="production.html"><a href="production.html#correction-in-the-second-step-iii-invertibility-in-threshold"><i class="fa fa-check"></i><b>3.3.23</b> Correction in the Second Step III: Invertibility in Threshold</a></li>
<li class="chapter" data-level="3.3.24" data-path="production.html"><a href="production.html#correction-in-the-second-step-iv-controlling-the-threshold"><i class="fa fa-check"></i><b>3.3.24</b> Correction in the Second Step IV: Controlling the Threshold</a></li>
<li class="chapter" data-level="3.3.25" data-path="production.html"><a href="production.html#three-step-estimation-of-olley1996"><i class="fa fa-check"></i><b>3.3.25</b> Three Step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span></a></li>
<li class="chapter" data-level="3.3.26" data-path="production.html"><a href="production.html#zero-investment-problem"><i class="fa fa-check"></i><b>3.3.26</b> Zero Investment Problem</a></li>
<li class="chapter" data-level="3.3.27" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-i-discard-some-data"><i class="fa fa-check"></i><b>3.3.27</b> Tackle Zero Investment Problem I: Discard Some Data</a></li>
<li class="chapter" data-level="3.3.28" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-ii-use-another-proxy"><i class="fa fa-check"></i><b>3.3.28</b> Tackle Zero Investment Problem II: Use Another Proxy</a></li>
<li class="chapter" data-level="3.3.29" data-path="production.html"><a href="production.html#one-step-estimation-of-olley1996-and-levinsohn2003"><i class="fa fa-check"></i><b>3.3.29</b> One-step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span> and <span class="citation">Levinsohn &amp; Petrin (2003)</span></a></li>
<li class="chapter" data-level="3.3.30" data-path="production.html"><a href="production.html#scalar-unobservable-problem-finite-order-markov-process"><i class="fa fa-check"></i><b>3.3.30</b> Scalar Unobservable Problem: Finite-order Markov Process</a></li>
<li class="chapter" data-level="3.3.31" data-path="production.html"><a href="production.html#scalar-unobservable-problem-demand-and-productivity-shocks"><i class="fa fa-check"></i><b>3.3.31</b> Scalar Unobservable Problem: Demand and Productivity Shocks</a></li>
<li class="chapter" data-level="3.3.32" data-path="production.html"><a href="production.html#collinearity-problem"><i class="fa fa-check"></i><b>3.3.32</b> Collinearity Problem</a></li>
<li class="chapter" data-level="3.3.33" data-path="production.html"><a href="production.html#tackle-collinearity-problem-peculiar-assumptions"><i class="fa fa-check"></i><b>3.3.33</b> Tackle Collinearity Problem: Peculiar Assumptions</a></li>
<li class="chapter" data-level="3.3.34" data-path="production.html"><a href="production.html#tackle-collinearity-problem-share-regression"><i class="fa fa-check"></i><b>3.3.34</b> Tackle Collinearity Problem: Share Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="production.html"><a href="production.html#cost-function-estimation"><i class="fa fa-check"></i><b>3.4</b> Cost Function Estimation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="production.html"><a href="production.html#cost-function-duality"><i class="fa fa-check"></i><b>3.4.1</b> Cost Function: Duality</a></li>
<li class="chapter" data-level="3.4.2" data-path="production.html"><a href="production.html#translog-cost-function"><i class="fa fa-check"></i><b>3.4.2</b> Translog Cost Function</a></li>
<li class="chapter" data-level="3.4.3" data-path="production.html"><a href="production.html#translog-cost-function-integrability"><i class="fa fa-check"></i><b>3.4.3</b> Translog Cost Function: Integrability</a></li>
<li class="chapter" data-level="3.4.4" data-path="production.html"><a href="production.html#two-approaches"><i class="fa fa-check"></i><b>3.4.4</b> Two Approaches</a></li>
<li class="chapter" data-level="3.4.5" data-path="production.html"><a href="production.html#cost-data-approach"><i class="fa fa-check"></i><b>3.4.5</b> Cost Data Approach</a></li>
<li class="chapter" data-level="3.4.6" data-path="production.html"><a href="production.html#revealed-preference-approach"><i class="fa fa-check"></i><b>3.4.6</b> Revealed Preference Approach</a></li>
<li class="chapter" data-level="3.4.7" data-path="production.html"><a href="production.html#single-product-monopolist"><i class="fa fa-check"></i><b>3.4.7</b> Single-product Monopolist</a></li>
<li class="chapter" data-level="3.4.8" data-path="production.html"><a href="production.html#multi-product-monopolist-case"><i class="fa fa-check"></i><b>3.4.8</b> Multi-product Monopolist Case</a></li>
<li class="chapter" data-level="3.4.9" data-path="production.html"><a href="production.html#oligopoly"><i class="fa fa-check"></i><b>3.4.9</b> Oligopoly</a></li>
<li class="chapter" data-level="3.4.10" data-path="production.html"><a href="production.html#unobserved-heterogeneity-in-the-cost-function"><i class="fa fa-check"></i><b>3.4.10</b> Unobserved Heterogeneity in the Cost Function</a></li>
<li class="chapter" data-level="3.4.11" data-path="production.html"><a href="production.html#estimation-of-cost-function"><i class="fa fa-check"></i><b>3.4.11</b> Estimation of Cost Function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="demand.html"><a href="demand.html"><i class="fa fa-check"></i><b>4</b> Demand Function Estimation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="demand.html"><a href="demand.html#motivations-1"><i class="fa fa-check"></i><b>4.1</b> Motivations</a></li>
<li class="chapter" data-level="4.2" data-path="demand.html"><a href="demand.html#analyzing-consumer-behaviors"><i class="fa fa-check"></i><b>4.2</b> Analyzing Consumer Behaviors</a></li>
<li class="chapter" data-level="4.3" data-path="demand.html"><a href="demand.html#continuous-choice"><i class="fa fa-check"></i><b>4.3</b> Continuous Choice</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="demand.html"><a href="demand.html#duality-between-utility-and-expenditure-functions"><i class="fa fa-check"></i><b>4.3.1</b> Duality between Utility and Expenditure Functions</a></li>
<li class="chapter" data-level="4.3.2" data-path="demand.html"><a href="demand.html#deriving-other-functions"><i class="fa fa-check"></i><b>4.3.2</b> Deriving Other Functions</a></li>
<li class="chapter" data-level="4.3.3" data-path="demand.html"><a href="demand.html#starting-from-an-indirect-utility-function"><i class="fa fa-check"></i><b>4.3.3</b> Starting from an Indirect Utility Function</a></li>
<li class="chapter" data-level="4.3.4" data-path="demand.html"><a href="demand.html#expenditure-share-equation"><i class="fa fa-check"></i><b>4.3.4</b> Expenditure Share Equation</a></li>
<li class="chapter" data-level="4.3.5" data-path="demand.html"><a href="demand.html#almost-ideal-demand-system-aids"><i class="fa fa-check"></i><b>4.3.5</b> Almost Ideal Demand System (AIDS)</a></li>
<li class="chapter" data-level="4.3.6" data-path="demand.html"><a href="demand.html#piglog-class"><i class="fa fa-check"></i><b>4.3.6</b> PIGLOG Class</a></li>
<li class="chapter" data-level="4.3.7" data-path="demand.html"><a href="demand.html#derive-the-share-equation-i"><i class="fa fa-check"></i><b>4.3.7</b> Derive the Share Equation I</a></li>
<li class="chapter" data-level="4.3.8" data-path="demand.html"><a href="demand.html#derive-the-share-equation-ii"><i class="fa fa-check"></i><b>4.3.8</b> Derive the Share Equation II</a></li>
<li class="chapter" data-level="4.3.9" data-path="demand.html"><a href="demand.html#specify-the-detail-ii"><i class="fa fa-check"></i><b>4.3.9</b> Specify the Detail II</a></li>
<li class="chapter" data-level="4.3.10" data-path="demand.html"><a href="demand.html#estimation"><i class="fa fa-check"></i><b>4.3.10</b> Estimation</a></li>
<li class="chapter" data-level="4.3.11" data-path="demand.html"><a href="demand.html#from-product-space-approach-to-characteristics-space-approach"><i class="fa fa-check"></i><b>4.3.11</b> From Product Space Approach to Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.3.12" data-path="demand.html"><a href="demand.html#from-continuous-choice-approach-to-discrete-choice-approach"><i class="fa fa-check"></i><b>4.3.12</b> From Continuous Choice Approach to Discrete Choice Approach</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="demand.html"><a href="demand.html#discrete-choice"><i class="fa fa-check"></i><b>4.4</b> Discrete Choice</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="demand.html"><a href="demand.html#discrete-choice-approach"><i class="fa fa-check"></i><b>4.4.1</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.2" data-path="demand.html"><a href="demand.html#discrete-choice-approach-1"><i class="fa fa-check"></i><b>4.4.2</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.3" data-path="demand.html"><a href="demand.html#discrete-choice-approach-2"><i class="fa fa-check"></i><b>4.4.3</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.4" data-path="demand.html"><a href="demand.html#characteristics-space-approach"><i class="fa fa-check"></i><b>4.4.4</b> Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.4.5" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect"><i class="fa fa-check"></i><b>4.4.5</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.6" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect-1"><i class="fa fa-check"></i><b>4.4.6</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.7" data-path="demand.html"><a href="demand.html#utility-function-normalization"><i class="fa fa-check"></i><b>4.4.7</b> Utility Function Normalization</a></li>
<li class="chapter" data-level="4.4.8" data-path="demand.html"><a href="demand.html#aggregation-of-the-individual-demand"><i class="fa fa-check"></i><b>4.4.8</b> Aggregation of the Individual Demand</a></li>
<li class="chapter" data-level="4.4.9" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation"><i class="fa fa-check"></i><b>4.4.9</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.10" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.10</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.11" data-path="demand.html"><a href="demand.html#vertical-product-differentiation"><i class="fa fa-check"></i><b>4.4.11</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.12" data-path="demand.html"><a href="demand.html#vertical-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.12</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.13" data-path="demand.html"><a href="demand.html#econometric-models"><i class="fa fa-check"></i><b>4.4.13</b> Econometric Models</a></li>
<li class="chapter" data-level="4.4.14" data-path="demand.html"><a href="demand.html#multinomial-logit-model-preference-shock"><i class="fa fa-check"></i><b>4.4.14</b> Multinomial Logit Model: Preference Shock</a></li>
<li class="chapter" data-level="4.4.15" data-path="demand.html"><a href="demand.html#multinomial-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.15</b> Multinomial Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.16" data-path="demand.html"><a href="demand.html#multinomial-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.16</b> Multinomial Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.17" data-path="demand.html"><a href="demand.html#multinomial-logit-model-inclusive-value"><i class="fa fa-check"></i><b>4.4.17</b> Multinomial Logit Model: Inclusive Value</a></li>
<li class="chapter" data-level="4.4.18" data-path="demand.html"><a href="demand.html#maximum-likelihood-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.18</b> Maximum Likelihood Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.19" data-path="demand.html"><a href="demand.html#nonlinear-least-square-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.19</b> Nonlinear Least Square Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.20" data-path="demand.html"><a href="demand.html#iia-problem"><i class="fa fa-check"></i><b>4.4.20</b> IIA Problem</a></li>
<li class="chapter" data-level="4.4.21" data-path="demand.html"><a href="demand.html#blue-bus-and-red-bus-problem"><i class="fa fa-check"></i><b>4.4.21</b> Blue Bus and Red Bus Problem</a></li>
<li class="chapter" data-level="4.4.22" data-path="demand.html"><a href="demand.html#restrictive-price-elasticity"><i class="fa fa-check"></i><b>4.4.22</b> Restrictive Price Elasticity</a></li>
<li class="chapter" data-level="4.4.23" data-path="demand.html"><a href="demand.html#monotonic-inclusive-value"><i class="fa fa-check"></i><b>4.4.23</b> Monotonic Inclusive Value</a></li>
<li class="chapter" data-level="4.4.24" data-path="demand.html"><a href="demand.html#the-source-of-the-problem"><i class="fa fa-check"></i><b>4.4.24</b> The Source of the Problem</a></li>
<li class="chapter" data-level="4.4.25" data-path="demand.html"><a href="demand.html#correlation-in-preference-shocks"><i class="fa fa-check"></i><b>4.4.25</b> Correlation in Preference Shocks</a></li>
<li class="chapter" data-level="4.4.26" data-path="demand.html"><a href="demand.html#observed-and-unobserved-consumer-heterogeneity"><i class="fa fa-check"></i><b>4.4.26</b> Observed and Unobserved Consumer Heterogeneity</a></li>
<li class="chapter" data-level="4.4.27" data-path="demand.html"><a href="demand.html#mixed-logit-model"><i class="fa fa-check"></i><b>4.4.27</b> Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.28" data-path="demand.html"><a href="demand.html#mixed-logit-model-parametric-assumptions"><i class="fa fa-check"></i><b>4.4.28</b> Mixed Logit Model : Parametric Assumptions</a></li>
<li class="chapter" data-level="4.4.29" data-path="demand.html"><a href="demand.html#mixed-logit-model-iia"><i class="fa fa-check"></i><b>4.4.29</b> Mixed Logit Model: IIA</a></li>
<li class="chapter" data-level="4.4.30" data-path="demand.html"><a href="demand.html#mixed-logit-moel-price-elasticities"><i class="fa fa-check"></i><b>4.4.30</b> Mixed Logit Moel: Price Elasticities</a></li>
<li class="chapter" data-level="4.4.31" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.31</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.32" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model-1"><i class="fa fa-check"></i><b>4.4.32</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.33" data-path="demand.html"><a href="demand.html#simulated-non-linear-least-square-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.33</b> Simulated Non-linear Least Square Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.34" data-path="demand.html"><a href="demand.html#numerical-integration-with-quadrature"><i class="fa fa-check"></i><b>4.4.34</b> Numerical Integration with Quadrature</a></li>
<li class="chapter" data-level="4.4.35" data-path="demand.html"><a href="demand.html#nested-logit-model-a-special-case-of-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.35</b> Nested Logit Model: A Special Case of Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.36" data-path="demand.html"><a href="demand.html#nested-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.36</b> Nested Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.37" data-path="demand.html"><a href="demand.html#nested-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.37</b> Nested Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.38" data-path="demand.html"><a href="demand.html#nested-logit-model-decomposition-of-the-choice-probability"><i class="fa fa-check"></i><b>4.4.38</b> Nested Logit Model: Decomposition of the Choice Probability</a></li>
<li class="chapter" data-level="4.4.39" data-path="demand.html"><a href="demand.html#nested-logit-mode-outside-inside-category-and-category-specific-shares"><i class="fa fa-check"></i><b>4.4.39</b> Nested Logit Mode: Outside, Inside-Category, and Category-specific Shares</a></li>
<li class="chapter" data-level="4.4.40" data-path="demand.html"><a href="demand.html#nonlinear-least-square-estimation-of-nested-logit-model"><i class="fa fa-check"></i><b>4.4.40</b> Nonlinear Least Square Estimation of Nested Logit Model</a></li>
<li class="chapter" data-level="4.4.41" data-path="demand.html"><a href="demand.html#discrete-choice-model-with-unobserved-fixed-effects"><i class="fa fa-check"></i><b>4.4.41</b> Discrete Choice Model with Unobserved Fixed Effects</a></li>
<li class="chapter" data-level="4.4.42" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.42</b> Unobserved Fixed Effects in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.43" data-path="demand.html"><a href="demand.html#instrumental-variables-and-inversion"><i class="fa fa-check"></i><b>4.4.43</b> Instrumental Variables and Inversion</a></li>
<li class="chapter" data-level="4.4.44" data-path="demand.html"><a href="demand.html#inversion-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.44</b> Inversion in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.45" data-path="demand.html"><a href="demand.html#market-invariant-product-specific-fixed-effects"><i class="fa fa-check"></i><b>4.4.45</b> Market-invariant Product-specific Fixed Effects</a></li>
<li class="chapter" data-level="4.4.46" data-path="demand.html"><a href="demand.html#unobserved-consumer-heterogeneity-and-unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.46</b> Unobserved Consumer Heterogeneity and Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.47" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.47</b> Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.48" data-path="demand.html"><a href="demand.html#representing-xi_jt-as-a-function-of-parameters-of-interest"><i class="fa fa-check"></i><b>4.4.48</b> Representing <span class="math inline">\(\xi_{jt}\)</span> as a Function of Parameters of Interest</a></li>
<li class="chapter" data-level="4.4.49" data-path="demand.html"><a href="demand.html#summarizing-the-conditional-mean-term"><i class="fa fa-check"></i><b>4.4.49</b> Summarizing the Conditional Mean Term</a></li>
<li class="chapter" data-level="4.4.50" data-path="demand.html"><a href="demand.html#contraction-mapping-for-delta_t."><i class="fa fa-check"></i><b>4.4.50</b> Contraction Mapping for <span class="math inline">\(\delta_t\)</span>.</a></li>
<li class="chapter" data-level="4.4.51" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta"><i class="fa fa-check"></i><b>4.4.51</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span></a></li>
<li class="chapter" data-level="4.4.52" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta-summary"><i class="fa fa-check"></i><b>4.4.52</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span>: Summary</a></li>
<li class="chapter" data-level="4.4.53" data-path="demand.html"><a href="demand.html#gmm-objective-function"><i class="fa fa-check"></i><b>4.4.53</b> GMM Objective Function</a></li>
<li class="chapter" data-level="4.4.54" data-path="demand.html"><a href="demand.html#estimating-linear-parameters"><i class="fa fa-check"></i><b>4.4.54</b> Estimating Linear Parameters</a></li>
<li class="chapter" data-level="4.4.55" data-path="demand.html"><a href="demand.html#blp-algorithm"><i class="fa fa-check"></i><b>4.4.55</b> BLP Algorithm</a></li>
<li class="chapter" data-level="4.4.56" data-path="demand.html"><a href="demand.html#mathematical-program-with-equilibrium-constraints-mpec"><i class="fa fa-check"></i><b>4.4.56</b> Mathematical Program with Equilibrium Constraints (MPEC)</a></li>
<li class="chapter" data-level="4.4.57" data-path="demand.html"><a href="demand.html#control-function-approach"><i class="fa fa-check"></i><b>4.4.57</b> Control Function Approach</a></li>
<li class="chapter" data-level="4.4.58" data-path="demand.html"><a href="demand.html#control-function-approach-1"><i class="fa fa-check"></i><b>4.4.58</b> Control Function Approach</a></li>
<li class="chapter" data-level="4.4.59" data-path="demand.html"><a href="demand.html#instrumental-variables"><i class="fa fa-check"></i><b>4.4.59</b> Instrumental Variables</a></li>
<li class="chapter" data-level="4.4.60" data-path="demand.html"><a href="demand.html#pyblp"><i class="fa fa-check"></i><b>4.4.60</b> PyBLP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="merger.html"><a href="merger.html"><i class="fa fa-check"></i><b>5</b> Merger Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="merger.html"><a href="merger.html#motivations-2"><i class="fa fa-check"></i><b>5.1</b> Motivations</a></li>
<li class="chapter" data-level="5.2" data-path="merger.html"><a href="merger.html#identification-of-conduct"><i class="fa fa-check"></i><b>5.2</b> Identification of Conduct</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="merger.html"><a href="merger.html#identification-of-conduct-1"><i class="fa fa-check"></i><b>5.2.1</b> Identification of Conduct</a></li>
<li class="chapter" data-level="5.2.2" data-path="merger.html"><a href="merger.html#marginal-revenue-function"><i class="fa fa-check"></i><b>5.2.2</b> Marginal Revenue Function</a></li>
<li class="chapter" data-level="5.2.3" data-path="merger.html"><a href="merger.html#first-order-condition"><i class="fa fa-check"></i><b>5.2.3</b> First-Order Condition</a></li>
<li class="chapter" data-level="5.2.4" data-path="merger.html"><a href="merger.html#linear-model"><i class="fa fa-check"></i><b>5.2.4</b> Linear Model</a></li>
<li class="chapter" data-level="5.2.5" data-path="merger.html"><a href="merger.html#pricing-equation"><i class="fa fa-check"></i><b>5.2.5</b> Pricing Equation</a></li>
<li class="chapter" data-level="5.2.6" data-path="merger.html"><a href="merger.html#identification-of-inverse-demand-function-and-pricing-equation"><i class="fa fa-check"></i><b>5.2.6</b> Identification of Inverse Demand Function and Pricing Equation</a></li>
<li class="chapter" data-level="5.2.7" data-path="merger.html"><a href="merger.html#the-conduct-parameter-is-unidentified"><i class="fa fa-check"></i><b>5.2.7</b> The Conduct Parameter is Unidentified</a></li>
<li class="chapter" data-level="5.2.8" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-when-cost-data-is-available"><i class="fa fa-check"></i><b>5.2.8</b> Identification of the Conduct Parameter: When Cost Data is Available</a></li>
<li class="chapter" data-level="5.2.9" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-when-cost-data-is-not-available"><i class="fa fa-check"></i><b>5.2.9</b> Identification of the Conduct Parameter: When Cost Data is Not Available</a></li>
<li class="chapter" data-level="5.2.10" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-demand-rotater-is-available"><i class="fa fa-check"></i><b>5.2.10</b> Identification of the Conduct Parameter: Demand Rotater is Available</a></li>
<li class="chapter" data-level="5.2.11" data-path="merger.html"><a href="merger.html#identification-of-conduct-in-differentiated-product-market"><i class="fa fa-check"></i><b>5.2.11</b> Identification of Conduct in Differentiated Product Market</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="merger.html"><a href="merger.html#merger-simulation"><i class="fa fa-check"></i><b>5.3</b> Merger Simulation</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="merger.html"><a href="merger.html#unilateral-and-coordinated-effects-of-a-horizontal-merger"><i class="fa fa-check"></i><b>5.3.1</b> Unilateral and Coordinated Effects of a Horizontal Merger</a></li>
<li class="chapter" data-level="5.3.2" data-path="merger.html"><a href="merger.html#merger-simulation-1"><i class="fa fa-check"></i><b>5.3.2</b> Merger Simulation</a></li>
<li class="chapter" data-level="5.3.3" data-path="merger.html"><a href="merger.html#quantifying-the-unilateral-effect"><i class="fa fa-check"></i><b>5.3.3</b> Quantifying the Unilateral Effect</a></li>
<li class="chapter" data-level="5.3.4" data-path="merger.html"><a href="merger.html#pre-merger-equilibrium"><i class="fa fa-check"></i><b>5.3.4</b> Pre-Merger Equilibrium</a></li>
<li class="chapter" data-level="5.3.5" data-path="merger.html"><a href="merger.html#post-merger-equilibrium"><i class="fa fa-check"></i><b>5.3.5</b> Post-Merger Equilibrium</a></li>
<li class="chapter" data-level="5.3.6" data-path="merger.html"><a href="merger.html#consumer-surplus"><i class="fa fa-check"></i><b>5.3.6</b> Consumer Surplus</a></li>
<li class="chapter" data-level="5.3.7" data-path="merger.html"><a href="merger.html#quantifying-the-coordinated-effect"><i class="fa fa-check"></i><b>5.3.7</b> Quantifying the Coordinated Effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="entryexit.html"><a href="entryexit.html"><i class="fa fa-check"></i><b>6</b> Entry and Exit</a>
<ul>
<li class="chapter" data-level="6.1" data-path="entryexit.html"><a href="entryexit.html#motivations-3"><i class="fa fa-check"></i><b>6.1</b> Motivations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="entryexit.html"><a href="entryexit.html#entry-cost-mode-of-competition-and-market-structure"><i class="fa fa-check"></i><b>6.1.1</b> Entry Cost, Mode of Competition, and Market Structure</a></li>
<li class="chapter" data-level="6.1.2" data-path="entryexit.html"><a href="entryexit.html#exogenous-and-endogenous-entry-cost"><i class="fa fa-check"></i><b>6.1.2</b> Exogenous and Endogenous Entry Cost</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="entryexit.html"><a href="entryexit.html#monopoly-entry"><i class="fa fa-check"></i><b>6.2</b> Monopoly Entry</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="entryexit.html"><a href="entryexit.html#variable-profits-and-fixed-costs"><i class="fa fa-check"></i><b>6.2.1</b> Variable Profits and Fixed Costs</a></li>
<li class="chapter" data-level="6.2.2" data-path="entryexit.html"><a href="entryexit.html#non-identification"><i class="fa fa-check"></i><b>6.2.2</b> Non-Identification</a></li>
<li class="chapter" data-level="6.2.3" data-path="entryexit.html"><a href="entryexit.html#restrictions-for-identification."><i class="fa fa-check"></i><b>6.2.3</b> Restrictions for Identification.</a></li>
<li class="chapter" data-level="6.2.4" data-path="entryexit.html"><a href="entryexit.html#homogeneous-of-degree-1-variable-profits"><i class="fa fa-check"></i><b>6.2.4</b> Homogeneous of Degree 1 Variable Profits</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="entryexit.html"><a href="entryexit.html#complete-information-homogeneous-oligopoly-entry"><i class="fa fa-check"></i><b>6.3</b> Complete-Information Homogeneous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="entryexit.html"><a href="entryexit.html#variable-and-fixed-costs"><i class="fa fa-check"></i><b>6.3.1</b> Variable and Fixed Costs</a></li>
<li class="chapter" data-level="6.3.2" data-path="entryexit.html"><a href="entryexit.html#equilibrium-condition"><i class="fa fa-check"></i><b>6.3.2</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="6.3.3" data-path="entryexit.html"><a href="entryexit.html#identification-under-a-shape-restriction"><i class="fa fa-check"></i><b>6.3.3</b> Identification under a Shape Restriction</a></li>
<li class="chapter" data-level="6.3.4" data-path="entryexit.html"><a href="entryexit.html#log-likelihood-function"><i class="fa fa-check"></i><b>6.3.4</b> Log Likelihood Function</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="entryexit.html"><a href="entryexit.html#complete-information-heterogeneous-oligopoly-entry"><i class="fa fa-check"></i><b>6.4</b> Complete-Information Heterogeneous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="entryexit.html"><a href="entryexit.html#bivartiate-game-with-heterogeneous-profits"><i class="fa fa-check"></i><b>6.4.1</b> Bivartiate Game with Heterogeneous Profits</a></li>
<li class="chapter" data-level="6.4.2" data-path="entryexit.html"><a href="entryexit.html#sampling-assumption-and-observations"><i class="fa fa-check"></i><b>6.4.2</b> Sampling Assumption and Observations</a></li>
<li class="chapter" data-level="6.4.3" data-path="entryexit.html"><a href="entryexit.html#identification-assuming-pure-strategy-equilibrium"><i class="fa fa-check"></i><b>6.4.3</b> Identification Assuming Pure-Strategy Equilibrium</a></li>
<li class="chapter" data-level="6.4.4" data-path="entryexit.html"><a href="entryexit.html#heterogeneous-independent-fixed-costs"><i class="fa fa-check"></i><b>6.4.4</b> Heterogeneous Independent Fixed Costs</a></li>
<li class="chapter" data-level="6.4.5" data-path="entryexit.html"><a href="entryexit.html#heterogenous-and-market-level-correlated-fixed-costs"><i class="fa fa-check"></i><b>6.4.5</b> Heterogenous and Market-Level Correlated Fixed Costs</a></li>
<li class="chapter" data-level="6.4.6" data-path="entryexit.html"><a href="entryexit.html#inference-based-on-a-unique-prediction"><i class="fa fa-check"></i><b>6.4.6</b> Inference Based On a Unique Prediction</a></li>
<li class="chapter" data-level="6.4.7" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-one-shot-game"><i class="fa fa-check"></i><b>6.4.7</b> Entry in the Airline Industry: One-shot Game</a></li>
<li class="chapter" data-level="6.4.8" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-profit-function"><i class="fa fa-check"></i><b>6.4.8</b> Entry in the Airline Industry: Profit Function</a></li>
<li class="chapter" data-level="6.4.9" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-profit-function-1"><i class="fa fa-check"></i><b>6.4.9</b> Entry in the Airline Industry: Profit Function</a></li>
<li class="chapter" data-level="6.4.10" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-likelihood-function"><i class="fa fa-check"></i><b>6.4.10</b> Entry in the Airline Industry: Likelihood Function</a></li>
<li class="chapter" data-level="6.4.11" data-path="entryexit.html"><a href="entryexit.html#is-the-equilibrium-number-of-firms-unique"><i class="fa fa-check"></i><b>6.4.11</b> Is the Equilibrium Number of Firms Unique?</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="entryexit.html"><a href="entryexit.html#multiple-prediction"><i class="fa fa-check"></i><b>6.5</b> Multiple Prediction</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="entryexit.html"><a href="entryexit.html#multiple-equilibria-in-bivariate-game-with-heterogenous-profits"><i class="fa fa-check"></i><b>6.5.1</b> Multiple Equilibria in Bivariate Game with Heterogenous Profits</a></li>
<li class="chapter" data-level="6.5.2" data-path="entryexit.html"><a href="entryexit.html#multiple-prediction-in-bivariate-game-with-heterogenous-profits"><i class="fa fa-check"></i><b>6.5.2</b> Multiple Prediction in Bivariate Game with Heterogenous Profits</a></li>
<li class="chapter" data-level="6.5.3" data-path="entryexit.html"><a href="entryexit.html#inference-based-on-moment-inequalities"><i class="fa fa-check"></i><b>6.5.3</b> Inference Based on Moment Inequalities</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="entryexit.html"><a href="entryexit.html#incompelete-information-heterogenous-oligopoly-entry"><i class="fa fa-check"></i><b>6.6</b> Incompelete-Information Heterogenous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="entryexit.html"><a href="entryexit.html#bivariate-case"><i class="fa fa-check"></i><b>6.6.1</b> Bivariate Case</a></li>
<li class="chapter" data-level="6.6.2" data-path="entryexit.html"><a href="entryexit.html#the-equilibrium-strategy-and-belief"><i class="fa fa-check"></i><b>6.6.2</b> The Equilibrium Strategy and Belief</a></li>
<li class="chapter" data-level="6.6.3" data-path="entryexit.html"><a href="entryexit.html#equilibrium-selection-and-likelihood"><i class="fa fa-check"></i><b>6.6.3</b> Equilibrium Selection and Likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dynamics.html"><a href="dynamics.html"><i class="fa fa-check"></i><b>7</b> Dynamic Decision Model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dynamics.html"><a href="dynamics.html#motivations-4"><i class="fa fa-check"></i><b>7.1</b> Motivations</a></li>
<li class="chapter" data-level="7.2" data-path="dynamics.html"><a href="dynamics.html#single-agent-model"><i class="fa fa-check"></i><b>7.2</b> Single-Agent Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="dynamics.html"><a href="dynamics.html#setting"><i class="fa fa-check"></i><b>7.2.1</b> Setting</a></li>
<li class="chapter" data-level="7.2.2" data-path="dynamics.html"><a href="dynamics.html#timing-of-the-model"><i class="fa fa-check"></i><b>7.2.2</b> Timing of the Model</a></li>
<li class="chapter" data-level="7.2.3" data-path="dynamics.html"><a href="dynamics.html#period-payoff"><i class="fa fa-check"></i><b>7.2.3</b> Period Payoff</a></li>
<li class="chapter" data-level="7.2.4" data-path="dynamics.html"><a href="dynamics.html#markovian-framework"><i class="fa fa-check"></i><b>7.2.4</b> Markovian Framework</a></li>
<li class="chapter" data-level="7.2.5" data-path="dynamics.html"><a href="dynamics.html#belief"><i class="fa fa-check"></i><b>7.2.5</b> Belief</a></li>
<li class="chapter" data-level="7.2.6" data-path="dynamics.html"><a href="dynamics.html#decision-problem"><i class="fa fa-check"></i><b>7.2.6</b> Decision Problem</a></li>
<li class="chapter" data-level="7.2.7" data-path="dynamics.html"><a href="dynamics.html#value-function-and-ex-ante-value-function"><i class="fa fa-check"></i><b>7.2.7</b> Value Function and Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.2.8" data-path="dynamics.html"><a href="dynamics.html#choice-specific-value-function"><i class="fa fa-check"></i><b>7.2.8</b> Choice-specific Value Function</a></li>
<li class="chapter" data-level="7.2.9" data-path="dynamics.html"><a href="dynamics.html#optimality-condition"><i class="fa fa-check"></i><b>7.2.9</b> Optimality Condition</a></li>
<li class="chapter" data-level="7.2.10" data-path="dynamics.html"><a href="dynamics.html#optimal-conditional-choice-probability"><i class="fa fa-check"></i><b>7.2.10</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.2.11" data-path="dynamics.html"><a href="dynamics.html#optimality-condition-1"><i class="fa fa-check"></i><b>7.2.11</b> Optimality Condition</a></li>
<li class="chapter" data-level="7.2.12" data-path="dynamics.html"><a href="dynamics.html#mapping-from-a-conditional-choice-probability-to-an-ex-ante-value-function"><i class="fa fa-check"></i><b>7.2.12</b> Mapping from a Conditional Choice Probability to an Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.2.13" data-path="dynamics.html"><a href="dynamics.html#mapping-from-an-ex-ante-value-function-to-an-optimal-conditional-choice-probability"><i class="fa fa-check"></i><b>7.2.13</b> Mapping from an Ex-ante Value Function to an Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.2.14" data-path="dynamics.html"><a href="dynamics.html#the-optimality-conditions"><i class="fa fa-check"></i><b>7.2.14</b> The Optimality Conditions</a></li>
<li class="chapter" data-level="7.2.15" data-path="dynamics.html"><a href="dynamics.html#fixed-point-algorithm"><i class="fa fa-check"></i><b>7.2.15</b> Fixed-point Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="dynamics.html"><a href="dynamics.html#identification"><i class="fa fa-check"></i><b>7.3</b> Identification</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="dynamics.html"><a href="dynamics.html#unidentification-result"><i class="fa fa-check"></i><b>7.3.1</b> Unidentification Result</a></li>
<li class="chapter" data-level="7.3.2" data-path="dynamics.html"><a href="dynamics.html#identification-when-beta-and-f-is-known"><i class="fa fa-check"></i><b>7.3.2</b> Identification when <span class="math inline">\(\beta\)</span> and <span class="math inline">\(F\)</span> is Known</a></li>
<li class="chapter" data-level="7.3.3" data-path="dynamics.html"><a href="dynamics.html#crucial-assumptions-for-the-argument"><i class="fa fa-check"></i><b>7.3.3</b> Crucial Assumptions for the Argument</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="dynamics.html"><a href="dynamics.html#estimation-by-nested-fixed-point-algorithm"><i class="fa fa-check"></i><b>7.4</b> Estimation by Nested Fixed-point Algorithm</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="dynamics.html"><a href="dynamics.html#nested-fixed-point-algorithm"><i class="fa fa-check"></i><b>7.4.1</b> Nested Fixed-Point Algorithm</a></li>
<li class="chapter" data-level="7.4.2" data-path="dynamics.html"><a href="dynamics.html#solving-for-the-ex-ante-value-function"><i class="fa fa-check"></i><b>7.4.2</b> Solving for the Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.4.3" data-path="dynamics.html"><a href="dynamics.html#estimation-by-nested-fixed-point-algorithm-1"><i class="fa fa-check"></i><b>7.4.3</b> Estimation by Nested Fixed-Point Algorithm</a></li>
<li class="chapter" data-level="7.4.4" data-path="dynamics.html"><a href="dynamics.html#full-and-partial-likelihood"><i class="fa fa-check"></i><b>7.4.4</b> Full and Partial Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="dynamics.html"><a href="dynamics.html#estimation-by-conditional-choice-probability-ccp-approach"><i class="fa fa-check"></i><b>7.5</b> Estimation by Conditional Choice Probability (CCP) Approach</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="dynamics.html"><a href="dynamics.html#ccp-approach"><i class="fa fa-check"></i><b>7.5.1</b> CCP Approach</a></li>
<li class="chapter" data-level="7.5.2" data-path="dynamics.html"><a href="dynamics.html#first-step-estimating-ccp"><i class="fa fa-check"></i><b>7.5.2</b> First Step: Estimating CCP</a></li>
<li class="chapter" data-level="7.5.3" data-path="dynamics.html"><a href="dynamics.html#first-step-estimating-ccp-1"><i class="fa fa-check"></i><b>7.5.3</b> First Step: Estimating CCP</a></li>
<li class="chapter" data-level="7.5.4" data-path="dynamics.html"><a href="dynamics.html#second-step-estimating-structural-parameters"><i class="fa fa-check"></i><b>7.5.4</b> Second Step: Estimating Structural Parameters</a></li>
<li class="chapter" data-level="7.5.5" data-path="dynamics.html"><a href="dynamics.html#second-step-estimating-structural-parameters-1"><i class="fa fa-check"></i><b>7.5.5</b> Second Step: Estimating Structural Parameters</a></li>
<li class="chapter" data-level="7.5.6" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution"><i class="fa fa-check"></i><b>7.5.6</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.7" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-1"><i class="fa fa-check"></i><b>7.5.7</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.8" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-2"><i class="fa fa-check"></i><b>7.5.8</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.9" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-3"><i class="fa fa-check"></i><b>7.5.9</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.10" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-4"><i class="fa fa-check"></i><b>7.5.10</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.11" data-path="dynamics.html"><a href="dynamics.html#general-distribution"><i class="fa fa-check"></i><b>7.5.11</b> General Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="dynamics.html"><a href="dynamics.html#unobserved-heterogeneity"><i class="fa fa-check"></i><b>7.6</b> Unobserved Heterogeneity</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="dynamics.html"><a href="dynamics.html#dynamic-decision-model-with-a-finite-mixture"><i class="fa fa-check"></i><b>7.6.1</b> Dynamic Decision Model with a Finite Mixture</a></li>
<li class="chapter" data-level="7.6.2" data-path="dynamics.html"><a href="dynamics.html#setting-1"><i class="fa fa-check"></i><b>7.6.2</b> Setting</a></li>
<li class="chapter" data-level="7.6.3" data-path="dynamics.html"><a href="dynamics.html#observation"><i class="fa fa-check"></i><b>7.6.3</b> Observation</a></li>
<li class="chapter" data-level="7.6.4" data-path="dynamics.html"><a href="dynamics.html#assumptions-finite-mixture"><i class="fa fa-check"></i><b>7.6.4</b> Further Assumptions</a></li>
<li class="chapter" data-level="7.6.5" data-path="dynamics.html"><a href="dynamics.html#lower-dimensional-submodels"><i class="fa fa-check"></i><b>7.6.5</b> Lower-dimensional Submodels</a></li>
<li class="chapter" data-level="7.6.6" data-path="dynamics.html"><a href="dynamics.html#notations"><i class="fa fa-check"></i><b>7.6.6</b> Notations</a></li>
<li class="chapter" data-level="7.6.7" data-path="dynamics.html"><a href="dynamics.html#notations-for-parameters-to-be-identified"><i class="fa fa-check"></i><b>7.6.7</b> Notations for Parameters to be Identified</a></li>
<li class="chapter" data-level="7.6.8" data-path="dynamics.html"><a href="dynamics.html#notations-for-observables"><i class="fa fa-check"></i><b>7.6.8</b> Notations for Observables</a></li>
<li class="chapter" data-level="7.6.9" data-path="dynamics.html"><a href="dynamics.html#sufficient-condition-for-identification"><i class="fa fa-check"></i><b>7.6.9</b> Sufficient Condition for Identification</a></li>
<li class="chapter" data-level="7.6.10" data-path="dynamics.html"><a href="dynamics.html#remarks-on-the-theorem"><i class="fa fa-check"></i><b>7.6.10</b> Remarks on the Theorem</a></li>
<li class="chapter" data-level="7.6.11" data-path="dynamics.html"><a href="dynamics.html#factorization-equations"><i class="fa fa-check"></i><b>7.6.11</b> Factorization Equations</a></li>
<li class="chapter" data-level="7.6.12" data-path="dynamics.html"><a href="dynamics.html#sketch-of-the-proof"><i class="fa fa-check"></i><b>7.6.12</b> Sketch of the Proof</a></li>
<li class="chapter" data-level="7.6.13" data-path="dynamics.html"><a href="dynamics.html#constructive-estimation"><i class="fa fa-check"></i><b>7.6.13</b> Constructive Estimation</a></li>
<li class="chapter" data-level="7.6.14" data-path="dynamics.html"><a href="dynamics.html#estimation-by-an-em-algorithm"><i class="fa fa-check"></i><b>7.6.14</b> Estimation by an EM Algorithm</a></li>
<li class="chapter" data-level="7.6.15" data-path="dynamics.html"><a href="dynamics.html#idea"><i class="fa fa-check"></i><b>7.6.15</b> Idea</a></li>
<li class="chapter" data-level="7.6.16" data-path="dynamics.html"><a href="dynamics.html#optimal-conditional-choice-probability-1"><i class="fa fa-check"></i><b>7.6.16</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.6.17" data-path="dynamics.html"><a href="dynamics.html#likelihood-functions"><i class="fa fa-check"></i><b>7.6.17</b> Likelihood Functions</a></li>
<li class="chapter" data-level="7.6.18" data-path="dynamics.html"><a href="dynamics.html#expectation-step"><i class="fa fa-check"></i><b>7.6.18</b> Expectation Step</a></li>
<li class="chapter" data-level="7.6.19" data-path="dynamics.html"><a href="dynamics.html#maximization-step"><i class="fa fa-check"></i><b>7.6.19</b> Maximization Step</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="dynamicgame.html"><a href="dynamicgame.html"><i class="fa fa-check"></i><b>8</b> Dynamic Game</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dynamicgame.html"><a href="dynamicgame.html#multiple-agent-model"><i class="fa fa-check"></i><b>8.1</b> Multiple-Agent Model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-2"><i class="fa fa-check"></i><b>8.1.1</b> Setting</a></li>
<li class="chapter" data-level="8.1.2" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-model-1"><i class="fa fa-check"></i><b>8.1.2</b> Timing of the Model</a></li>
<li class="chapter" data-level="8.1.3" data-path="dynamicgame.html"><a href="dynamicgame.html#period-profit"><i class="fa fa-check"></i><b>8.1.3</b> Period Profit</a></li>
<li class="chapter" data-level="8.1.4" data-path="dynamicgame.html"><a href="dynamicgame.html#belief-1"><i class="fa fa-check"></i><b>8.1.4</b> Belief</a></li>
<li class="chapter" data-level="8.1.5" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium"><i class="fa fa-check"></i><b>8.1.5</b> Markov Perfect Equilibrium</a></li>
<li class="chapter" data-level="8.1.6" data-path="dynamicgame.html"><a href="dynamicgame.html#ex-ante-value-function"><i class="fa fa-check"></i><b>8.1.6</b> Ex-ante Value Function</a></li>
<li class="chapter" data-level="8.1.7" data-path="dynamicgame.html"><a href="dynamicgame.html#choice-specific-value-function-1"><i class="fa fa-check"></i><b>8.1.7</b> Choice-specific Value Function</a></li>
<li class="chapter" data-level="8.1.8" data-path="dynamicgame.html"><a href="dynamicgame.html#optimality-condition-2"><i class="fa fa-check"></i><b>8.1.8</b> Optimality Condition</a></li>
<li class="chapter" data-level="8.1.9" data-path="dynamicgame.html"><a href="dynamicgame.html#optimal-conditional-choice-probability-2"><i class="fa fa-check"></i><b>8.1.9</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="8.1.10" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium-condition-1"><i class="fa fa-check"></i><b>8.1.10</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="8.1.11" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium-condition-2"><i class="fa fa-check"></i><b>8.1.11</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="8.1.12" data-path="dynamicgame.html"><a href="dynamicgame.html#single-path-of-play"><i class="fa fa-check"></i><b>8.1.12</b> Single Path of Play</a></li>
<li class="chapter" data-level="8.1.13" data-path="dynamicgame.html"><a href="dynamicgame.html#identification-1"><i class="fa fa-check"></i><b>8.1.13</b> Identification</a></li>
<li class="chapter" data-level="8.1.14" data-path="dynamicgame.html"><a href="dynamicgame.html#estimation-ccp-approach"><i class="fa fa-check"></i><b>8.1.14</b> Estimation: CCP Approach</a></li>
<li class="chapter" data-level="8.1.15" data-path="dynamicgame.html"><a href="dynamicgame.html#computing-psi"><i class="fa fa-check"></i><b>8.1.15</b> Computing <span class="math inline">\(\Psi\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="dynamicgame.html"><a href="dynamicgame.html#with-continuous-dynamic-choice"><i class="fa fa-check"></i><b>8.2</b> With Continuous Dynamic Choice</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="dynamicgame.html"><a href="dynamicgame.html#continuous-control"><i class="fa fa-check"></i><b>8.2.1</b> Continuous Control</a></li>
<li class="chapter" data-level="8.2.2" data-path="dynamicgame.html"><a href="dynamicgame.html#period-payoff-1"><i class="fa fa-check"></i><b>8.2.2</b> Period Payoff</a></li>
<li class="chapter" data-level="8.2.3" data-path="dynamicgame.html"><a href="dynamicgame.html#policy-function-estimation-with-continuous-control"><i class="fa fa-check"></i><b>8.2.3</b> Policy Function Estimation with Continuous Control</a></li>
<li class="chapter" data-level="8.2.4" data-path="dynamicgame.html"><a href="dynamicgame.html#converting-to-the-standard-discrete-choice-model"><i class="fa fa-check"></i><b>8.2.4</b> Converting to the Standard Discrete Choice Model</a></li>
<li class="chapter" data-level="8.2.5" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-based-ccp-approach"><i class="fa fa-check"></i><b>8.2.5</b> Value Function Based CCP Approach</a></li>
<li class="chapter" data-level="8.2.6" data-path="dynamicgame.html"><a href="dynamicgame.html#approximating-the-ex-ante-value-function"><i class="fa fa-check"></i><b>8.2.6</b> Approximating the Ex-ante Value Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="dynamicgame.html"><a href="dynamicgame.html#dynamic-oligopoly-model"><i class="fa fa-check"></i><b>8.3</b> Dynamic Oligopoly Model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="dynamicgame.html"><a href="dynamicgame.html#ryancostenvironmentregulation2012"><i class="fa fa-check"></i><b>8.3.1</b> <span class="citation">Ryan (2012)</span></a></li>
<li class="chapter" data-level="8.3.2" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-3"><i class="fa fa-check"></i><b>8.3.2</b> Setting</a></li>
<li class="chapter" data-level="8.3.3" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-game"><i class="fa fa-check"></i><b>8.3.3</b> Timing of the Game</a></li>
<li class="chapter" data-level="8.3.4" data-path="dynamicgame.html"><a href="dynamicgame.html#demand-function"><i class="fa fa-check"></i><b>8.3.4</b> Demand Function</a></li>
<li class="chapter" data-level="8.3.5" data-path="dynamicgame.html"><a href="dynamicgame.html#production-cost-function"><i class="fa fa-check"></i><b>8.3.5</b> Production Cost Function</a></li>
<li class="chapter" data-level="8.3.6" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-cost"><i class="fa fa-check"></i><b>8.3.6</b> Investment Cost</a></li>
<li class="chapter" data-level="8.3.7" data-path="dynamicgame.html"><a href="dynamicgame.html#entry-and-exit-costs"><i class="fa fa-check"></i><b>8.3.7</b> Entry and Exit Costs</a></li>
<li class="chapter" data-level="8.3.8" data-path="dynamicgame.html"><a href="dynamicgame.html#period-profit-function"><i class="fa fa-check"></i><b>8.3.8</b> Period Profit Function</a></li>
<li class="chapter" data-level="8.3.9" data-path="dynamicgame.html"><a href="dynamicgame.html#transition"><i class="fa fa-check"></i><b>8.3.9</b> Transition</a></li>
<li class="chapter" data-level="8.3.10" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium"><i class="fa fa-check"></i><b>8.3.10</b> Equilibrium</a></li>
<li class="chapter" data-level="8.3.11" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-for-incumbents"><i class="fa fa-check"></i><b>8.3.11</b> Value Function for Incumbents</a></li>
<li class="chapter" data-level="8.3.12" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-for-entrants"><i class="fa fa-check"></i><b>8.3.12</b> Value Function for Entrants</a></li>
<li class="chapter" data-level="8.3.13" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium-1"><i class="fa fa-check"></i><b>8.3.13</b> Markov Perfect Equilibrium</a></li>
<li class="chapter" data-level="8.3.14" data-path="dynamicgame.html"><a href="dynamicgame.html#demand-and-production-cost-estimation"><i class="fa fa-check"></i><b>8.3.14</b> Demand and Production Cost Estimation</a></li>
<li class="chapter" data-level="8.3.15" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-policy-function-estimation"><i class="fa fa-check"></i><b>8.3.15</b> Investment Policy Function Estimation</a></li>
<li class="chapter" data-level="8.3.16" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-policy-function-estimation-1"><i class="fa fa-check"></i><b>8.3.16</b> Investment Policy Function Estimation</a></li>
<li class="chapter" data-level="8.3.17" data-path="dynamicgame.html"><a href="dynamicgame.html#entry-and-exit-policy-functions"><i class="fa fa-check"></i><b>8.3.17</b> Entry and Exit Policy Functions</a></li>
<li class="chapter" data-level="8.3.18" data-path="dynamicgame.html"><a href="dynamicgame.html#bbl-estimation"><i class="fa fa-check"></i><b>8.3.18</b> BBL Estimation</a></li>
<li class="chapter" data-level="8.3.19" data-path="dynamicgame.html"><a href="dynamicgame.html#structural-parameters-estimation-results"><i class="fa fa-check"></i><b>8.3.19</b> Structural Parameters Estimation Results</a></li>
<li class="chapter" data-level="8.3.20" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation"><i class="fa fa-check"></i><b>8.3.20</b> Counterfactual Simulation</a></li>
<li class="chapter" data-level="8.3.21" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation-results"><i class="fa fa-check"></i><b>8.3.21</b> Counterfactual Simulation Results</a></li>
<li class="chapter" data-level="8.3.22" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation-estimation-results"><i class="fa fa-check"></i><b>8.3.22</b> Counterfactual Simulation Estimation Results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="dynamicgame.html"><a href="dynamicgame.html#dynamic-oligopoly-with-many-firms"><i class="fa fa-check"></i><b>8.4</b> Dynamic Oligopoly with Many Firms</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-4"><i class="fa fa-check"></i><b>8.4.1</b> Setting</a></li>
<li class="chapter" data-level="8.4.2" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-game-1"><i class="fa fa-check"></i><b>8.4.2</b> Timing of the Game</a></li>
<li class="chapter" data-level="8.4.3" data-path="dynamicgame.html"><a href="dynamicgame.html#assumptions"><i class="fa fa-check"></i><b>8.4.3</b> Assumptions</a></li>
<li class="chapter" data-level="8.4.4" data-path="dynamicgame.html"><a href="dynamicgame.html#strategy-profile"><i class="fa fa-check"></i><b>8.4.4</b> Strategy Profile</a></li>
<li class="chapter" data-level="8.4.5" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function"><i class="fa fa-check"></i><b>8.4.5</b> Value Function</a></li>
<li class="chapter" data-level="8.4.6" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium-2"><i class="fa fa-check"></i><b>8.4.6</b> Markov-perfect Equilibrium</a></li>
<li class="chapter" data-level="8.4.7" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-strategy"><i class="fa fa-check"></i><b>8.4.7</b> Oblivious Strategy</a></li>
<li class="chapter" data-level="8.4.8" data-path="dynamicgame.html"><a href="dynamicgame.html#long-run-average-industry-state"><i class="fa fa-check"></i><b>8.4.8</b> Long-run Average Industry State</a></li>
<li class="chapter" data-level="8.4.9" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-value-function"><i class="fa fa-check"></i><b>8.4.9</b> Oblivious Value Function</a></li>
<li class="chapter" data-level="8.4.10" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-equilibrium"><i class="fa fa-check"></i><b>8.4.10</b> Oblivious Equilibrium</a></li>
<li class="chapter" data-level="8.4.11" data-path="dynamicgame.html"><a href="dynamicgame.html#asymptotic-results-and-extensions"><i class="fa fa-check"></i><b>8.4.11</b> Asymptotic Results and Extensions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="auction.html"><a href="auction.html"><i class="fa fa-check"></i><b>9</b> Auction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="auction.html"><a href="auction.html#general-symmetric-information-model"><i class="fa fa-check"></i><b>9.1</b> General symmetric information model</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="auction.html"><a href="auction.html#setting-5"><i class="fa fa-check"></i><b>9.1.1</b> Setting</a></li>
<li class="chapter" data-level="9.1.2" data-path="auction.html"><a href="auction.html#discussion-about-the-asssumptions"><i class="fa fa-check"></i><b>9.1.2</b> Discussion About the Asssumptions</a></li>
<li class="chapter" data-level="9.1.3" data-path="auction.html"><a href="auction.html#bidding-strategy"><i class="fa fa-check"></i><b>9.1.3</b> Bidding Strategy</a></li>
<li class="chapter" data-level="9.1.4" data-path="auction.html"><a href="auction.html#special-cases"><i class="fa fa-check"></i><b>9.1.4</b> Special Cases</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="auction.html"><a href="auction.html#second-price-auctions"><i class="fa fa-check"></i><b>9.2</b> Second-Price Auctions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="auction.html"><a href="auction.html#the-button-auction"><i class="fa fa-check"></i><b>9.2.1</b> The Button Auction</a></li>
<li class="chapter" data-level="9.2.2" data-path="auction.html"><a href="auction.html#equilibrium-bidding-strategies"><i class="fa fa-check"></i><b>9.2.2</b> Equilibrium Bidding Strategies</a></li>
<li class="chapter" data-level="9.2.3" data-path="auction.html"><a href="auction.html#reserve-price"><i class="fa fa-check"></i><b>9.2.3</b> Reserve Price</a></li>
<li class="chapter" data-level="9.2.4" data-path="auction.html"><a href="auction.html#variations"><i class="fa fa-check"></i><b>9.2.4</b> Variations</a></li>
<li class="chapter" data-level="9.2.5" data-path="auction.html"><a href="auction.html#estimation-of-a-ipv-button-auction"><i class="fa fa-check"></i><b>9.2.5</b> Estimation of a IPV Button Auction</a></li>
<li class="chapter" data-level="9.2.6" data-path="auction.html"><a href="auction.html#likelihood-of-ipv-button-auction"><i class="fa fa-check"></i><b>9.2.6</b> Likelihood of IPV Button Auction</a></li>
<li class="chapter" data-level="9.2.7" data-path="auction.html"><a href="auction.html#optimal-reserve-price"><i class="fa fa-check"></i><b>9.2.7</b> Optimal Reserve Price</a></li>
<li class="chapter" data-level="9.2.8" data-path="auction.html"><a href="auction.html#likelihood-of-ipv-english-auction-with-bid-data"><i class="fa fa-check"></i><b>9.2.8</b> Likelihood of IPV English Auction with Bid Data</a></li>
<li class="chapter" data-level="9.2.9" data-path="auction.html"><a href="auction.html#observed-heterogeneity"><i class="fa fa-check"></i><b>9.2.9</b> Observed Heterogeneity</a></li>
<li class="chapter" data-level="9.2.10" data-path="auction.html"><a href="auction.html#identification-2"><i class="fa fa-check"></i><b>9.2.10</b> Identification</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="auction.html"><a href="auction.html#first-price-auctions"><i class="fa fa-check"></i><b>9.3</b> First-Price Auctions</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="auction.html"><a href="auction.html#first-price-sealed-bid-auction"><i class="fa fa-check"></i><b>9.3.1</b> First-Price Sealed Bid Auction</a></li>
<li class="chapter" data-level="9.3.2" data-path="auction.html"><a href="auction.html#equilibrium-bidding-strategies-1"><i class="fa fa-check"></i><b>9.3.2</b> Equilibrium Bidding Strategies</a></li>
<li class="chapter" data-level="9.3.3" data-path="auction.html"><a href="auction.html#maximum-likelihood-estimation-of-the-ipv-first-price-auction"><i class="fa fa-check"></i><b>9.3.3</b> Maximum Likelihood Estimation of the IPV First-Price Auction</a></li>
<li class="chapter" data-level="9.3.4" data-path="auction.html"><a href="auction.html#non-parametric-approach"><i class="fa fa-check"></i><b>9.3.4</b> Non-Parametric Approach</a></li>
<li class="chapter" data-level="9.3.5" data-path="auction.html"><a href="auction.html#non-parmaetric-approach-estimation"><i class="fa fa-check"></i><b>9.3.5</b> Non-Parmaetric Approach: Estimation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>10</b> Applications</a>
<ul>
<li class="chapter" data-level="10.1" data-path="applications.html"><a href="applications.html#section"><i class="fa fa-check"></i><b>10.1</b> 2018-2019</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="applications.html"><a href="applications.html#american-economic-review"><i class="fa fa-check"></i><b>10.1.1</b> American Economic Review</a></li>
<li class="chapter" data-level="10.1.2" data-path="applications.html"><a href="applications.html#econometrica"><i class="fa fa-check"></i><b>10.1.2</b> Econometrica</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="applications.html"><a href="applications.html#asymmetric-information-and-market-power"><i class="fa fa-check"></i><b>10.2</b> Asymmetric Information and Market Power</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="applications.html"><a href="applications.html#motivation"><i class="fa fa-check"></i><b>10.2.1</b> Motivation</a></li>
<li class="chapter" data-level="10.2.2" data-path="applications.html"><a href="applications.html#question-method-and-materials"><i class="fa fa-check"></i><b>10.2.2</b> Question, Method, and Materials</a></li>
<li class="chapter" data-level="10.2.3" data-path="applications.html"><a href="applications.html#findings"><i class="fa fa-check"></i><b>10.2.3</b> Findings</a></li>
<li class="chapter" data-level="10.2.4" data-path="applications.html"><a href="applications.html#policy-experiments"><i class="fa fa-check"></i><b>10.2.4</b> Policy Experiments</a></li>
<li class="chapter" data-level="10.2.5" data-path="applications.html"><a href="applications.html#source"><i class="fa fa-check"></i><b>10.2.5</b> Source</a></li>
<li class="chapter" data-level="10.2.6" data-path="applications.html"><a href="applications.html#loan-data"><i class="fa fa-check"></i><b>10.2.6</b> Loan Data</a></li>
<li class="chapter" data-level="10.2.7" data-path="applications.html"><a href="applications.html#firm-data"><i class="fa fa-check"></i><b>10.2.7</b> Firm Data</a></li>
<li class="chapter" data-level="10.2.8" data-path="applications.html"><a href="applications.html#default-data"><i class="fa fa-check"></i><b>10.2.8</b> Default Data</a></li>
<li class="chapter" data-level="10.2.9" data-path="applications.html"><a href="applications.html#positive-correlation-tests"><i class="fa fa-check"></i><b>10.2.9</b> Positive Correlation Tests</a></li>
<li class="chapter" data-level="10.2.10" data-path="applications.html"><a href="applications.html#setting-6"><i class="fa fa-check"></i><b>10.2.10</b> Setting</a></li>
<li class="chapter" data-level="10.2.11" data-path="applications.html"><a href="applications.html#firm-preference-over-banks"><i class="fa fa-check"></i><b>10.2.11</b> Firm Preference over Banks</a></li>
<li class="chapter" data-level="10.2.12" data-path="applications.html"><a href="applications.html#required-loand-amount"><i class="fa fa-check"></i><b>10.2.12</b> Required Loand Amount</a></li>
<li class="chapter" data-level="10.2.13" data-path="applications.html"><a href="applications.html#default-decision"><i class="fa fa-check"></i><b>10.2.13</b> Default Decision</a></li>
<li class="chapter" data-level="10.2.14" data-path="applications.html"><a href="applications.html#information-structure"><i class="fa fa-check"></i><b>10.2.14</b> Information Structure</a></li>
<li class="chapter" data-level="10.2.15" data-path="applications.html"><a href="applications.html#moral-hazard"><i class="fa fa-check"></i><b>10.2.15</b> Moral Hazard</a></li>
<li class="chapter" data-level="10.2.16" data-path="applications.html"><a href="applications.html#bank-problem"><i class="fa fa-check"></i><b>10.2.16</b> Bank Problem</a></li>
<li class="chapter" data-level="10.2.17" data-path="applications.html"><a href="applications.html#the-effect-of-price-on-default-probability"><i class="fa fa-check"></i><b>10.2.17</b> The Effect of Price on Default Probability</a></li>
<li class="chapter" data-level="10.2.18" data-path="applications.html"><a href="applications.html#the-first-order-condition"><i class="fa fa-check"></i><b>10.2.18</b> The First-Order Condition</a></li>
<li class="chapter" data-level="10.2.19" data-path="applications.html"><a href="applications.html#the-effect-of-higher-adverse-selection"><i class="fa fa-check"></i><b>10.2.19</b> The Effect of Higher Adverse Selection</a></li>
<li class="chapter" data-level="10.2.20" data-path="applications.html"><a href="applications.html#estimating-equilibrium-pricing-strategy-and-augmenting-missing-price-data"><i class="fa fa-check"></i><b>10.2.20</b> Estimating Equilibrium Pricing Strategy and Augmenting Missing Price Data</a></li>
<li class="chapter" data-level="10.2.21" data-path="applications.html"><a href="applications.html#inserting-pricing-estimates-into-the-utility"><i class="fa fa-check"></i><b>10.2.21</b> Inserting Pricing Estimates into the Utility</a></li>
<li class="chapter" data-level="10.2.22" data-path="applications.html"><a href="applications.html#choice-probability"><i class="fa fa-check"></i><b>10.2.22</b> Choice Probability</a></li>
<li class="chapter" data-level="10.2.23" data-path="applications.html"><a href="applications.html#equilibrium-loan-strategy"><i class="fa fa-check"></i><b>10.2.23</b> Equilibrium Loan Strategy</a></li>
<li class="chapter" data-level="10.2.24" data-path="applications.html"><a href="applications.html#equilibrium-default-strategy"><i class="fa fa-check"></i><b>10.2.24</b> Equilibrium Default Strategy</a></li>
<li class="chapter" data-level="10.2.25" data-path="applications.html"><a href="applications.html#control-function-approach-to-deal-with-endogeneity-in-loand-and-defaulty-equations"><i class="fa fa-check"></i><b>10.2.25</b> Control Function Approach to Deal with Endogeneity in Loand and Defaulty Equations</a></li>
<li class="chapter" data-level="10.2.26" data-path="applications.html"><a href="applications.html#first-stage-estimation"><i class="fa fa-check"></i><b>10.2.26</b> First-Stage Estimation</a></li>
<li class="chapter" data-level="10.2.27" data-path="applications.html"><a href="applications.html#second-stage-estimation"><i class="fa fa-check"></i><b>10.2.27</b> Second-Stage Estimation</a></li>
<li class="chapter" data-level="10.2.28" data-path="applications.html"><a href="applications.html#estimation-results"><i class="fa fa-check"></i><b>10.2.28</b> Estimation Results</a></li>
<li class="chapter" data-level="10.2.29" data-path="applications.html"><a href="applications.html#findings-from-estimation-results"><i class="fa fa-check"></i><b>10.2.29</b> Findings from Estimation Results</a></li>
<li class="chapter" data-level="10.2.30" data-path="applications.html"><a href="applications.html#fit-of-the-model"><i class="fa fa-check"></i><b>10.2.30</b> Fit of the Model</a></li>
<li class="chapter" data-level="10.2.31" data-path="applications.html"><a href="applications.html#counterfactuals"><i class="fa fa-check"></i><b>10.2.31</b> Counterfactuals</a></li>
<li class="chapter" data-level="10.2.32" data-path="applications.html"><a href="applications.html#what-if-adverse-selection-got-severer"><i class="fa fa-check"></i><b>10.2.32</b> What if Adverse Selection Got Severer?</a></li>
<li class="chapter" data-level="10.2.33" data-path="applications.html"><a href="applications.html#what-if-cost-of-capital-increased"><i class="fa fa-check"></i><b>10.2.33</b> What if Cost of Capital Increased?</a></li>
<li class="chapter" data-level="10.2.34" data-path="applications.html"><a href="applications.html#merger-simulation-2"><i class="fa fa-check"></i><b>10.2.34</b> Merger Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="assignment1.html"><a href="assignment1.html"><i class="fa fa-check"></i><b>11</b> Assignment 1: Basic Programming in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="assignment1.html"><a href="assignment1.html#simulate-data"><i class="fa fa-check"></i><b>11.1</b> Simulate data</a></li>
<li class="chapter" data-level="11.2" data-path="assignment1.html"><a href="assignment1.html#estimate-the-parameter"><i class="fa fa-check"></i><b>11.2</b> Estimate the parameter</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="assignment2.html"><a href="assignment2.html"><i class="fa fa-check"></i><b>12</b> Assignment 2: Production Function Estimation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="assignment2.html"><a href="assignment2.html#simulate-data-1"><i class="fa fa-check"></i><b>12.1</b> Simulate data</a></li>
<li class="chapter" data-level="12.2" data-path="assignment2.html"><a href="assignment2.html#estimate-the-parameters"><i class="fa fa-check"></i><b>12.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="assignment3.html"><a href="assignment3.html"><i class="fa fa-check"></i><b>13</b> Assignment 3: Demand Function Estimation I</a>
<ul>
<li class="chapter" data-level="13.1" data-path="assignment3.html"><a href="assignment3.html#simulate-data-2"><i class="fa fa-check"></i><b>13.1</b> Simulate data</a></li>
<li class="chapter" data-level="13.2" data-path="assignment3.html"><a href="assignment3.html#estimate-the-parameters-1"><i class="fa fa-check"></i><b>13.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="assignment4.html"><a href="assignment4.html"><i class="fa fa-check"></i><b>14</b> Assignment 4: Demand Function Estimation II</a>
<ul>
<li class="chapter" data-level="14.1" data-path="assignment4.html"><a href="assignment4.html#simulate-data-3"><i class="fa fa-check"></i><b>14.1</b> Simulate data</a></li>
<li class="chapter" data-level="14.2" data-path="assignment4.html"><a href="assignment4.html#estimate-the-parameters-2"><i class="fa fa-check"></i><b>14.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="assignment5.html"><a href="assignment5.html"><i class="fa fa-check"></i><b>15</b> Assignment 5: Merger Simulation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="assignment5.html"><a href="assignment5.html#simulate-data-4"><i class="fa fa-check"></i><b>15.1</b> Simulate data</a></li>
<li class="chapter" data-level="15.2" data-path="assignment5.html"><a href="assignment5.html#estimate-the-parameters-3"><i class="fa fa-check"></i><b>15.2</b> Estimate the parameters</a></li>
<li class="chapter" data-level="15.3" data-path="assignment5.html"><a href="assignment5.html#conduct-counterfactual-simulation"><i class="fa fa-check"></i><b>15.3</b> Conduct counterfactual simulation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="assignment6.html"><a href="assignment6.html"><i class="fa fa-check"></i><b>16</b> Assignment 6: Entry and Exit Analysis</a>
<ul>
<li class="chapter" data-level="16.1" data-path="assignment6.html"><a href="assignment6.html#simulate-data-5"><i class="fa fa-check"></i><b>16.1</b> Simulate data</a></li>
<li class="chapter" data-level="16.2" data-path="assignment6.html"><a href="assignment6.html#estimate-the-parameters-4"><i class="fa fa-check"></i><b>16.2</b> Estimate the parameters</a></li>
<li class="chapter" data-level="16.3" data-path="assignment6.html"><a href="assignment6.html#conduct-counterfactual-simulations"><i class="fa fa-check"></i><b>16.3</b> Conduct counterfactual simulations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="assignment7.html"><a href="assignment7.html"><i class="fa fa-check"></i><b>17</b> Assignment 7: Dynamic Decision</a>
<ul>
<li class="chapter" data-level="17.1" data-path="assignment7.html"><a href="assignment7.html#simulate-data-6"><i class="fa fa-check"></i><b>17.1</b> Simulate data</a></li>
<li class="chapter" data-level="17.2" data-path="assignment7.html"><a href="assignment7.html#estimate-parameters"><i class="fa fa-check"></i><b>17.2</b> Estimate parameters</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="assignment8.html"><a href="assignment8.html"><i class="fa fa-check"></i><b>18</b> Assignment 8: Dynamic Game</a>
<ul>
<li class="chapter" data-level="18.1" data-path="assignment8.html"><a href="assignment8.html#simulate-data-7"><i class="fa fa-check"></i><b>18.1</b> Simulate data</a></li>
<li class="chapter" data-level="18.2" data-path="assignment8.html"><a href="assignment8.html#estimate-parameters-1"><i class="fa fa-check"></i><b>18.2</b> Estimate parameters</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="assignment9.html"><a href="assignment9.html"><i class="fa fa-check"></i><b>19</b> Assignment 9: Auction</a>
<ul>
<li class="chapter" data-level="19.1" data-path="assignment9.html"><a href="assignment9.html#simulate-data-8"><i class="fa fa-check"></i><b>19.1</b> Simulate data</a></li>
<li class="chapter" data-level="19.2" data-path="assignment9.html"><a href="assignment9.html#estimate-the-parameters-5"><i class="fa fa-check"></i><b>19.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>20</b> Integrating with C++ using Rcpp and RcppEigen</a>
<ul>
<li class="chapter" data-level="20.1" data-path="rcpp.html"><a href="rcpp.html#prerequisite"><i class="fa fa-check"></i><b>20.1</b> Prerequisite</a></li>
<li class="chapter" data-level="20.2" data-path="rcpp.html"><a href="rcpp.html#workflow"><i class="fa fa-check"></i><b>20.2</b> Workflow</a></li>
<li class="chapter" data-level="20.3" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-as-rcpp-objects"><i class="fa fa-check"></i><b>20.3</b> Passing R Objects as Rcpp Objects</a></li>
<li class="chapter" data-level="20.4" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-as-eigen-objects"><i class="fa fa-check"></i><b>20.4</b> Passing R Objects as Eigen Objects</a></li>
<li class="chapter" data-level="20.5" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-in-other-objects-in-cc"><i class="fa fa-check"></i><b>20.5</b> Passing R Objects in Other Objects in C/C++</a></li>
<li class="chapter" data-level="20.6" data-path="rcpp.html"><a href="rcpp.html#manipulating-objects-in-a-c-function"><i class="fa fa-check"></i><b>20.6</b> Manipulating Objects in a C++ Function</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="rcpp.html"><a href="rcpp.html#matrix-and-vector-arithmetic"><i class="fa fa-check"></i><b>20.6.1</b> Matrix and Vector Arithmetic</a></li>
<li class="chapter" data-level="20.6.2" data-path="rcpp.html"><a href="rcpp.html#the-array-class-and-coefficient-wise-operations"><i class="fa fa-check"></i><b>20.6.2</b> The Array Class and Coefficient-wise Operations</a></li>
<li class="chapter" data-level="20.6.3" data-path="rcpp.html"><a href="rcpp.html#solving-linear-least-squares-systems"><i class="fa fa-check"></i><b>20.6.3</b> Solving Linear Least Squares Systems</a></li>
<li class="chapter" data-level="20.6.4" data-path="rcpp.html"><a href="rcpp.html#accessing-to-elements-of-a-matrix-and-vector"><i class="fa fa-check"></i><b>20.6.4</b> Accessing to Elements of a Matrix and Vector</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>21</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECON5630 Topics in Empirical Industrial Organization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rcpp" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> Integrating with C++ using Rcpp and RcppEigen<a href="rcpp.html#rcpp" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="prerequisite" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Prerequisite<a href="rcpp.html#prerequisite" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>In this chapter, we learn how to integrate C++ using Rcpp and RcppEigen.</li>
<li><code>RcppEigen</code> is a package to use a linear algebra library <code>Eigen</code> with R. The original <code>Eigen</code> library and its documentation is found in <a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">their website</a>.</li>
<li>Instead of <code>RcppEigen</code>, you may want to use <code>RcppArmadillo</code>. <code>Armadillo</code> is another libear algebra library in C++.</li>
<li>We presume that:
<ul>
<li>C/C++ environment is installed to the computer.
<ul>
<li>For OSX, you can install <a href="https://developer.apple.com/xcode/">Apple Developer Tools</a>.</li>
<li>For Windows, you can try <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a>.</li>
</ul></li>
<li><code>Rcpp</code> and <code>RcppEigen</code> are installed.</li>
<li>The project is created in RStudio from <code>File &gt; New Project &gt; New Directory &gt; R Package using RcppEigen</code>. In the following, I use the project name <code>EmpiricalIO</code> but the name can be as you like.</li>
</ul></li>
<li>We presume the you have the following folder and file structure from the root directory:
<ul>
<li><code>main</code>.
<ul>
<li><code>main.R</code>: all executable statements are written in this file.</li>
</ul></li>
<li><code>R</code>.
<ul>
<li><code>functions.R</code>: all function definitions in R are written in this file.</li>
</ul></li>
<li><code>src</code>.
<ul>
<li><code>functions.cpp</code>: all function definitions in C++ are written in this file.
<ul>
<li>It includes:</li>
</ul>
<pre><code>&quot;src/functions.cpp&quot;
-------------------
#include &lt;Rcpp.h&gt;
#include &lt;RcppEigen.h&gt;</code></pre>
<ul>
<li>Inside <code>functions.cpp</code>, avoid using name spaces.</li>
</ul></li>
<li><code>Makevars</code>: compilation flags for osx/Linux should be written here.</li>
<li><code>Makevars.win</code>: compilation flags for Windows should be written here.</li>
</ul></li>
<li><code>inst</code>.
<ul>
<li><code>include</code>: header files for external libraries in C/C++ are stored here.</li>
</ul></li>
</ul></li>
<li><code>Makevars/Makevars.win</code> should be:</li>
</ul>
<pre><code>Makevars
--------
PKG_CPPFLAGS = -w -std=c++11 -I../inst/include/ -O3</code></pre>
<pre><code>Makevars.win
------------
PKG_CPPFLAGS = -w -std=c++11 -I../inst/include/ -O3</code></pre>
<pre><code>- `-w` is for supprssing some warnings in `Eigen`. If you want to keep warnings shown, this can be removed.
- `-std=c++11` is for using the latest functionalities of C++ (optional).
- `-I../inst/include/` is for setting the header path to `../inst/include/` (optional).</code></pre>
</div>
<div id="workflow" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Workflow<a href="rcpp.html#workflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>To minimize the likelihood of bugs and the time to edit and debug the code, I recommend you to follw the following workflow.</li>
<li>This workflow is based on my experience. If you find better workflow, you can overwrite by your own way.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Write a procedure in <code>main/main.R</code>.</li>
</ol>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="rcpp.html#cb544-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb544-2"><a href="rcpp.html#cb544-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb544-3"><a href="rcpp.html#cb544-3" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Rewrite the procedure to a function in <code>main/main.R</code>.</li>
</ol>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="rcpp.html#cb545-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb545-2"><a href="rcpp.html#cb545-2" tabindex="-1"></a><span class="co"># compute coefficient-wise square</span></span>
<span id="cb545-3"><a href="rcpp.html#cb545-3" tabindex="-1"></a>compute_square <span class="ot">&lt;-</span></span>
<span id="cb545-4"><a href="rcpp.html#cb545-4" tabindex="-1"></a>  <span class="cf">function</span>(x) {</span>
<span id="cb545-5"><a href="rcpp.html#cb545-5" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb545-6"><a href="rcpp.html#cb545-6" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb545-7"><a href="rcpp.html#cb545-7" tabindex="-1"></a>  }</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Execute the function in <code>main/main.R</code> and check that the output is the same with the output of the original</li>
</ol>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="rcpp.html#cb546-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb546-2"><a href="rcpp.html#cb546-2" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">compute_square</span>(x)</span>
<span id="cb546-3"><a href="rcpp.html#cb546-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(y1 <span class="sc">-</span> y2))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Cut and paste the function to <code>R/functions.R</code>.</li>
<li>Build the package and load the function from the library.</li>
<li>Check if the function can be executed as in step 3.</li>
<li>Copy the function to <code>src/functions.cpp</code> and comment them out.</li>
</ol>
<pre><code>// src/functions.cpp
// # compute coefficient-wise square
// compute_square &lt;-
//   function(x) {
//     y &lt;- x^2
//     return(y)
//   }</code></pre>
<ol start="8" style="list-style-type: decimal">
<li>Write function in C++ by translating the copied and pasted R code.
<ul>
<li>The function name should be consistent with the function name in R. I often put <code>_rcpp</code> to the end of the name.</li>
<li>Put <code>// [[Rcpp::export]]</code> above the name of the function if you want to call this function directly from R. Otherwise, the wrapper function to call from R is not created.</li>
<li>The class of the inputs and output should be consistent with <code>Rcpp</code> objects. This will be explained later.</li>
</ul></li>
</ol>
<pre><code>// src/functions.cpp
// # compute coefficient-wise square
// compute_square &lt;-
// [[Rcpp::export]]
Eigen::VectorXd compute_square_rcpp(Eigen::VectorXd x) {
  //   function(x) {
  Eigen::VectorXd y = x.array().square();
  //     y &lt;- x^2
  //     return(y)
  //   }
  return(y);
}</code></pre>
<ol start="9" style="list-style-type: decimal">
<li>Check if clean and rebuild work.
<ul>
<li>If there is a compilation error happens, debug until the compilation succeeds.</li>
<li>Sometimes, deleting <code>R/RcppExports.R</code> and <code>R/RcppExports.cpp</code> may be need when re-compile the functions.</li>
</ul></li>
<li>Clean up the code by eliminating the copied and pasted R code.</li>
</ol>
<pre><code>// src/functions.cpp
// compute coefficient-wise square
// [[Rcpp::export]]
Eigen::VectorXd compute_square_rcpp(Eigen::VectorXd x) {
  Eigen::VectorXd y = x.array().square();
  return(y);
}</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Now by calling the library, you should be able to use the function written in C++ in R. Check if it returns a valid value and if the output is the same as the output of the R function.</li>
</ol>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="rcpp.html#cb551-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb551-2"><a href="rcpp.html#cb551-2" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">compute_square_rcpp</span>(x)</span>
<span id="cb551-3"><a href="rcpp.html#cb551-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(y2 <span class="sc">-</span> y3))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ol start="12" style="list-style-type: decimal">
<li>If there is a run-time bug in the C++ function, you may have to use some debugger for C++ to debug the function.
<ul>
<li>In osx, you can debug the C++ function called from R function in the following way.</li>
<li>Open the terminal and run R with the debugger <code>lldb</code> by typing the following command in the terminal:</li>
</ul>
<pre><code># terminal
R -d lldb</code></pre>
<ul>
<li>Run <code>main/main.R</code> by typing the following command in the terminal:</li>
</ul>
<pre><code># terminal
run -f main/main.R</code></pre>
<ul>
<li>This should execute the R source code.</li>
<li>After <code>library(EmpiricalIO)</code> is read, stop the process by <code>Ctrl + C</code> before the function in question is called. If there is no time gap between them, set <code>Sys.sleep()</code> in R to buy some time.</li>
<li>As you stop the process, set the break point at the function in question by typing in the terminal as:</li>
</ul>
<pre><code># terminal
br s -n compute_square_rcpp</code></pre>
and then continue the process by typing <code>c</code> in the terminal.
<ul>
<li>For the rest, refer to the <a href="https://lldb.llvm.org/">documentation of lldb</a>.</li>
<li>There is no such an easy way in Windows. You will have to establish an environment in which you can run a cpp file with executable statemtns and call the debugging functions from the file. Then, you can use some debuggers such as <code>gdb</code> to debug the functions inside the cpp file.</li>
</ul></li>
<li>If you need to modify the function, first rewrite the R function and then follow the same step to rewrite the C++ function. Never start the debugging from C++ functions.</li>
</ol>
</div>
<div id="passing-r-objects-as-rcpp-objects" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Passing R Objects as Rcpp Objects<a href="rcpp.html#passing-r-objects-as-rcpp-objects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>R class corresponds to the following Rcpp class:</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">R</th>
<th align="left">Rcpp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>logical</code></td>
<td align="left"><code>Logical</code></td>
</tr>
<tr class="even">
<td align="left"><code>integer</code></td>
<td align="left"><code>Integer</code></td>
</tr>
<tr class="odd">
<td align="left"><code>numeric</code></td>
<td align="left"><code>Numeric</code></td>
</tr>
<tr class="even">
<td align="left"><code>complex</code></td>
<td align="left"><code>Complex</code></td>
</tr>
<tr class="odd">
<td align="left"><code>character</code></td>
<td align="left"><code>String</code></td>
</tr>
<tr class="even">
<td align="left"><code>Date</code></td>
<td align="left"><code>Date</code></td>
</tr>
<tr class="odd">
<td align="left"><code>POSIXct</code></td>
<td align="left"><code>Datetime</code></td>
</tr>
</tbody>
</table>
<ul>
<li>R data structure corresponds to the following Rcpp data structure:</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">R</th>
<th align="left">Rcpp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>vector</code></td>
<td align="left"><code>Vector</code></td>
</tr>
<tr class="even">
<td align="left"><code>matrix</code></td>
<td align="left"><code>Matrix</code></td>
</tr>
<tr class="odd">
<td align="left"><code>data.frame</code></td>
<td align="left"><code>DataFrame</code></td>
</tr>
<tr class="even">
<td align="left"><code>list</code></td>
<td align="left"><code>List</code></td>
</tr>
</tbody>
</table>
<ul>
<li>For example, a numeric vector in R is passed to <code>Rcpp::NumericVector</code> in Rcpp, an integer matrix is to <code>Rcpp::IntegerMatrix</code>, and so on.</li>
</ul>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="rcpp.html#cb556-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb556-2"><a href="rcpp.html#cb556-2" tabindex="-1"></a><span class="co"># numeric vector </span></span>
<span id="cb556-3"><a href="rcpp.html#cb556-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb556-4"><a href="rcpp.html#cb556-4" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1]  2.18543791 -0.01282801 -0.30530893 -0.58421346  0.77126850</code></pre>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="rcpp.html#cb558-1" tabindex="-1"></a><span class="co"># numeric matrix</span></span>
<span id="cb558-2"><a href="rcpp.html#cb558-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb558-3"><a href="rcpp.html#cb558-3" tabindex="-1"></a>Y</span></code></pre></div>
<pre><code>##          [,1]       [,2]       [,3]       [,4]      [,5]
## [1,] 2.106189 -0.2612649 -0.7788302 -0.4213451  1.218305
## [2,] 0.412157  2.0737836  1.1315325 -1.0217474 -1.799761</code></pre>
<ul>
<li>Let’s write a C++ function that just receives a numeric vector and returns the numeric vector, and receives a numeric matrix and returns the numeric matrix.</li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Rcpp::NumericVector pass_numeric_vector_to_rcpp(Rcpp::NumericVector x) {
  return(x);
}
// [[Rcpp::export]]
Rcpp::NumericMatrix pass_numeric_matrix_to_rcpp(Rcpp::NumericMatrix Y) {
  return(Y);
}</code></pre>
<ul>
<li>Check if you can pass R objects and get the right result:</li>
</ul>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="rcpp.html#cb561-1" tabindex="-1"></a><span class="co"># main/main.r</span></span>
<span id="cb561-2"><a href="rcpp.html#cb561-2" tabindex="-1"></a>x_rcpp <span class="ot">&lt;-</span> <span class="fu">pass_numeric_vector_to_rcpp</span>(x)</span>
<span id="cb561-3"><a href="rcpp.html#cb561-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(x <span class="sc">-</span> x_rcpp))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="rcpp.html#cb563-1" tabindex="-1"></a>Y_rcpp <span class="ot">&lt;-</span> <span class="fu">pass_numeric_matrix_to_rcpp</span>(Y)</span>
<span id="cb563-2"><a href="rcpp.html#cb563-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(Y <span class="sc">-</span> Y_rcpp))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li><strong>Exercise</strong>: Write functions <code>pass_integer_vector_to_rcpp</code>, <code>pass_integer_matrix_to_rcpp</code>, <code>pass_list_to_rcpp</code>, <code>pass_data_frame_to_rcpp</code> that receive an integer vector, list, and data frame and just return themselves.</li>
</ul>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="rcpp.html#cb565-1" tabindex="-1"></a><span class="co"># main/main.r</span></span>
<span id="cb565-2"><a href="rcpp.html#cb565-2" tabindex="-1"></a><span class="co"># integer vector</span></span>
<span id="cb565-3"><a href="rcpp.html#cb565-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb565-4"><a href="rcpp.html#cb565-4" tabindex="-1"></a>z</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="rcpp.html#cb567-1" tabindex="-1"></a><span class="co"># integer matrix</span></span>
<span id="cb567-2"><a href="rcpp.html#cb567-2" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb567-3"><a href="rcpp.html#cb567-3" tabindex="-1"></a>W</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="rcpp.html#cb569-1" tabindex="-1"></a><span class="co"># list</span></span>
<span id="cb569-2"><a href="rcpp.html#cb569-2" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">Y =</span> Y, <span class="at">z =</span> z)</span>
<span id="cb569-3"><a href="rcpp.html#cb569-3" tabindex="-1"></a>L</span></code></pre></div>
<pre><code>## $x
## [1]  2.18543791 -0.01282801 -0.30530893 -0.58421346  0.77126850
## 
## $Y
##          [,1]       [,2]       [,3]       [,4]      [,5]
## [1,] 2.106189 -0.2612649 -0.7788302 -0.4213451  1.218305
## [2,] 0.412157  2.0737836  1.1315325 -1.0217474 -1.799761
## 
## $z
## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="rcpp.html#cb571-1" tabindex="-1"></a><span class="co"># data frame</span></span>
<span id="cb571-2"><a href="rcpp.html#cb571-2" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>), <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>))</span>
<span id="cb571-3"><a href="rcpp.html#cb571-3" tabindex="-1"></a>D</span></code></pre></div>
<pre><code>##            x1         x2
## 1 -0.30824994 -1.5570357
## 2  0.01551524  1.9231637
## 3 -0.44231772 -1.8568296
## 4 -1.63800773 -2.1061184
## 5 -0.64140116  0.6976485</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="rcpp.html#cb573-1" tabindex="-1"></a>z_rcpp <span class="ot">&lt;-</span> <span class="fu">pass_integer_vector_to_rcpp</span>(z)</span>
<span id="cb573-2"><a href="rcpp.html#cb573-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(z <span class="sc">-</span> z_rcpp))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="rcpp.html#cb575-1" tabindex="-1"></a>W_rcpp <span class="ot">&lt;-</span> <span class="fu">pass_integer_matrix_to_rcpp</span>(W)</span>
<span id="cb575-2"><a href="rcpp.html#cb575-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(W <span class="sc">-</span> W_rcpp))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="rcpp.html#cb577-1" tabindex="-1"></a>L_rcpp <span class="ot">&lt;-</span> <span class="fu">pass_list_to_rcpp</span>(L)</span>
<span id="cb577-2"><a href="rcpp.html#cb577-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">unlist</span>(L) <span class="sc">-</span> <span class="fu">unlist</span>(L_rcpp)))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="rcpp.html#cb579-1" tabindex="-1"></a>D_rcpp <span class="ot">&lt;-</span> <span class="fu">pass_data_frame_to_rcpp</span>(D)</span>
<span id="cb579-2"><a href="rcpp.html#cb579-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(D <span class="sc">-</span> D_rcpp))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="passing-r-objects-as-eigen-objects" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Passing R Objects as Eigen Objects<a href="rcpp.html#passing-r-objects-as-eigen-objects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>R data structure corresponds to the following Eigen data structure:</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">R</th>
<th align="left">Eigen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>vector</code></td>
<td align="left"><code>Eigen::VectorX</code></td>
</tr>
<tr class="even">
<td align="left"><code>matrix</code></td>
<td align="left"><code>Eigen::MatrixX</code></td>
</tr>
</tbody>
</table>
<ul>
<li>If you pass an <code>integer</code> vector and matrix, the corresponding Eigen objects are <code>Eigen::VectorXi</code> and <code>Eigen::MatrixXi</code>.</li>
<li>If you pass an <code>numeric</code> vector and matrix, the corresponding Eigen objects are <code>Eigen::VectorXd</code> and <code>Eigen::MatrixXd</code>.</li>
<li>The class of the output can be Eigen class. If you return <code>Eigen::VectorXd</code>, <code>Eigen::MatrixXd</code>, then they are automatically converted to the corresponding R objects.</li>
<li>Check if you can pass <code>x</code>, <code>Y</code>, and <code>z</code> as follows:</li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Eigen::VectorXd pass_numeric_vector_to_eigen(Eigen::VectorXd x) {
  return(x);
}
// [[Rcpp::export]]
Eigen::MatrixXd pass_numeric_matrix_to_eigen(Eigen::MatrixXd Y) {
  return(Y);
}</code></pre>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="rcpp.html#cb582-1" tabindex="-1"></a><span class="co"># main/main.r</span></span>
<span id="cb582-2"><a href="rcpp.html#cb582-2" tabindex="-1"></a>x_eigen <span class="ot">&lt;-</span> <span class="fu">pass_numeric_vector_to_eigen</span>(x)</span>
<span id="cb582-3"><a href="rcpp.html#cb582-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(x <span class="sc">-</span> x_eigen))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="rcpp.html#cb584-1" tabindex="-1"></a>Y_eigen <span class="ot">&lt;-</span> <span class="fu">pass_numeric_matrix_to_eigen</span>(Y)</span>
<span id="cb584-2"><a href="rcpp.html#cb584-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(Y <span class="sc">-</span> Y_eigen))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li><strong>Exercise</strong>: Write functions <code>pass_integer_vector_to_rcpp</code> and <code>pass_integer_matrix_to_rcpp</code> that receive an integer vector and integer matrix and just return themselves.</li>
</ul>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="rcpp.html#cb586-1" tabindex="-1"></a><span class="co"># main/main.r</span></span>
<span id="cb586-2"><a href="rcpp.html#cb586-2" tabindex="-1"></a>z_eigen <span class="ot">&lt;-</span> <span class="fu">pass_integer_vector_to_eigen</span>(z)</span>
<span id="cb586-3"><a href="rcpp.html#cb586-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(z <span class="sc">-</span> z_eigen))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="rcpp.html#cb588-1" tabindex="-1"></a>W_eigen <span class="ot">&lt;-</span> <span class="fu">pass_integer_matrix_to_eigen</span>(W)</span>
<span id="cb588-2"><a href="rcpp.html#cb588-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(W <span class="sc">-</span> W_eigen))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li>If you pass a vector and matrix by <code>Eigen::VectorX</code> and <code>Eigen::MatrixX</code>, the objects are <strong>copied</strong> to the new objects. This means that the new memory is allocated. If you are going to modify the passed object inside the C++ function, the objects have to be copied. Otherwise, you can just map the objects in the following way so that the new memory is not allocated, whereas you cannot modify the objects in the C++ function.</li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Eigen::VectorXd map_numeric_vector_to_eigen(Eigen::Map&lt;Eigen::VectorXd&gt; x) {
  return(x);
}
// [[Rcpp::export]]
Eigen::MatrixXd map_numeric_matrix_to_eigen(Eigen::Map&lt;Eigen::MatrixXd&gt; Y) {
  return(Y);
}</code></pre>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="rcpp.html#cb591-1" tabindex="-1"></a><span class="co"># main/main.r</span></span>
<span id="cb591-2"><a href="rcpp.html#cb591-2" tabindex="-1"></a>x_eigen_map <span class="ot">&lt;-</span> <span class="fu">map_numeric_vector_to_eigen</span>(x)</span>
<span id="cb591-3"><a href="rcpp.html#cb591-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(x <span class="sc">-</span> x_eigen_map))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="rcpp.html#cb593-1" tabindex="-1"></a>Y_eigen_map <span class="ot">&lt;-</span> <span class="fu">map_numeric_matrix_to_eigen</span>(Y)</span>
<span id="cb593-2"><a href="rcpp.html#cb593-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(Y <span class="sc">-</span> Y_eigen_map))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li><p>I recommend to directly pass R vectors and matrices to <code>Eigen::VectorX</code> and <code>Eigen::MatrixX</code> rather than to <code>Vector</code> and <code>Matrix</code> in Rcpp, because <code>Eigen::VectorX</code> and <code>Eigen::MatrixX</code> have richer methods for linear algebra.</p></li>
<li><p>R list cannot be directly translated to Eigen objects, but the list of vectors and matrices, and the list of list of R objects can be passed to Eigen in the following way.</p></li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Rcpp::List pass_list_to_eigen(Rcpp::List L) {
  // double vector
  Eigen::VectorXd x(Rcpp::as&lt;Eigen::VectorXd&gt;(L.at(0)));
  // double matrix
  Eigen::MatrixXd Y(Rcpp::as&lt;Eigen::MatrixXd&gt;(L.at(1)));
  // integer vector
  Eigen::VectorXi z(Rcpp::as&lt;Eigen::VectorXi&gt;(L.at(2)));
  // integer matrix
  Eigen::MatrixXi W(Rcpp::as&lt;Eigen::MatrixXi&gt;(L.at(3)));
  // return
  Rcpp::List output = Rcpp::List::create(x, Y, z, W);
  return(output);
}</code></pre>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="rcpp.html#cb596-1" tabindex="-1"></a><span class="co"># main/main.r</span></span>
<span id="cb596-2"><a href="rcpp.html#cb596-2" tabindex="-1"></a>list_1 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb596-3"><a href="rcpp.html#cb596-3" tabindex="-1"></a>list_1[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> x</span>
<span id="cb596-4"><a href="rcpp.html#cb596-4" tabindex="-1"></a>list_1[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> Y</span>
<span id="cb596-5"><a href="rcpp.html#cb596-5" tabindex="-1"></a>list_1[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> z</span>
<span id="cb596-6"><a href="rcpp.html#cb596-6" tabindex="-1"></a>list_1[[<span class="dv">4</span>]] <span class="ot">&lt;-</span> W</span>
<span id="cb596-7"><a href="rcpp.html#cb596-7" tabindex="-1"></a>list_1</span></code></pre></div>
<pre><code>## [[1]]
## [1]  2.18543791 -0.01282801 -0.30530893 -0.58421346  0.77126850
## 
## [[2]]
##          [,1]       [,2]       [,3]       [,4]      [,5]
## [1,] 2.106189 -0.2612649 -0.7788302 -0.4213451  1.218305
## [2,] 0.412157  2.0737836  1.1315325 -1.0217474 -1.799761
## 
## [[3]]
## [1] 1 2 3 4 5
## 
## [[4]]
##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1</code></pre>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="rcpp.html#cb598-1" tabindex="-1"></a>list_1_eigen <span class="ot">&lt;-</span> <span class="fu">pass_list_to_eigen</span>(list_1)</span>
<span id="cb598-2"><a href="rcpp.html#cb598-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">unlist</span>(list_1) <span class="sc">-</span> <span class="fu">unlist</span>(list_1_eigen)))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li>You can also pass a list with named arguments and return a named list as follows:</li>
</ul>
<pre><code>// src/funtions.cpp
// [[Rcpp::export]]
Rcpp::List pass_named_list_to_eigen(Rcpp::List L) {
  // double vector
  Eigen::VectorXd x(Rcpp::as&lt;Eigen::VectorXd&gt;(L[&quot;x&quot;]));
  // double matrix
  Eigen::MatrixXd Y(Rcpp::as&lt;Eigen::MatrixXd&gt;(L[&quot;Y&quot;]));
  // integer vector
  Eigen::VectorXi z(Rcpp::as&lt;Eigen::VectorXi&gt;(L[&quot;z&quot;]));
  // integer matrix
  Eigen::MatrixXi W(Rcpp::as&lt;Eigen::MatrixXi&gt;(L[&quot;W&quot;]));
  // return
  Rcpp::List output = Rcpp::List::create(
    Rcpp::Named(&quot;x&quot;) = x, 
    Rcpp::Named(&quot;Y&quot;) = Y, 
    Rcpp::Named(&quot;z&quot;) = z, 
    Rcpp::Named(&quot;W&quot;) = W);
  return(output);
}</code></pre>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="rcpp.html#cb601-1" tabindex="-1"></a><span class="co"># main/main.r</span></span>
<span id="cb601-2"><a href="rcpp.html#cb601-2" tabindex="-1"></a>list_2 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb601-3"><a href="rcpp.html#cb601-3" tabindex="-1"></a>list_2<span class="sc">$</span>x <span class="ot">&lt;-</span> x</span>
<span id="cb601-4"><a href="rcpp.html#cb601-4" tabindex="-1"></a>list_2<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y</span>
<span id="cb601-5"><a href="rcpp.html#cb601-5" tabindex="-1"></a>list_2<span class="sc">$</span>z <span class="ot">&lt;-</span> z</span>
<span id="cb601-6"><a href="rcpp.html#cb601-6" tabindex="-1"></a>list_2<span class="sc">$</span>W <span class="ot">&lt;-</span> W</span>
<span id="cb601-7"><a href="rcpp.html#cb601-7" tabindex="-1"></a>list_2</span></code></pre></div>
<pre><code>## $x
## [1]  2.18543791 -0.01282801 -0.30530893 -0.58421346  0.77126850
## 
## $Y
##          [,1]       [,2]       [,3]       [,4]      [,5]
## [1,] 2.106189 -0.2612649 -0.7788302 -0.4213451  1.218305
## [2,] 0.412157  2.0737836  1.1315325 -1.0217474 -1.799761
## 
## $z
## [1] 1 2 3 4 5
## 
## $W
##      [,1] [,2]
## [1,]    1    1
## [2,]    1    1</code></pre>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="rcpp.html#cb603-1" tabindex="-1"></a>list_2_eigen <span class="ot">&lt;-</span> <span class="fu">pass_named_list_to_eigen</span>(list_2)</span>
<span id="cb603-2"><a href="rcpp.html#cb603-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">unlist</span>(list_2) <span class="sc">-</span> <span class="fu">unlist</span>(list_2_eigen)))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li>You can also access to the column of <code>Rcpp::DataFrame</code> in the similar way.</li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Eigen::VectorXd extract_column_from_data_frame(Rcpp::DataFrame D) {
  // pass column x1 of D to Eigen::VectorXd named x1
  Eigen::VectorXd x1(Rcpp::as&lt;Eigen::VectorXd&gt;(D[&quot;x1&quot;]));
  return(x1);
}</code></pre>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="rcpp.html#cb606-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb606-2"><a href="rcpp.html#cb606-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">extract_column_from_data_frame</span>(D)</span>
<span id="cb606-3"><a href="rcpp.html#cb606-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(D<span class="sc">$</span>x1 <span class="sc">-</span> x1))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li>This allows us to pass whatever objects in R to a C++ function.</li>
<li>If you are planning to translate R functions to C/C++, from the beginning, you should write the R functions in the way inputs and outpus can be passed to C/C++ as above.</li>
</ul>
</div>
<div id="passing-r-objects-in-other-objects-in-cc" class="section level2 hasAnchor" number="20.5">
<h2><span class="header-section-number">20.5</span> Passing R Objects in Other Objects in C/C++<a href="rcpp.html#passing-r-objects-in-other-objects-in-cc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><code>integer</code> and <code>numeric</code> scalars in R can be simply passed to <code>int</code> and <code>double</code> in C/C++.</li>
<li>Vectors in R can be passed to <code>std::vector&lt;int&gt;</code> or <code>std::vector&lt;double&gt;</code> objects. This may be helpful if you want to use the methods for <code>std::vector</code>.</li>
</ul>
</div>
<div id="manipulating-objects-in-a-c-function" class="section level2 hasAnchor" number="20.6">
<h2><span class="header-section-number">20.6</span> Manipulating Objects in a C++ Function<a href="rcpp.html#manipulating-objects-in-a-c-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>As mentioned above, the best practice is to pass vectors and matrices to <code>Eigen::VectorXd</code>/<code>Eigen::VectorXi</code> and <code>Eigen::MatrixXd</code>/<code>Eigen::MatrixXi</code> rather than <code>Rcpp::NumericVector</code>/<code>Rcpp::IntegerVector</code> and <code>Rcpp::NumericMatrix</code>/<code>Rcpp::IntegerMatrix</code>.</li>
<li>The other objects will be passed as <code>Rcpp::DataFrame</code> or <code>Rcpp::List</code> and at the end converted to <code>Eigen::VectorXd</code>/<code>Eigen::VectorXi</code> and <code>Eigen::MatrixXd</code>/<code>Eigen::MatrixXi</code> usin <code>Rcpp::as</code> as explained above.</li>
<li>The rest of manipulation will be done using the methods in Eigen. Here I introduce basic operations. For the detail, refer to the <a href="https://eigen.tuxfamily.org/dox/GettingStarted.html">online document of Eigen</a>.</li>
</ul>
<div id="matrix-and-vector-arithmetic" class="section level3 hasAnchor" number="20.6.1">
<h3><span class="header-section-number">20.6.1</span> Matrix and Vector Arithmetic<a href="rcpp.html#matrix-and-vector-arithmetic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Addition and subtraction:
<ul>
<li>Binary operator <span class="math inline">\(+\)</span> as in <code>a + b</code>.</li>
<li>Binary operator <span class="math inline">\(-\)</span> as in <code>a - b</code>.</li>
<li>Unary operator <span class="math inline">\(-\)</span> as in <code>- a</code>.</li>
</ul></li>
<li>Scalar multiplication and division:
<ul>
<li>Binary operator <span class="math inline">\(\times\)</span> as in <code>matrix * scalar</code>.</li>
<li>Binary operator <span class="math inline">\(\times\)</span> as in <code>scalar * matrix</code>.</li>
<li>Binary operator <span class="math inline">\(/\)</span> as in <code>matrix / scalar</code>.</li>
</ul></li>
<li>Transposition:
<ul>
<li>Transposition as in <code>matrix.transpose()</code>.</li>
</ul></li>
<li>Matrix-matrix and matrix-vector multiplication:
<ul>
<li>This part is different from R.</li>
<li>Matrix multiplication is as in <code>A * B</code>.</li>
<li>Coefficientwise multiplication is explained later but is as in <code>A.array() * B.array()</code>.</li>
</ul></li>
<li>Following the best practice, first write R function for these operations in <code>R/functions.R</code> and run in <code>main/main.R</code>:</li>
</ul>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="rcpp.html#cb608-1" tabindex="-1"></a><span class="co"># R/functions.R</span></span>
<span id="cb608-2"><a href="rcpp.html#cb608-2" tabindex="-1"></a><span class="co"># matrix and vector arithmetic</span></span>
<span id="cb608-3"><a href="rcpp.html#cb608-3" tabindex="-1"></a>matrix_vector_arithmetic <span class="ot">&lt;-</span></span>
<span id="cb608-4"><a href="rcpp.html#cb608-4" tabindex="-1"></a>  <span class="cf">function</span>(A, B, v, c) {</span>
<span id="cb608-5"><a href="rcpp.html#cb608-5" tabindex="-1"></a>    <span class="co"># addition and subtraction</span></span>
<span id="cb608-6"><a href="rcpp.html#cb608-6" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> A <span class="sc">+</span> B</span>
<span id="cb608-7"><a href="rcpp.html#cb608-7" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> A <span class="sc">-</span> B</span>
<span id="cb608-8"><a href="rcpp.html#cb608-8" tabindex="-1"></a>    X3 <span class="ot">&lt;-</span> <span class="sc">-</span>A</span>
<span id="cb608-9"><a href="rcpp.html#cb608-9" tabindex="-1"></a>    <span class="co"># scalar multiplication and division</span></span>
<span id="cb608-10"><a href="rcpp.html#cb608-10" tabindex="-1"></a>    X4 <span class="ot">&lt;-</span> A <span class="sc">*</span> c</span>
<span id="cb608-11"><a href="rcpp.html#cb608-11" tabindex="-1"></a>    X5 <span class="ot">&lt;-</span> c <span class="sc">*</span> A</span>
<span id="cb608-12"><a href="rcpp.html#cb608-12" tabindex="-1"></a>    X6 <span class="ot">&lt;-</span> A <span class="sc">/</span> c</span>
<span id="cb608-13"><a href="rcpp.html#cb608-13" tabindex="-1"></a>    <span class="co"># transpose</span></span>
<span id="cb608-14"><a href="rcpp.html#cb608-14" tabindex="-1"></a>    X7 <span class="ot">&lt;-</span> <span class="fu">t</span>(A)</span>
<span id="cb608-15"><a href="rcpp.html#cb608-15" tabindex="-1"></a>    <span class="co"># matrix-matrix and matrix-vector multiplication</span></span>
<span id="cb608-16"><a href="rcpp.html#cb608-16" tabindex="-1"></a>    X8 <span class="ot">&lt;-</span> A <span class="sc">%*%</span> <span class="fu">t</span>(B)</span>
<span id="cb608-17"><a href="rcpp.html#cb608-17" tabindex="-1"></a>    X9 <span class="ot">&lt;-</span> A <span class="sc">%*%</span> v</span>
<span id="cb608-18"><a href="rcpp.html#cb608-18" tabindex="-1"></a>    <span class="co"># return</span></span>
<span id="cb608-19"><a href="rcpp.html#cb608-19" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X1 =</span> X1,</span>
<span id="cb608-20"><a href="rcpp.html#cb608-20" tabindex="-1"></a>                <span class="at">X2 =</span> X2,</span>
<span id="cb608-21"><a href="rcpp.html#cb608-21" tabindex="-1"></a>                <span class="at">X3 =</span> X3,</span>
<span id="cb608-22"><a href="rcpp.html#cb608-22" tabindex="-1"></a>                <span class="at">X4 =</span> X4,</span>
<span id="cb608-23"><a href="rcpp.html#cb608-23" tabindex="-1"></a>                <span class="at">X5 =</span> X5,</span>
<span id="cb608-24"><a href="rcpp.html#cb608-24" tabindex="-1"></a>                <span class="at">X6 =</span> X6,</span>
<span id="cb608-25"><a href="rcpp.html#cb608-25" tabindex="-1"></a>                <span class="at">X7 =</span> X7,</span>
<span id="cb608-26"><a href="rcpp.html#cb608-26" tabindex="-1"></a>                <span class="at">X8 =</span> X8,</span>
<span id="cb608-27"><a href="rcpp.html#cb608-27" tabindex="-1"></a>                <span class="at">X9 =</span> X9))</span>
<span id="cb608-28"><a href="rcpp.html#cb608-28" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="rcpp.html#cb609-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb609-2"><a href="rcpp.html#cb609-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb609-3"><a href="rcpp.html#cb609-3" tabindex="-1"></a><span class="co"># addition subtraction</span></span>
<span id="cb609-4"><a href="rcpp.html#cb609-4" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb609-5"><a href="rcpp.html#cb609-5" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb609-6"><a href="rcpp.html#cb609-6" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb609-7"><a href="rcpp.html#cb609-7" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb609-8"><a href="rcpp.html#cb609-8" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">matrix_vector_arithmetic</span>(A, B, v, c)</span></code></pre></div>
<ul>
<li>Next, write these operations in C++ function:</li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Rcpp::List matrix_vector_arithmetic_rcpp(
    Eigen::MatrixXd A, Eigen::MatrixXd B, 
    Eigen::VectorXd v, double c) {
  // addition and subtraction
  Eigen::MatrixXd X1 = A + B;
  Eigen::MatrixXd X2 = A - B;
  Eigen::MatrixXd X3 = - A;
  // scalar multiplication and division
  Eigen::MatrixXd X4 = A * c;
  Eigen::MatrixXd X5 = c * A;
  Eigen::MatrixXd X6 = A / c;
  // transpose
  Eigen::MatrixXd X7 = A.transpose();
  // matrix-matrix and matrix-vector multiplication
  Eigen::MatrixXd X8 = A * B.transpose();
  Eigen::VectorXd X9 = A * v;
  // return 
  Rcpp::List output = 
    Rcpp::List::create(
      Rcpp::Named(&quot;X1&quot;) = X1,
      Rcpp::Named(&quot;X2&quot;) = X2,
      Rcpp::Named(&quot;X3&quot;) = X3,
      Rcpp::Named(&quot;X4&quot;) = X4,
      Rcpp::Named(&quot;X5&quot;) = X5,
      Rcpp::Named(&quot;X6&quot;) = X6,
      Rcpp::Named(&quot;X7&quot;) = X7,
      Rcpp::Named(&quot;X8&quot;) = X8,
      Rcpp::Named(&quot;X9&quot;) = X9);
  return(output);
}</code></pre>
<ul>
<li>Then, we can check if this yields (almost) the same result with the R function:</li>
</ul>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="rcpp.html#cb611-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb611-2"><a href="rcpp.html#cb611-2" tabindex="-1"></a>output_rcpp <span class="ot">&lt;-</span> <span class="fu">matrix_vector_arithmetic_rcpp</span>(A, B, v, c)</span>
<span id="cb611-3"><a href="rcpp.html#cb611-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">unlist</span>(output) <span class="sc">-</span> <span class="fu">unlist</span>(output_rcpp)))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<ul>
<li>The output looks like:</li>
</ul>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="rcpp.html#cb613-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb613-2"><a href="rcpp.html#cb613-2" tabindex="-1"></a>output_rcpp</span></code></pre></div>
<pre><code>## $X1
##             [,1]      [,2]       [,3]      [,4]
## [1,] -0.05067246 0.6761526 -0.2917328 1.6123600
## [2,] -0.12174506 1.9851240 -3.0351683 0.6933911
## 
## $X2
##            [,1]      [,2]      [,3]       [,4]
## [1,] -1.2022352 -2.347410 0.9507484 -0.6375019
## [2,]  0.4890317  1.205438 1.3942315  0.7832583
## 
## $X3
##            [,1]       [,2]       [,3]       [,4]
## [1,]  0.6264538  0.8356286 -0.3295078 -0.4874291
## [2,] -0.1836433 -1.5952808  0.8204684 -0.7383247
## 
## $X4
##           [,1]      [,2]       [,3]     [,4]
## [1,] -1.879361 -2.506886  0.9885233 1.462287
## [2,]  0.550930  4.785842 -2.4614052 2.214974
## 
## $X5
##           [,1]      [,2]       [,3]     [,4]
## [1,] -1.879361 -2.506886  0.9885233 1.462287
## [2,]  0.550930  4.785842 -2.4614052 2.214974
## 
## $X6
##             [,1]       [,2]       [,3]      [,4]
## [1,] -0.20881794 -0.2785429  0.1098359 0.1624764
## [2,]  0.06121444  0.5317603 -0.2734895 0.2461082
## 
## $X7
##            [,1]       [,2]
## [1,] -0.6264538  0.1836433
## [2,] -0.8356286  1.5952808
## [3,]  0.3295078 -0.8204684
## [4,]  0.4874291  0.7383247
## 
## $X8
##           [,1]       [,2]
## [1,] -1.280368 -0.8861152
## [2,]  3.857726  2.3497425
## 
## $X9
## [1] -0.2184706  1.2674165</code></pre>
</div>
<div id="the-array-class-and-coefficient-wise-operations" class="section level3 hasAnchor" number="20.6.2">
<h3><span class="header-section-number">20.6.2</span> The Array Class and Coefficient-wise Operations<a href="rcpp.html#the-array-class-and-coefficient-wise-operations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>When you want to have coefficient-wise operations, you first use <code>.array()</code> method to convert the object to an array and then apply methods for arrays.</p></li>
<li><p>The resulting array can be assigned to a matrix object implicitly or explicitly by using <code>.matrix()</code> method.</p></li>
<li><p>Coefficient-wise multiplication:</p>
<ul>
<li><code>A * B</code> in R is <code>A.array() * B. array()</code> in Eigen.</li>
</ul></li>
<li><p>Other coefficient-wise math functions:</p>
<ul>
<li>Absolute value: <code>A.array().abs()</code>.</li>
<li>Exponential: <code>A.array().exp()</code>.</li>
<li>Logarithm: <code>A.array().log()</code>.</li>
<li>Power: <code>A.array().power(r)</code>.</li>
<li>For the other methods, refer to the <a href="https://eigen.tuxfamily.org/dox/group__CoeffwiseMathFunctions.html">online document</a>.</li>
</ul></li>
<li><p>Write functions in R in <code>R/functions.R</code> and run in <code>main/main.R</code>:</p></li>
</ul>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="rcpp.html#cb615-1" tabindex="-1"></a><span class="co"># R/functions.R</span></span>
<span id="cb615-2"><a href="rcpp.html#cb615-2" tabindex="-1"></a>coefficientwise_operation <span class="ot">&lt;-</span></span>
<span id="cb615-3"><a href="rcpp.html#cb615-3" tabindex="-1"></a>  <span class="cf">function</span>(A, B, r) {</span>
<span id="cb615-4"><a href="rcpp.html#cb615-4" tabindex="-1"></a>    <span class="co"># coefficient-wise multiplication</span></span>
<span id="cb615-5"><a href="rcpp.html#cb615-5" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> A <span class="sc">*</span> B</span>
<span id="cb615-6"><a href="rcpp.html#cb615-6" tabindex="-1"></a>    <span class="co"># other coefficient-wise math functions</span></span>
<span id="cb615-7"><a href="rcpp.html#cb615-7" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> <span class="fu">abs</span>(A)</span>
<span id="cb615-8"><a href="rcpp.html#cb615-8" tabindex="-1"></a>    X3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(A)</span>
<span id="cb615-9"><a href="rcpp.html#cb615-9" tabindex="-1"></a>    X4 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">abs</span>(A))</span>
<span id="cb615-10"><a href="rcpp.html#cb615-10" tabindex="-1"></a>    X5 <span class="ot">&lt;-</span> A<span class="sc">^</span>r</span>
<span id="cb615-11"><a href="rcpp.html#cb615-11" tabindex="-1"></a>    <span class="co"># return</span></span>
<span id="cb615-12"><a href="rcpp.html#cb615-12" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb615-13"><a href="rcpp.html#cb615-13" tabindex="-1"></a>      <span class="at">X1 =</span> X1,</span>
<span id="cb615-14"><a href="rcpp.html#cb615-14" tabindex="-1"></a>      <span class="at">X2 =</span> X2,</span>
<span id="cb615-15"><a href="rcpp.html#cb615-15" tabindex="-1"></a>      <span class="at">X3 =</span> X3,</span>
<span id="cb615-16"><a href="rcpp.html#cb615-16" tabindex="-1"></a>      <span class="at">X4 =</span> X4,</span>
<span id="cb615-17"><a href="rcpp.html#cb615-17" tabindex="-1"></a>      <span class="at">X5 =</span> X5</span>
<span id="cb615-18"><a href="rcpp.html#cb615-18" tabindex="-1"></a>    ))</span>
<span id="cb615-19"><a href="rcpp.html#cb615-19" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="rcpp.html#cb616-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb616-2"><a href="rcpp.html#cb616-2" tabindex="-1"></a><span class="co"># coefficient-wise operations</span></span>
<span id="cb616-3"><a href="rcpp.html#cb616-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb616-4"><a href="rcpp.html#cb616-4" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">coefficientwise_operation</span>(A, B, r)</span></code></pre></div>
<ul>
<li>Write C++ function in <code>src/functions.cpp</code> and call from <code>main/main.R</code>:</li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Rcpp::List coefficientwise_operation_rcpp(
  Eigen::MatrixXd A,
  Eigen::MatrixXd B,
  int r
) {
  // coefficient-wise multiplication
  Eigen::MatrixXd X1 = A.array() * B.array();
  // other coefficient-wise math functions
  Eigen::MatrixXd X2 = A.array().abs();
  Eigen::MatrixXd X3 = A.array().exp();
  Eigen::MatrixXd X4 = A.array().abs().log();
  Eigen::MatrixXd X5 = A.array().pow(r);
  // return
  Rcpp::List output =
    Rcpp::List::create(
      Rcpp::Named(&quot;X1&quot;) = X1,
      Rcpp::Named(&quot;X2&quot;) = X2,
      Rcpp::Named(&quot;X3&quot;) = X3,
      Rcpp::Named(&quot;X4&quot;) = X4,
      Rcpp::Named(&quot;X5&quot;) = X5
    );
  return(output);
}</code></pre>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="rcpp.html#cb618-1" tabindex="-1"></a>output_rcpp <span class="ot">&lt;-</span> <span class="fu">coefficientwise_operation_rcpp</span>(A, B, r)</span>
<span id="cb618-2"><a href="rcpp.html#cb618-2" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">unlist</span>(output) <span class="sc">-</span> <span class="fu">unlist</span>(output_rcpp)))</span></code></pre></div>
<pre><code>## [1] 2.220446e-16</code></pre>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="rcpp.html#cb620-1" tabindex="-1"></a>output_rcpp</span></code></pre></div>
<pre><code>## $X1
##             [,1]       [,2]       [,3]        [,4]
## [1,] -0.36070042 -1.2632876 -0.2047036  0.54832401
## [2,] -0.05608254  0.6219094  1.8170912 -0.03317559
## 
## $X2
##           [,1]      [,2]      [,3]      [,4]
## [1,] 0.6264538 0.8356286 0.3295078 0.4874291
## [2,] 0.1836433 1.5952808 0.8204684 0.7383247
## 
## $X3
##           [,1]      [,2]      [,3]     [,4]
## [1,] 0.5344838 0.4336018 1.3902836 1.628125
## [2,] 1.2015872 4.9297132 0.4402254 2.092427
## 
## $X4
##            [,1]       [,2]       [,3]       [,4]
## [1,] -0.4676802 -0.1795710 -1.1101553 -0.7186105
## [2,] -1.6947599  0.4670498 -0.1978799 -0.3033716
## 
## $X5
##            [,1]      [,2]      [,3]      [,4]
## [1,] 0.39244438 0.6982752 0.1085754 0.2375871
## [2,] 0.03372487 2.5449208 0.6731684 0.5451234</code></pre>
</div>
<div id="solving-linear-least-squares-systems" class="section level3 hasAnchor" number="20.6.3">
<h3><span class="header-section-number">20.6.3</span> Solving Linear Least Squares Systems<a href="rcpp.html#solving-linear-least-squares-systems" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>It is often required to solve a linear least squares system <span class="math inline">\(A \cdot x = b\)</span>.</li>
<li>Solving using SVD decomposition:</li>
</ul>
<pre><code>A.bdcSvd(Eigen::ComputeThinU | Eigen::ComputeThinV).solve(b)</code></pre>
<ul>
<li>Solving using QR decomposition:</li>
</ul>
<pre><code>A.colPivHouseholderQr().solve(b)</code></pre>
<ul>
<li>Write R function in <code>R/functions.R</code> and run in <code>main/main.R</code>:</li>
</ul>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="rcpp.html#cb624-1" tabindex="-1"></a><span class="co"># R/functions.R</span></span>
<span id="cb624-2"><a href="rcpp.html#cb624-2" tabindex="-1"></a>solve_least_squares <span class="ot">&lt;-</span></span>
<span id="cb624-3"><a href="rcpp.html#cb624-3" tabindex="-1"></a>  <span class="cf">function</span>(A, B) {</span>
<span id="cb624-4"><a href="rcpp.html#cb624-4" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">solve</span>(A, B)</span>
<span id="cb624-5"><a href="rcpp.html#cb624-5" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb624-6"><a href="rcpp.html#cb624-6" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="rcpp.html#cb625-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb625-2"><a href="rcpp.html#cb625-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb625-3"><a href="rcpp.html#cb625-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb625-4"><a href="rcpp.html#cb625-4" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">4</span> <span class="sc">*</span> <span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">4</span>)</span>
<span id="cb625-5"><a href="rcpp.html#cb625-5" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">solve_least_squares</span>(A, B)</span></code></pre></div>
<ul>
<li>Write C++ function in <code>src/functions.cpp</code> and call in <code>main/main.R</code>:</li>
</ul>
<pre><code>// src/functions.cpp
// solve least squares using SVD decomposition
// [[Rcpp::export]]
Eigen::MatrixXd solve_least_squares_svd(
  Eigen::MatrixXd A,
  Eigen::MatrixXd B
) {
  Eigen::MatrixXd x = A.bdcSvd(Eigen::ComputeThinU | Eigen::ComputeThinV).solve(B);
  return(x);
}
// solve least squares using QR decomposition
// [[Rcpp::export]]
Eigen::MatrixXd solve_least_squares_qr(
    Eigen::MatrixXd A,
    Eigen::MatrixXd B
) {
  Eigen::MatrixXd x = A.colPivHouseholderQr().solve(B);
  return(x);
}</code></pre>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="rcpp.html#cb627-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb627-2"><a href="rcpp.html#cb627-2" tabindex="-1"></a>output_svd <span class="ot">&lt;-</span> <span class="fu">solve_least_squares_svd</span>(A, B)</span>
<span id="cb627-3"><a href="rcpp.html#cb627-3" tabindex="-1"></a>output_qr <span class="ot">&lt;-</span> <span class="fu">solve_least_squares_qr</span>(A, B)</span>
<span id="cb627-4"><a href="rcpp.html#cb627-4" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(output <span class="sc">-</span> output_svd))</span></code></pre></div>
<pre><code>## [1] 8.881784e-16</code></pre>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="rcpp.html#cb629-1" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(output <span class="sc">-</span> output_qr))</span></code></pre></div>
<pre><code>## [1] 1.387779e-15</code></pre>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="rcpp.html#cb631-1" tabindex="-1"></a>output_svd</span></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]       [,4]
## [1,]  0.65530863 -1.2441297 -1.0799835  0.5926519
## [2,] -1.34801870  0.1453720  0.7313845 -2.2353988
## [3,]  1.38750763 -0.3405502 -0.7649107  1.5987206
## [4,] -0.06376266 -0.4632165 -0.2296862  0.4681169</code></pre>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="rcpp.html#cb633-1" tabindex="-1"></a>output_qr</span></code></pre></div>
<pre><code>##             [,1]       [,2]       [,3]       [,4]
## [1,]  0.65530863 -1.2441297 -1.0799835  0.5926519
## [2,] -1.34801870  0.1453720  0.7313845 -2.2353988
## [3,]  1.38750763 -0.3405502 -0.7649107  1.5987206
## [4,] -0.06376266 -0.4632165 -0.2296862  0.4681169</code></pre>
</div>
<div id="accessing-to-elements-of-a-matrix-and-vector" class="section level3 hasAnchor" number="20.6.4">
<h3><span class="header-section-number">20.6.4</span> Accessing to Elements of a Matrix and Vector<a href="rcpp.html#accessing-to-elements-of-a-matrix-and-vector" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>You can access to the size information and elements of a matrix and vector as follows:</p></li>
<li><p>Sizes: <code>A.rows()</code> for row numbers and <code>A.cols()</code> for column numbers.</p></li>
<li><p>Element: <code>A(i, j)</code> for (<span class="math inline">\(i + 1\)</span>, <span class="math inline">\(j + 1\)</span>)-th element.</p></li>
<li><p>Rows and columns: <code>A.row(i)</code> for <span class="math inline">\(i + 1\)</span>-th row and <code>A.col(j)</code> for <span class="math inline">\(j + 1\)</span>-th column.</p></li>
<li><p>Write R function in <code>R/functions.R</code> and run in <code>main/main.R</code>:</p></li>
</ul>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="rcpp.html#cb635-1" tabindex="-1"></a><span class="co"># R/functions.R</span></span>
<span id="cb635-2"><a href="rcpp.html#cb635-2" tabindex="-1"></a>access <span class="ot">&lt;-</span> </span>
<span id="cb635-3"><a href="rcpp.html#cb635-3" tabindex="-1"></a>  <span class="cf">function</span>(A, i, j) {</span>
<span id="cb635-4"><a href="rcpp.html#cb635-4" tabindex="-1"></a>    I <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb635-5"><a href="rcpp.html#cb635-5" tabindex="-1"></a>    J <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb635-6"><a href="rcpp.html#cb635-6" tabindex="-1"></a>    a_ij <span class="ot">&lt;-</span> A[i, j]</span>
<span id="cb635-7"><a href="rcpp.html#cb635-7" tabindex="-1"></a>    a_i <span class="ot">&lt;-</span> A[i, ]</span>
<span id="cb635-8"><a href="rcpp.html#cb635-8" tabindex="-1"></a>    a_j <span class="ot">&lt;-</span> A[, j]</span>
<span id="cb635-9"><a href="rcpp.html#cb635-9" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb635-10"><a href="rcpp.html#cb635-10" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb635-11"><a href="rcpp.html#cb635-11" tabindex="-1"></a>        <span class="at">I =</span> I,</span>
<span id="cb635-12"><a href="rcpp.html#cb635-12" tabindex="-1"></a>        <span class="at">J =</span> J,</span>
<span id="cb635-13"><a href="rcpp.html#cb635-13" tabindex="-1"></a>        <span class="at">a_ij =</span> a_ij,</span>
<span id="cb635-14"><a href="rcpp.html#cb635-14" tabindex="-1"></a>        <span class="at">a_i =</span> a_i,</span>
<span id="cb635-15"><a href="rcpp.html#cb635-15" tabindex="-1"></a>        <span class="at">a_j =</span> a_j</span>
<span id="cb635-16"><a href="rcpp.html#cb635-16" tabindex="-1"></a>      )</span>
<span id="cb635-17"><a href="rcpp.html#cb635-17" tabindex="-1"></a>    )</span>
<span id="cb635-18"><a href="rcpp.html#cb635-18" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="rcpp.html#cb636-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb636-2"><a href="rcpp.html#cb636-2" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">access</span>(A, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
<ul>
<li>Write C++ function in <code>src/functions.cpp</code> and call in <code>main/main.R</code>:</li>
</ul>
<pre><code>// src/functions.cpp
// [[Rcpp::export]]
Rcpp::List access_rcpp(
    Eigen::MatrixXd A, 
    int i, 
    int j
  ) {
    int I = A.rows();
    int J = A.cols();
    double a_ij = A(i - 1, j - 1);
    Eigen::VectorXd a_i = A.row(i - 1);
    Eigen::VectorXd a_j = A.col(j - 1);
    Rcpp::List output =
      Rcpp::List::create(
        Rcpp::Named(&quot;I&quot;) = I,
        Rcpp::Named(&quot;J&quot;) = J,
        Rcpp::Named(&quot;a_ij&quot;) = a_ij,
        Rcpp::Named(&quot;a_i&quot;) = a_i,
        Rcpp::Named(&quot;a_j&quot;) = a_j
      );
    return(output);
  }</code></pre>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="rcpp.html#cb638-1" tabindex="-1"></a><span class="co"># main/main.R</span></span>
<span id="cb638-2"><a href="rcpp.html#cb638-2" tabindex="-1"></a>output_rcpp <span class="ot">&lt;-</span> <span class="fu">access_rcpp</span>(A, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb638-3"><a href="rcpp.html#cb638-3" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">abs</span>(<span class="fu">unlist</span>(output) <span class="sc">-</span> <span class="fu">unlist</span>(output_rcpp)))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="rcpp.html#cb640-1" tabindex="-1"></a>output_rcpp </span></code></pre></div>
<pre><code>## $I
## [1] 4
## 
## $J
## [1] 4
## 
## $a_ij
## [1] 0.3295078
## 
## $a_i
## [1] -0.6264538  0.3295078  0.5757814 -0.6212406
## 
## $a_j
## [1]  0.3295078 -0.8204684  0.4874291  0.7383247</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="assignment9.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["lecture.pdf", "lecture.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
