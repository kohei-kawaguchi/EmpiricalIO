<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>ECON 6120I Topics in Empirical Industrial Organization</title>
  <meta name="description" content="Thie is a lecture note for ECON6120I at Hong Kong University of Science and Technology.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="ECON 6120I Topics in Empirical Industrial Organization" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Thie is a lecture note for ECON6120I at Hong Kong University of Science and Technology." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ECON 6120I Topics in Empirical Industrial Organization" />
  
  <meta name="twitter:description" content="Thie is a lecture note for ECON6120I at Hong Kong University of Science and Technology." />
  

<meta name="author" content="Kohei Kawaguchi">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="production.html">
<link rel="next" href="assignment1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECON6120I</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#general-information"><i class="fa fa-check"></i><b>1.2</b> General Information</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#class-time"><i class="fa fa-check"></i><b>1.2.1</b> Class Time</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>1.2.2</b> Description</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#expectation-and-goals"><i class="fa fa-check"></i><b>1.2.3</b> Expectation and Goals</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#required-environment"><i class="fa fa-check"></i><b>1.3</b> Required Environment</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#evaluation"><i class="fa fa-check"></i><b>1.4</b> Evaluation</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#academic-integrity"><i class="fa fa-check"></i><b>1.5</b> Academic Integrity</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.6</b> Schedule</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#course-materials"><i class="fa fa-check"></i><b>1.7</b> Course Materials</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.7.1</b> R and RStudio</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#handbook-chapters"><i class="fa fa-check"></i><b>1.7.2</b> Handbook Chapters</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i><b>1.7.3</b> Books</a></li>
<li class="chapter" data-level="1.7.4" data-path="index.html"><a href="index.html#papers"><i class="fa fa-check"></i><b>1.7.4</b> Papers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#structural-estimation-and-counterfactual-analysis"><i class="fa fa-check"></i><b>2.1</b> Structural Estimation and Counterfactual Analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#recap"><i class="fa fa-check"></i><b>2.1.2</b> Recap</a></li>
<li class="chapter" data-level="2.1.3" data-path="intro.html"><a href="intro.html#historical-remark"><i class="fa fa-check"></i><b>2.1.3</b> Historical Remark</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#setting-up-the-environment"><i class="fa fa-check"></i><b>2.2</b> Setting Up The Environment</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#rstudio-project"><i class="fa fa-check"></i><b>2.2.1</b> RStudio Project</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#basic-programming-in-r"><i class="fa fa-check"></i><b>2.2.2</b> Basic Programming in R</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#reproducible-reports-using-rmarkdown"><i class="fa fa-check"></i><b>2.2.3</b> Reproducible Reports using Rmarkdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="production.html"><a href="production.html"><i class="fa fa-check"></i><b>3</b> Production and Cost Function Estimation</a><ul>
<li class="chapter" data-level="3.1" data-path="production.html"><a href="production.html#motivations"><i class="fa fa-check"></i><b>3.1</b> Motivations</a><ul>
<li class="chapter" data-level="3.1.1" data-path="production.html"><a href="production.html#io"><i class="fa fa-check"></i><b>3.1.1</b> IO</a></li>
<li class="chapter" data-level="3.1.2" data-path="production.html"><a href="production.html#development"><i class="fa fa-check"></i><b>3.1.2</b> Development</a></li>
<li class="chapter" data-level="3.1.3" data-path="production.html"><a href="production.html#trade"><i class="fa fa-check"></i><b>3.1.3</b> Trade</a></li>
<li class="chapter" data-level="3.1.4" data-path="production.html"><a href="production.html#management"><i class="fa fa-check"></i><b>3.1.4</b> Management</a></li>
<li class="chapter" data-level="3.1.5" data-path="production.html"><a href="production.html#education"><i class="fa fa-check"></i><b>3.1.5</b> Education</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="production.html"><a href="production.html#analyzing-producer-behaviors"><i class="fa fa-check"></i><b>3.2</b> Analyzing Producer Behaviors</a></li>
<li class="chapter" data-level="3.3" data-path="production.html"><a href="production.html#production-function-estimation"><i class="fa fa-check"></i><b>3.3</b> Production Function Estimation</a><ul>
<li class="chapter" data-level="3.3.1" data-path="production.html"><a href="production.html#cobb-douglas-specification-as-a-benchmark"><i class="fa fa-check"></i><b>3.3.1</b> Cobb-Douglas Specification as a Benchmark</a></li>
<li class="chapter" data-level="3.3.2" data-path="production.html"><a href="production.html#potential-bias-i-endogeneity"><i class="fa fa-check"></i><b>3.3.2</b> Potential Bias I: Endogeneity</a></li>
<li class="chapter" data-level="3.3.3" data-path="production.html"><a href="production.html#potential-bias-ii-selection"><i class="fa fa-check"></i><b>3.3.3</b> Potential Bias II: Selection</a></li>
<li class="chapter" data-level="3.3.4" data-path="production.html"><a href="production.html#how-to-resolve-endogeneity-bias"><i class="fa fa-check"></i><b>3.3.4</b> How to Resolve Endogeneity Bias?</a></li>
<li class="chapter" data-level="3.3.5" data-path="production.html"><a href="production.html#panel-data"><i class="fa fa-check"></i><b>3.3.5</b> Panel Data</a></li>
<li class="chapter" data-level="3.3.6" data-path="production.html"><a href="production.html#first-order-condition-for-inputs"><i class="fa fa-check"></i><b>3.3.6</b> First-Order Condition for Inputs</a></li>
<li class="chapter" data-level="3.3.7" data-path="production.html"><a href="production.html#productioniv"><i class="fa fa-check"></i><b>3.3.7</b> Instrumental Variable</a></li>
<li class="chapter" data-level="3.3.8" data-path="production.html"><a href="production.html#olley-pakes-approach"><i class="fa fa-check"></i><b>3.3.8</b> Olley-Pakes Approach</a></li>
<li class="chapter" data-level="3.3.9" data-path="production.html"><a href="production.html#assumption-i-information-set"><i class="fa fa-check"></i><b>3.3.9</b> Assumption I: Information Set</a></li>
<li class="chapter" data-level="3.3.10" data-path="production.html"><a href="production.html#assumption-ii-first-order-markov"><i class="fa fa-check"></i><b>3.3.10</b> Assumption II: First Order Markov</a></li>
<li class="chapter" data-level="3.3.11" data-path="production.html"><a href="production.html#assumption-iii-timing-of-input-choices"><i class="fa fa-check"></i><b>3.3.11</b> Assumption III: Timing of Input Choices</a></li>
<li class="chapter" data-level="3.3.12" data-path="production.html"><a href="production.html#assumption-iv-scalar-unobservable"><i class="fa fa-check"></i><b>3.3.12</b> Assumption IV: Scalar Unobservable</a></li>
<li class="chapter" data-level="3.3.13" data-path="production.html"><a href="production.html#assumption-iv-strict-monotonicity"><i class="fa fa-check"></i><b>3.3.13</b> Assumption IV: Strict Monotonicity</a></li>
<li class="chapter" data-level="3.3.14" data-path="production.html"><a href="production.html#two-step-approach-the-first-step"><i class="fa fa-check"></i><b>3.3.14</b> Two-step Approach: The First Step</a></li>
<li class="chapter" data-level="3.3.15" data-path="production.html"><a href="production.html#two-step-approach-the-second-step"><i class="fa fa-check"></i><b>3.3.15</b> Two-step Approach: The Second Step</a></li>
<li class="chapter" data-level="3.3.16" data-path="production.html"><a href="production.html#identification-of-the-anticipated-shocks"><i class="fa fa-check"></i><b>3.3.16</b> Identification of the Anticipated Shocks</a></li>
<li class="chapter" data-level="3.3.17" data-path="production.html"><a href="production.html#two-step-estimation-of-olley1996."><i class="fa fa-check"></i><b>3.3.17</b> Two-Step Estimation of <span class="citation">Olley &amp; Pakes (<a href="#ref-Olley1996">1996</a>)</span>.</a></li>
<li class="chapter" data-level="3.3.18" data-path="production.html"><a href="production.html#from-an-economic-models-to-an-econometric-model"><i class="fa fa-check"></i><b>3.3.18</b> From An Economic Models to An Econometric Model</a></li>
<li class="chapter" data-level="3.3.19" data-path="production.html"><a href="production.html#how-to-resolve-selection-bias"><i class="fa fa-check"></i><b>3.3.19</b> How to Resolve Selection Bias</a></li>
<li class="chapter" data-level="3.3.20" data-path="production.html"><a href="production.html#correction-in-the-first-step"><i class="fa fa-check"></i><b>3.3.20</b> Correction in the First Step</a></li>
<li class="chapter" data-level="3.3.21" data-path="production.html"><a href="production.html#correction-in-the-second-step-i-the-source-of-bias"><i class="fa fa-check"></i><b>3.3.21</b> Correction in the Second Step I: The Source of Bias</a></li>
<li class="chapter" data-level="3.3.22" data-path="production.html"><a href="production.html#correction-in-the-second-step-ii-conditional-exit-probability"><i class="fa fa-check"></i><b>3.3.22</b> Correction in the Second Step II: Conditional Exit Probability</a></li>
<li class="chapter" data-level="3.3.23" data-path="production.html"><a href="production.html#correction-in-the-second-step-iii-invertibility-in-threshold"><i class="fa fa-check"></i><b>3.3.23</b> Correction in the Second Step III: Invertibility in Threshold</a></li>
<li class="chapter" data-level="3.3.24" data-path="production.html"><a href="production.html#correction-in-the-second-step-iv-controlling-the-threshold"><i class="fa fa-check"></i><b>3.3.24</b> Correction in the Second Step IV: Controlling the Threshold</a></li>
<li class="chapter" data-level="3.3.25" data-path="production.html"><a href="production.html#three-step-estimation-of-olley1996"><i class="fa fa-check"></i><b>3.3.25</b> Three Step Estimation of <span class="citation">Olley &amp; Pakes (<a href="#ref-Olley1996">1996</a>)</span></a></li>
<li class="chapter" data-level="3.3.26" data-path="production.html"><a href="production.html#zero-investment-problem"><i class="fa fa-check"></i><b>3.3.26</b> Zero Investment Problem</a></li>
<li class="chapter" data-level="3.3.27" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-i-discard-some-data"><i class="fa fa-check"></i><b>3.3.27</b> Tackle Zero Investment Problem I: Discard Some Data</a></li>
<li class="chapter" data-level="3.3.28" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-ii-use-another-proxy"><i class="fa fa-check"></i><b>3.3.28</b> Tackle Zero Investment Problem II: Use Another Proxy</a></li>
<li class="chapter" data-level="3.3.29" data-path="production.html"><a href="production.html#one-step-estimation-of-olley1996-and-levinsohn2003"><i class="fa fa-check"></i><b>3.3.29</b> One-step Estimation of <span class="citation">Olley &amp; Pakes (<a href="#ref-Olley1996">1996</a>)</span> and <span class="citation">Levinsohn &amp; Petrin (<a href="#ref-Levinsohn2003">2003</a>)</span></a></li>
<li class="chapter" data-level="3.3.30" data-path="production.html"><a href="production.html#scalar-unobservable-problem-finite-order-markov-process"><i class="fa fa-check"></i><b>3.3.30</b> Scalar Unobservable Problem: Finite-order Markov Process</a></li>
<li class="chapter" data-level="3.3.31" data-path="production.html"><a href="production.html#scalar-unobservable-problem-demand-and-productivity-shocks"><i class="fa fa-check"></i><b>3.3.31</b> Scalar Unobservable Problem: Demand and Productivity Shocks</a></li>
<li class="chapter" data-level="3.3.32" data-path="production.html"><a href="production.html#collinearity-problem"><i class="fa fa-check"></i><b>3.3.32</b> Collinearity Problem</a></li>
<li class="chapter" data-level="3.3.33" data-path="production.html"><a href="production.html#tackle-collinearity-problem-peculiar-assumptions"><i class="fa fa-check"></i><b>3.3.33</b> Tackle Collinearity Problem: Peculiar Assumptions</a></li>
<li class="chapter" data-level="3.3.34" data-path="production.html"><a href="production.html#tackle-collinearity-problem-share-regression"><i class="fa fa-check"></i><b>3.3.34</b> Tackle Collinearity Problem: Share Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="production.html"><a href="production.html#cost-function-estimation"><i class="fa fa-check"></i><b>3.4</b> Cost Function Estimation</a><ul>
<li class="chapter" data-level="3.4.1" data-path="production.html"><a href="production.html#cost-function-duality"><i class="fa fa-check"></i><b>3.4.1</b> Cost Function: Duality</a></li>
<li class="chapter" data-level="3.4.2" data-path="production.html"><a href="production.html#translog-cost-function"><i class="fa fa-check"></i><b>3.4.2</b> Translog Cost Function</a></li>
<li class="chapter" data-level="3.4.3" data-path="production.html"><a href="production.html#translog-cost-function-integrability"><i class="fa fa-check"></i><b>3.4.3</b> Translog Cost Function: Integrability</a></li>
<li class="chapter" data-level="3.4.4" data-path="production.html"><a href="production.html#two-approaches"><i class="fa fa-check"></i><b>3.4.4</b> Two Approaches</a></li>
<li class="chapter" data-level="3.4.5" data-path="production.html"><a href="production.html#cost-data-approach"><i class="fa fa-check"></i><b>3.4.5</b> Cost Data Approach</a></li>
<li class="chapter" data-level="3.4.6" data-path="production.html"><a href="production.html#revealed-preference-approach"><i class="fa fa-check"></i><b>3.4.6</b> Revealed Preference Approach</a></li>
<li class="chapter" data-level="3.4.7" data-path="production.html"><a href="production.html#single-product-monopolist"><i class="fa fa-check"></i><b>3.4.7</b> Single-product Monopolist</a></li>
<li class="chapter" data-level="3.4.8" data-path="production.html"><a href="production.html#unobserved-heterogeneity-in-the-cost-function"><i class="fa fa-check"></i><b>3.4.8</b> Unobserved Heterogeneity in the Cost Function</a></li>
<li class="chapter" data-level="3.4.9" data-path="production.html"><a href="production.html#multi-product-monopolist-case"><i class="fa fa-check"></i><b>3.4.9</b> Multi-product Monopolist Case</a></li>
<li class="chapter" data-level="3.4.10" data-path="production.html"><a href="production.html#oligopoly"><i class="fa fa-check"></i><b>3.4.10</b> Oligopoly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="demand.html"><a href="demand.html"><i class="fa fa-check"></i><b>4</b> Demand Function Estimation</a><ul>
<li class="chapter" data-level="4.1" data-path="demand.html"><a href="demand.html#motivations-1"><i class="fa fa-check"></i><b>4.1</b> Motivations</a></li>
<li class="chapter" data-level="4.2" data-path="demand.html"><a href="demand.html#analyzing-consumer-behaviors"><i class="fa fa-check"></i><b>4.2</b> Analyzing Consumer Behaviors</a></li>
<li class="chapter" data-level="4.3" data-path="demand.html"><a href="demand.html#continuous-choice"><i class="fa fa-check"></i><b>4.3</b> Continuous Choice</a><ul>
<li class="chapter" data-level="4.3.1" data-path="demand.html"><a href="demand.html#duality-between-utility-and-expenditure-functions"><i class="fa fa-check"></i><b>4.3.1</b> Duality between Utility and Expenditure Functions</a></li>
<li class="chapter" data-level="4.3.2" data-path="demand.html"><a href="demand.html#deriving-other-functions"><i class="fa fa-check"></i><b>4.3.2</b> Deriving Other Functions</a></li>
<li class="chapter" data-level="4.3.3" data-path="demand.html"><a href="demand.html#starting-from-an-indirect-utility-function"><i class="fa fa-check"></i><b>4.3.3</b> Starting from an Indirect Utility Function</a></li>
<li class="chapter" data-level="4.3.4" data-path="demand.html"><a href="demand.html#expenditure-share-equation"><i class="fa fa-check"></i><b>4.3.4</b> Expenditure Share Equation</a></li>
<li class="chapter" data-level="4.3.5" data-path="demand.html"><a href="demand.html#almost-ideal-demand-system-aids"><i class="fa fa-check"></i><b>4.3.5</b> Almost Ideal Demand System (AIDS)</a></li>
<li class="chapter" data-level="4.3.6" data-path="demand.html"><a href="demand.html#piglog-class"><i class="fa fa-check"></i><b>4.3.6</b> PIGLOG Class</a></li>
<li class="chapter" data-level="4.3.7" data-path="demand.html"><a href="demand.html#derive-the-share-equation-i"><i class="fa fa-check"></i><b>4.3.7</b> Derive the Share Equation I</a></li>
<li class="chapter" data-level="4.3.8" data-path="demand.html"><a href="demand.html#derive-the-share-equation-ii"><i class="fa fa-check"></i><b>4.3.8</b> Derive the Share Equation II</a></li>
<li class="chapter" data-level="4.3.9" data-path="demand.html"><a href="demand.html#specify-the-detail-ii"><i class="fa fa-check"></i><b>4.3.9</b> Specify the Detail II</a></li>
<li class="chapter" data-level="4.3.10" data-path="demand.html"><a href="demand.html#estimation"><i class="fa fa-check"></i><b>4.3.10</b> Estimation</a></li>
<li class="chapter" data-level="4.3.11" data-path="demand.html"><a href="demand.html#from-product-space-approach-to-characteristics-space-approach"><i class="fa fa-check"></i><b>4.3.11</b> From Product Space Approach to Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.3.12" data-path="demand.html"><a href="demand.html#from-continuous-choice-approach-to-discrete-choice-approach"><i class="fa fa-check"></i><b>4.3.12</b> From Continuous Choice Approach to Discrete Choice Approach</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="demand.html"><a href="demand.html#discrete-choice"><i class="fa fa-check"></i><b>4.4</b> Discrete Choice</a><ul>
<li class="chapter" data-level="4.4.1" data-path="demand.html"><a href="demand.html#discrete-choice-approach"><i class="fa fa-check"></i><b>4.4.1</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.2" data-path="demand.html"><a href="demand.html#discrete-choice-approach-1"><i class="fa fa-check"></i><b>4.4.2</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.3" data-path="demand.html"><a href="demand.html#discrete-choice-approach-2"><i class="fa fa-check"></i><b>4.4.3</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.4" data-path="demand.html"><a href="demand.html#characteristics-space-approach"><i class="fa fa-check"></i><b>4.4.4</b> Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.4.5" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect"><i class="fa fa-check"></i><b>4.4.5</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.6" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect-1"><i class="fa fa-check"></i><b>4.4.6</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.7" data-path="demand.html"><a href="demand.html#utility-function-normalization"><i class="fa fa-check"></i><b>4.4.7</b> Utility Function Normalization</a></li>
<li class="chapter" data-level="4.4.8" data-path="demand.html"><a href="demand.html#aggregation-of-the-individual-demand"><i class="fa fa-check"></i><b>4.4.8</b> Aggregation of the Individual Demand</a></li>
<li class="chapter" data-level="4.4.9" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation"><i class="fa fa-check"></i><b>4.4.9</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.10" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.10</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.11" data-path="demand.html"><a href="demand.html#vertical-product-differentiation"><i class="fa fa-check"></i><b>4.4.11</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.12" data-path="demand.html"><a href="demand.html#vertical-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.12</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.13" data-path="demand.html"><a href="demand.html#econometric-models"><i class="fa fa-check"></i><b>4.4.13</b> Econometric Models</a></li>
<li class="chapter" data-level="4.4.14" data-path="demand.html"><a href="demand.html#multinomial-logit-model-preference-shock"><i class="fa fa-check"></i><b>4.4.14</b> Multinomial Logit Model: Preference Shock</a></li>
<li class="chapter" data-level="4.4.15" data-path="demand.html"><a href="demand.html#multinomial-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.15</b> Multinomial Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.16" data-path="demand.html"><a href="demand.html#multinomial-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.16</b> Multinomial Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.17" data-path="demand.html"><a href="demand.html#multinomial-logit-model-inclusive-value"><i class="fa fa-check"></i><b>4.4.17</b> Multinomial Logit Model: Inclusive Value</a></li>
<li class="chapter" data-level="4.4.18" data-path="demand.html"><a href="demand.html#maximum-likelihood-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.18</b> Maximum Likelihood Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.19" data-path="demand.html"><a href="demand.html#nonlinear-least-square-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.19</b> Nonlinear Least Square Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.20" data-path="demand.html"><a href="demand.html#iia-problem"><i class="fa fa-check"></i><b>4.4.20</b> IIA Problem</a></li>
<li class="chapter" data-level="4.4.21" data-path="demand.html"><a href="demand.html#blue-bus-and-red-bus-problem"><i class="fa fa-check"></i><b>4.4.21</b> Blue Bus and Red Bus Problem</a></li>
<li class="chapter" data-level="4.4.22" data-path="demand.html"><a href="demand.html#restrictive-price-elasticity"><i class="fa fa-check"></i><b>4.4.22</b> Restrictive Price Elasticity</a></li>
<li class="chapter" data-level="4.4.23" data-path="demand.html"><a href="demand.html#monotonic-inclusive-value"><i class="fa fa-check"></i><b>4.4.23</b> Monotonic Inclusive Value</a></li>
<li class="chapter" data-level="4.4.24" data-path="demand.html"><a href="demand.html#the-source-of-the-problem"><i class="fa fa-check"></i><b>4.4.24</b> The Source of the Problem</a></li>
<li class="chapter" data-level="4.4.25" data-path="demand.html"><a href="demand.html#correlation-in-preference-shocks"><i class="fa fa-check"></i><b>4.4.25</b> Correlation in Preference Shocks</a></li>
<li class="chapter" data-level="4.4.26" data-path="demand.html"><a href="demand.html#observed-and-unobserved-consumer-heterogeneity"><i class="fa fa-check"></i><b>4.4.26</b> Observed and Unobserved Consumer Heterogeneity</a></li>
<li class="chapter" data-level="4.4.27" data-path="demand.html"><a href="demand.html#mixed-logit-model"><i class="fa fa-check"></i><b>4.4.27</b> Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.28" data-path="demand.html"><a href="demand.html#mixed-logit-model-parametric-assumptions"><i class="fa fa-check"></i><b>4.4.28</b> Mixed Logit Model : Parametric Assumptions</a></li>
<li class="chapter" data-level="4.4.29" data-path="demand.html"><a href="demand.html#mixed-logit-model-iia"><i class="fa fa-check"></i><b>4.4.29</b> Mixed Logit Model: IIA</a></li>
<li class="chapter" data-level="4.4.30" data-path="demand.html"><a href="demand.html#mixed-logit-moel-price-elasticities"><i class="fa fa-check"></i><b>4.4.30</b> Mixed Logit Moel: Price Elasticities</a></li>
<li class="chapter" data-level="4.4.31" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.31</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.32" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model-1"><i class="fa fa-check"></i><b>4.4.32</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.33" data-path="demand.html"><a href="demand.html#simulated-non-linear-least-square-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.33</b> Simulated Non-linear Least Square Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.34" data-path="demand.html"><a href="demand.html#nested-logit-model-a-special-case-of-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.34</b> Nested Logit Model: A Special Case of Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.35" data-path="demand.html"><a href="demand.html#nested-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.35</b> Nested Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.36" data-path="demand.html"><a href="demand.html#nested-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.36</b> Nested Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.37" data-path="demand.html"><a href="demand.html#nested-logit-model-decomposition-of-the-choice-probability"><i class="fa fa-check"></i><b>4.4.37</b> Nested Logit Model: Decomposition of the Choice Probability</a></li>
<li class="chapter" data-level="4.4.38" data-path="demand.html"><a href="demand.html#discrete-choice-model-with-unobserved-fixed-effects"><i class="fa fa-check"></i><b>4.4.38</b> Discrete Choice Model with Unobserved Fixed Effects</a></li>
<li class="chapter" data-level="4.4.39" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.39</b> Unobserved Fixed Effects in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.40" data-path="demand.html"><a href="demand.html#instrumental-variables-and-inversion"><i class="fa fa-check"></i><b>4.4.40</b> Instrumental Variables and Inversion</a></li>
<li class="chapter" data-level="4.4.41" data-path="demand.html"><a href="demand.html#inversion-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.41</b> Inversion in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.42" data-path="demand.html"><a href="demand.html#market-invariant-product-specific-fixed-effects"><i class="fa fa-check"></i><b>4.4.42</b> Market-invariant Product-specific Fixed Effects</a></li>
<li class="chapter" data-level="4.4.43" data-path="demand.html"><a href="demand.html#unobserved-consumer-heterogeneity-and-unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.43</b> Unobserved Consumer Heterogeneity and Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.44" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.44</b> Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.45" data-path="demand.html"><a href="demand.html#representing-xi_jt-as-a-function-of-parameters-of-interest"><i class="fa fa-check"></i><b>4.4.45</b> Representing <span class="math inline">\(\xi_{jt}\)</span> as a Function of Parameters of Interest</a></li>
<li class="chapter" data-level="4.4.46" data-path="demand.html"><a href="demand.html#summarizing-the-conditional-mean-term"><i class="fa fa-check"></i><b>4.4.46</b> Summarizing the Conditional Mean Term</a></li>
<li class="chapter" data-level="4.4.47" data-path="demand.html"><a href="demand.html#contraction-mapping-for-delta_t."><i class="fa fa-check"></i><b>4.4.47</b> Contraction Mapping for <span class="math inline">\(\delta_t\)</span>.</a></li>
<li class="chapter" data-level="4.4.48" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta"><i class="fa fa-check"></i><b>4.4.48</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span></a></li>
<li class="chapter" data-level="4.4.49" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta-summary"><i class="fa fa-check"></i><b>4.4.49</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span>: Summary</a></li>
<li class="chapter" data-level="4.4.50" data-path="demand.html"><a href="demand.html#gmm-objective-function"><i class="fa fa-check"></i><b>4.4.50</b> GMM Objective Function</a></li>
<li class="chapter" data-level="4.4.51" data-path="demand.html"><a href="demand.html#estimating-linear-parameters"><i class="fa fa-check"></i><b>4.4.51</b> Estimating Linear Parameters</a></li>
<li class="chapter" data-level="4.4.52" data-path="demand.html"><a href="demand.html#blp-algorithm"><i class="fa fa-check"></i><b>4.4.52</b> BLP Algorithm</a></li>
<li class="chapter" data-level="4.4.53" data-path="demand.html"><a href="demand.html#mathematical-program-with-equilibrium-constraints-mpec"><i class="fa fa-check"></i><b>4.4.53</b> Mathematical Program with Equilibrium Constraints (MPEC)</a></li>
<li class="chapter" data-level="4.4.54" data-path="demand.html"><a href="demand.html#instrumental-variables"><i class="fa fa-check"></i><b>4.4.54</b> Instrumental Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="assignment1.html"><a href="assignment1.html"><i class="fa fa-check"></i><b>5</b> Assignment 1: Basic Programming in R</a><ul>
<li class="chapter" data-level="5.1" data-path="assignment1.html"><a href="assignment1.html#simulate-data"><i class="fa fa-check"></i><b>5.1</b> Simulate data</a></li>
<li class="chapter" data-level="5.2" data-path="assignment1.html"><a href="assignment1.html#estimate-the-parameter"><i class="fa fa-check"></i><b>5.2</b> Estimate the parameter</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="assignment2.html"><a href="assignment2.html"><i class="fa fa-check"></i><b>6</b> Assignment 2: Production Function Estimation</a><ul>
<li class="chapter" data-level="6.1" data-path="assignment2.html"><a href="assignment2.html#simulate-data-1"><i class="fa fa-check"></i><b>6.1</b> Simulate data</a></li>
<li class="chapter" data-level="6.2" data-path="assignment2.html"><a href="assignment2.html#estimate-the-parameters"><i class="fa fa-check"></i><b>6.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECON 6120I Topics in Empirical Industrial Organization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="demand" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Demand Function Estimation</h1>
<div id="motivations-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Motivations</h2>
<ul>
<li>From demand function and utility maximization assumption, we can reveal the preference of the decision maker.</li>
<li>Thus, estimating demand function is necessary for <strong>evaluating the consumer welfare</strong>.</li>
<li>In IO, estimating the <strong>price elasticity of demand</strong> is specifically important, because it determines the <strong>market power</strong> of a monopolist and the size of the dead-weight loss.</li>
<li>In macroeconomics, estimating demand is in important to determine the <strong>price level</strong>, because the price level is the minimum expenditure for a consumer to achieve the certain level of utility.</li>
<li>In marketing, estimating demand is necessary to design the optimal pricing, advertising, and all the other marketing interventions.</li>
<li><p>In principle, the theory can be applied to whatever decisions other than the consumer choice.</p></li>
<li><span class="citation">Nevo (<a href="#ref-Nevo2000c">2000</a>)</span>:
<ul>
<li>How do the hypothetical mergers in the ready-to-eat cereal industry affect the market price, markup, and consumer surplus?</li>
<li>To do so, the authors estimate the demand for ready-to-eat cereals and the cost functions for each product. Then, the authors conduct counterfactual simulations of mergers to quantify the effects.</li>
</ul></li>
<li><span class="citation">Chung &amp; Alcácer (<a href="#ref-Chung2002">2002</a>)</span>:
<ul>
<li>To what extent do firms go abroad to access technology available in other locations?</li>
<li>To study this issue, the authors estimate the firms’ locational choice when going abroad.</li>
</ul></li>
<li><span class="citation">Rysman (<a href="#ref-Rysman2004">2004</a>)</span>:
<ul>
<li>In Yellow pages, how do consumers evaluate the advertisement on it, and how do advertisers value consumer usage?</li>
<li>To study this, the author simultaneously estimate the consumer demand for usage of a directory, advertiser demand for advertising, and a publisher’s first-order condition.</li>
</ul></li>
<li><span class="citation">Gentzow (<a href="#ref-Gentzkow2004">2004</a>)</span>:
<ul>
<li>Are online and print newspapers substitutes or complements?</li>
<li>To study this, the author estimate a demand function in which online and print newspapers can be either substitutes or complements.</li>
</ul></li>
<li><span class="citation">Bayer et al. (<a href="#ref-Bayer2007">2007</a>)</span>:
<ul>
<li>How is the preference of people for schools and neighborhoods? How is this capitalized into housing prices?</li>
<li>To do so, the authors estimate the discrete choice of residents over locations. To deal with the endogeneity between the neighborhood and the unobserved attributes of the location, the authors use the discontinuity at the school attendance zone.</li>
</ul></li>
<li><span class="citation">Archak, Ghose, &amp; Ipeirotis (<a href="#ref-Archak2011">2011</a>)</span>:
<ul>
<li>How does the information embedded in product reviews the consumer choice?</li>
<li>To study this, the authors estimate the discrete choice model of consumers in which the text information from the product reviews are included as the product attributes.</li>
</ul></li>
<li><span class="citation">Holmes (<a href="#ref-Holmes2011">2011</a>)</span>:
<ul>
<li>Wal-Mart maintain high store density. How large is the economy of density and the sales cannibalization?</li>
<li>To study this, the author first estimate the demand function across neighborhood Wal-Mart to capture the sales cannibalization, and then estimate the cost structure from their entry and exit behaviors.</li>
</ul></li>
<li><span class="citation">Handbury &amp; Weinstein (<a href="#ref-Handbury2014">2014</a>)</span>:
<ul>
<li>Urban and rural areas differ in available products. How does the price difference change if the heterogeneity in the product availability is incorporated?</li>
<li>To do so, the authors estimate the demand function at each location, and the construct the spatial price index based on the available products at each location.</li>
</ul></li>
</ul>
</div>
<div id="analyzing-consumer-behaviors" class="section level2">
<h2><span class="header-section-number">4.2</span> Analyzing Consumer Behaviors</h2>
<ul>
<li><strong>Alternative set</strong>.</li>
<li><strong>Utility function</strong>.
<ul>
<li>Add system of <strong>choice sets</strong>.</li>
<li>Aad utility maximization.</li>
</ul></li>
<li><p><span class="math inline">\(\rightarrow\)</span> <strong>Demand function</strong>.</p></li>
<li>In case of producer behavior, there was a chance to directly observe the output of the most primitive function, the production function.</li>
<li>In case of consumer behavior, we never directly observe the output of the most primitive function, the utility function.</li>
<li>We can at most identify demand functions.</li>
<li><strong>Revealed preference theory</strong>:
<ul>
<li><span class="citation">Samuelson (<a href="#ref-Samuelson1938">1938</a>)</span>, <span class="citation">Houthakker (<a href="#ref-Houthakker1950">1950</a>)</span>, <span class="citation">Richter (<a href="#ref-Richter1966">1966</a>)</span>, <span class="citation">Afriat (<a href="#ref-Afriat1967">1967</a>)</span>, <span class="citation">Varian (<a href="#ref-Varian1982">1982</a>)</span>.</li>
<li>If the demand function is derived from a preference by maximizing the preference, the demand function should satisfy some restrictions.</li>
<li>If the assumption is true, we can recover part of the preference from the demand function.</li>
</ul></li>
</ul>
</div>
<div id="continuous-choice" class="section level2">
<h2><span class="header-section-number">4.3</span> Continuous Choice</h2>
<ul>
<li>The alternative set <span class="math inline">\(\mathcal{X}\)</span> is a subset of <span class="math inline">\(\mathbb{R}^J\)</span>.</li>
<li>The utility function <span class="math inline">\(u\)</span> is rational, monotone, and continuous on <span class="math inline">\(\mathcal{X}\)</span>.</li>
<li>The choice sets are given by a system of <strong>linear budget set</strong>: <span class="math display">\[
\mathcal{B}(p, x) = \{q \in \mathcal{X}: p \cdot q \le w\}.
\]</span></li>
<li>If choice sets are non-linear, the following duality approach needs to be modified.</li>
</ul>
<div id="duality-between-utility-and-expenditure-functions" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Duality between Utility and Expenditure Functions</h3>
<ul>
<li>It is rather a special case that we can derive a closed form solution to a utility maximization problem.</li>
<li>We can use the first-order conditions as moment conditions for identification.
<span class="math display">\[\begin{equation}
\frac{\partial u(q)}{\partial q_i} = \lambda p_i, i = 1, \cdots, J.
\end{equation}\]</span></li>
<li>The derivation of a demand function from the identified utility function in general require a numerical simulation, which can be bothering.</li>
<li>As well as the duality between production and cost functions, we have the same duality theorem for utility and expenditure functions.</li>
<li>There is a one-to-one mapping between a class of utility functions and a class of expenditure functions.</li>
<li>Therefore, it is okay to start from an expenditure function.</li>
<li>It is rare that we can recover the utility function associated with an expenditure function in a closed form. But it is not often required for analysis.</li>
<li>Moreover, we can easily derive other important functions from the expenditure functions.</li>
<li>Let <span class="math inline">\(p\)</span> be the price vector and <span class="math inline">\(u\)</span> be the target utility level.</li>
<li>Let <span class="math inline">\(u(q)\)</span> be a utility function.</li>
<li>An expenditure function associated with the utility function is defined by:
<span class="math display">\[\begin{equation}
e(u, p) = \min_{q} p \cdot q, u(q) \ge u.
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(x\)</span> be the total expenditure such that:
<span class="math display">\[\begin{equation}
x = e(u, p).
\end{equation}\]</span></li>
<li>We can start the analysis by specifying this function instead of the utility function.</li>
</ul>
</div>
<div id="deriving-other-functions" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Deriving Other Functions</h3>
<ul>
<li>It is easy to derive other functions from an expenditure function.</li>
<li><strong>Indirect utility function</strong>: invert the expenditure function to get:
<span class="math display">\[\begin{equation}
u = e^{-1}(p, x) \equiv v(p, x).
\end{equation}\]</span></li>
<li><strong>Hicksian demand function</strong>: apply Shepard’s lemma:
<span class="math display">\[\begin{equation}
q_i = \frac{\partial e(u, p)}{\partial p_i} \equiv h_i(u, p).
\end{equation}\]</span></li>
<li><strong>Marshallian demand function</strong>: insert Hicksian demand function to the expenditure function:
<span class="math display">\[\begin{equation}
q_i = h_i(v(p, x), p) \equiv d_i(p, x).
\end{equation}\]</span></li>
</ul>
</div>
<div id="starting-from-an-indirect-utility-function" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Starting from an Indirect Utility Function</h3>
<ul>
<li>It is almost equivalent to start from an indirect utility function.</li>
<li>An indirect utility function with the utility function is defined by:
<span class="math display">\[\begin{equation}
v(p, x) \equiv \max_{q} u(q), p&#39;q \le x.
\end{equation}\]</span></li>
<li>We can derive Marshallian demand function by Roy’s identity:
<span class="math display">\[\begin{equation}
q_i = \frac{- \partial v(p, x)/\partial p_i}{\partial v(p, x)/\partial x} \equiv d_i(p, x).
\end{equation}\]</span></li>
</ul>
</div>
<div id="expenditure-share-equation" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Expenditure Share Equation</h3>
<ul>
<li>Let’s start from an expenditure function <span class="math inline">\(e(p, x)\)</span>.</li>
<li>By Shepard’s lemma, we have:
<span class="math display">\[\begin{equation}
\frac{\partial \ln e(u, p)}{\partial \ln p_i} = \frac{\partial e(u, p)}{\partial p_i} \frac{p_i}{e(u, p)} = \frac{p_i q_i}{x} \equiv w_i.
\end{equation}\]</span></li>
<li>We call this an expenditure share equation.</li>
<li>The estimation is based on the share equations.</li>
</ul>
</div>
<div id="almost-ideal-demand-system-aids" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Almost Ideal Demand System (AIDS)</h3>
<ul>
<li>Based on <span class="citation">Deaton &amp; Muellbauer (<a href="#ref-Deaton1980">1980</a>)</span>.</li>
<li>See <span class="citation">Angus Deaton &amp; John Muellbauer (<a href="#ref-AngusDeaton1980">1980</a>)</span> for further reference.</li>
<li>Consider an expenditure function that satisfies the following useful conditions:
<ul>
<li>It allows aggregation (this motivation is less important in recent days).</li>
<li>It gives an arbitrary first-order approximation to any demand system.</li>
<li>It can satisfy the restrictions of utility maximization.</li>
<li>It can be used to test the restrictions of utility maximization.</li>
</ul></li>
</ul>
</div>
<div id="piglog-class" class="section level3">
<h3><span class="header-section-number">4.3.6</span> PIGLOG Class</h3>
<ul>
<li>PIGLOG (price-independent generalized logarithmic) class <span class="citation">(Muellbauer, <a href="#ref-Muellbauer1976">1976</a>)</span>.
<span class="math display">\[\begin{equation}
\ln e(u, p) = (1 - u) \ln a(p) + u\ln b(p),
\end{equation}\]</span>
where <span class="math inline">\(a(p)\)</span> and <span class="math inline">\(b(p)\)</span> are arbitrary linear homogeneous concave functions.</li>
<li>Consider households that differ in total income.</li>
<li>PIGLOC form ensures that the aggregate demand can be written in the same form where the total income is replaced with the sum of household total income.</li>
<li>The derivatives should be given free parameters for the model to be an arbitrary first-order approximation to any demand system.</li>
<li>In AIDS, we specify <span class="math inline">\(a(p)\)</span> and <span class="math inline">\(b(p)\)</span> as:
<span class="math display">\[\begin{equation}
\begin{split}
\ln a(p) &amp;\equiv a_0 + \sum_{k} \alpha_k \ln p_k + \frac{1}{2}\sum_{k} \sum_{j} \gamma_{kj}^* \ln p_k \ln p_j\\
\ln b(p) &amp;\equiv \ln a(p) + \beta_0  \prod_{k} p_k^{\beta_k}.
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="derive-the-share-equation-i" class="section level3">
<h3><span class="header-section-number">4.3.7</span> Derive the Share Equation I</h3>
<ul>
<li>By Roy’s identify, we can derive the associated share equation:
<span class="math display">\[\begin{equation}
w_i \equiv \frac{\partial \ln e(u, p)}{\partial \ln p_i} = \alpha_i + \sum_{j} \gamma_{ij} + \beta_i u \beta_0 \prod_{k} p_k^{\beta_k},
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\gamma_{ij} = \frac{1}{2}(\gamma_{ij}^* + \gamma_{ji}^*).
\end{equation}\]</span></li>
</ul>
</div>
<div id="derive-the-share-equation-ii" class="section level3">
<h3><span class="header-section-number">4.3.8</span> Derive the Share Equation II</h3>
<ul>
<li>Insert indirect utility function <span class="math inline">\(u = v(p, x)\)</span> to this to get:
<span class="math display">\[\begin{equation}
w_i = \alpha_i + \sum_{j} \gamma_{ij} \ln p_j + \beta_i \ln \frac{x}{P},
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\ln P \equiv  \alpha_0 + \sum_{k} \alpha_k \ln p_k + \frac{1}{2} \sum_{j} \sum_{k} \gamma_{kj} \ln p_k \ln p_j.
\end{equation}\]</span></li>
<li><span class="math inline">\(P\)</span> is a price index associated with the given preference.</li>
<li>With the specification of <span class="citation">Richard Stone (<a href="#ref-RichardStone1954">1954</a>)</span>, it becomes <span class="math inline">\(\ln P = \sum_{j} x_j \ln p_j\)</span>.</li>
<li>It can be used as an approximation.</li>
</ul>
</div>
<div id="specify-the-detail-ii" class="section level3">
<h3><span class="header-section-number">4.3.9</span> Specify the Detail II</h3>
<ul>
<li>It can satisfy the restrictions of utility maximization.</li>
<li>It can be used to test the restrictions of utility maximization.
<ul>
<li><span class="math inline">\(\sum_{j} x_j = 1\)</span>:
<span class="math display">\[\begin{equation}
\sum_{j} \alpha_j = 1, \sum_{j} \gamma_{jk} = 0, \sum_{j} \beta_j = 0.
\end{equation}\]</span></li>
<li><span class="math inline">\(e(u, p)\)</span> is linear homogeneous in <span class="math inline">\(p\)</span>:
<span class="math display">\[\begin{equation}
\sum_{j} \gamma_{ij} = 0.
\end{equation}\]</span></li>
<li>Symmetry:
<span class="math display">\[\begin{equation}
\gamma_{ij} = \gamma_{ji}.
\end{equation}\]</span></li>
</ul></li>
</ul>
</div>
<div id="estimation" class="section level3">
<h3><span class="header-section-number">4.3.10</span> Estimation</h3>
<ul>
<li>We can estimate parameters based on the share equations.</li>
<li>If we use aggregate data, the aggregate error term is correlated with the price vector.</li>
<li>Therefore, we need at least as many instrumental variables as the dimension of the price vector.</li>
<li>With valid instrumental variables, we can estimate the model with GMM.</li>
<li>If we use household-level data, the household-specific errors controlling for aggregate errors will not be correlated with the price vector if the price is determined in a competitive market.</li>
</ul>
</div>
<div id="from-product-space-approach-to-characteristics-space-approach" class="section level3">
<h3><span class="header-section-number">4.3.11</span> From Product Space Approach to Characteristics Space Approach</h3>
<ul>
<li>The framework up to here is called <strong>product space approach</strong> because the utility has been defined over a product space.</li>
<li>When there are <span class="math inline">\(J\)</span> goods, there are <span class="math inline">\(J^2\)</span> parameters for prices.</li>
<li>One way to resolve this issue is to introduce a priori knowledge about the preference.</li>
<li>For example, we can introduce a priori segmentation with separability.</li>
<li>It is hard to evaluate the effect of introducing new product.</li>
<li>Again, we have to a priori decide which segment/product is similar to the new product.</li>
<li>This leads us to the <strong>characteristics space approach</strong> <span class="citation">(Lancaster, <a href="#ref-Lancaster1966">1966</a>; Muth, <a href="#ref-Muth1966">1966</a>)</span>:
<ul>
<li>Consumption is an activity in which goods are inputs and in which the output is a collection of characteristics.</li>
<li>Utility ranks collections of characteristics and only to rank collections of goods indirectly through the characteristics that they possesses.</li>
<li>There are <span class="math inline">\(k = 1, \cdots, K\)</span> activities.</li>
<li>The activity <span class="math inline">\(y\)</span> requires to consume <span class="math inline">\(x = A y\)</span> products.</li>
<li>The activity <span class="math inline">\(y\)</span> generates <span class="math inline">\(z = B y\)</span> characteristics.</li>
<li>The budget constraint is <span class="math inline">\(p \cdot x \le 1\)</span>.</li>
<li>The utility is defined over the characteristics <span class="math inline">\(u(z)\)</span>.</li>
<li>The consumer’s problem is: <span class="math display">\[
\max_y u(z)
\]</span> s.t. <span class="math display">\[
p \cdot x \le 1, x = Ay, z = By, x, y, z \ge 0.
\]</span></li>
</ul></li>
<li>Then, only the dimension of characteristics matters and the value of new products can be evaluated by the contribution to the production of characteristics.</li>
<li>The early application includes <span class="citation">Rosen (<a href="#ref-Rosen1974">1974</a>)</span>, <span class="citation">Muellbauer (<a href="#ref-Muellbauer1974">1974</a>)</span>, <span class="citation">Gorman (<a href="#ref-Gorman1980">1980</a>)</span>.</li>
<li>The nonparametric analysis based on the reveals preference is <span class="citation">Blow, Browning, &amp; Crawford (<a href="#ref-Blow2008">2008</a>)</span>.</li>
</ul>
</div>
<div id="from-continuous-choice-approach-to-discrete-choice-approach" class="section level3">
<h3><span class="header-section-number">4.3.12</span> From Continuous Choice Approach to Discrete Choice Approach</h3>
<ul>
<li>The aggregate demand is a collection of choice across consumers and within consumers over time.</li>
<li>It makes sense to model individual choices and then aggregate rather than directly modeling the aggregate demand.</li>
<li>The resulting aggregate demand will satisfy restrictions that are consistent with the underlying consumer choice model.</li>
<li>If there is an interaction across choices, the aggregation is not trivial.</li>
<li>This is especially true when aggregating choices within consumers.</li>
<li>For now, assume that each choice is independent.</li>
</ul>
</div>
</div>
<div id="discrete-choice" class="section level2">
<h2><span class="header-section-number">4.4</span> Discrete Choice</h2>
<div id="discrete-choice-approach" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Discrete Choice Approach</h3>
<ul>
<li>Let <span class="math inline">\(u(q, z_i)\)</span> be the utility of a consumer over <span class="math inline">\(J + 1\)</span> dimensional consumption bundle <span class="math inline">\(q\)</span> characterized by consumer characteristics <span class="math inline">\(z_i\)</span>.</li>
<li>The consumer solves:
<span class="math display">\[\begin{equation}
V(p, y_i, z_i) = \max_{q}u(q, z_i), \text{   s.t.   } p&#39;q \le y_i.
\end{equation}\]</span></li>
<li>Alternative <span class="math inline">\(0\)</span> is an .</li>
<li>Normalize <span class="math inline">\(p_0 = 1\)</span>.</li>
<li>We call alternatives <span class="math inline">\(j = 1, \cdots, J\)</span> .</li>
<li>The choice space is restricted on:
<span class="math display">\[\begin{equation}
\begin{split}
Q = \{q:&amp; q_0 \in [0, M], q_j \in \{0, 1\}, j = 1, \cdots, J,\\
&amp; q_j q_k = 0, \forall j \neq k, j, k &gt; 0, M &lt; \infty\}.
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="discrete-choice-approach-1" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Discrete Choice Approach</h3>
<ul>
<li>The budget constraint reduces to:
<span class="math display">\[\begin{equation}
\begin{cases}
q_0 + p_j q_j = y &amp;\text{   if   } q_j = 1, j &gt; 0\\
q_0 = y &amp;\text{   otherwise}.
\end{cases}
\end{equation}\]</span></li>
<li>Hence,
<span class="math display">\[\begin{equation}
q_0 = y - \sum_{j = 1}^J p_j q_j.
\end{equation}\]</span></li>
</ul>
</div>
<div id="discrete-choice-approach-2" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Discrete Choice Approach</h3>
<ul>
<li>The utility maximization problem can be written as:
<span class="math display">\[\begin{equation}
V(p, y_i, z_i) = \max_{j = 0, 1, \cdots, j}  v_j(p_j, y_i, z_i),
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\begin{split}
&amp;v_j(p_j, y_i, z_i)\\
&amp; =
\begin{cases}
u(y_i - p_j, 0, \cdots, \underbrace{1}_{q_j}, \cdots, 0, z_i) &amp;\text{   if  }j &gt; 0,\\
u(y_i, 0, \cdots, 0, z_i) &amp;\text{   if   }j = 0,
\end{cases}
\end{split}
\end{equation}\]</span>
is called the .</li>
</ul>
</div>
<div id="characteristics-space-approach" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Characteristics Space Approach</h3>
<ul>
<li><p>Preference is defined over the characteristics of alternatives, <span class="math inline">\(x_j\)</span>:</p></li>
<li>Car: vehicle, engine power, model-year, car maker, etc.</li>
<li><p>PC: CPU power, number of cores, memory, HDD volume, etc.</p></li>
<li>The choice-specific indirect utility is a function of the characteristics of the alternative:
<span class="math display">\[\begin{equation}
\begin{split}
v_j(p_j, y_i, z_i) &amp;=u(y_i - p_j, 0, \cdots, \underbrace{1}_{q_j}, \cdots, 0, z_i)\\
&amp;= u^*(y_i - p_j, x_j, z_i)\\
&amp;\equiv v(p_j, x_j, y_i, z_i).
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="weak-separability-and-income-effect" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Weak Separability and Income Effect</h3>
<ul>
<li>We usually focus on a particular product category such as cars, PCs, cereals, detergents, and so on.</li>
<li>Assume that the preference is separable between the category in question and other categories.</li>
<li>Then, call the category in question inside goods.</li>
<li>The outside good captures the income effect of the choice in this category.</li>
</ul>
</div>
<div id="weak-separability-and-income-effect-1" class="section level3">
<h3><span class="header-section-number">4.4.6</span> Weak Separability and Income Effect</h3>
<ul>
<li>Thus, how the preference for the outside good is modeled determines how the individual income affects the choice.
<span class="math display">\[\begin{equation}
\begin{split}
&amp;u^*(y_i - p_j, x_j, z_i) = u^{**}(x_j, z_i) + \alpha(y_i - p_j).\\
&amp;u^*(y_i - p_j, x_j, z_i) = u^{**}(x_j, z_i) + \alpha \ln (y_i - p_j).
\end{split}
\end{equation}\]</span></li>
<li>In the first example, the income level does not affect the choice because the term <span class="math inline">\(\alpha y_i\)</span> is common and constant across choices (there is no income effect).</li>
<li>We often do not observe income of a consumer, <span class="math inline">\(y_i\)</span>.</li>
<li>Remember that the price of a product enters because we here consider <strong>indirect</strong> utility function.</li>
</ul>
</div>
<div id="utility-function-normalization" class="section level3">
<h3><span class="header-section-number">4.4.7</span> Utility Function Normalization</h3>
<ul>
<li>The <strong>location</strong> of utility function is often normalized by setting:
<span class="math display">\[\begin{equation}
u(y^*, 0, \cdots, 0, z^*) = 0,
\end{equation}\]</span>
for certain choice of <span class="math inline">\((y^*, z^*)\)</span>.</li>
</ul>
</div>
<div id="aggregation-of-the-individual-demand" class="section level3">
<h3><span class="header-section-number">4.4.8</span> Aggregation of the Individual Demand</h3>
<ul>
<li>Let <span class="math inline">\(q(p, x, y_i, z_i) = \{q_j(p, x, y_i, z_i)\}_{j = 0, \cdots, J}\)</span> be the demand function of consumer <span class="math inline">\(i\)</span>, that is:
<span class="math display">\[\begin{equation}
q_j(p, x, y_i, z_i) = 1 \Leftrightarrow j = \text{argmax}_{j = 0, 1, \cdots, j}  v(p_j, x_j, y_i, z_i).
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(f(y, z)\)</span> be the joint distribution of the income and other consumer characteristics.</li>
<li>The aggregate demand for good <span class="math inline">\(j\)</span> is:
<span class="math display">\[\begin{equation}
D_j(p, x_j; f) \equiv N \int  q_j(p, x_j, y, z) f(y, z) dy dz,
\end{equation}\]</span>
where <span class="math inline">\(N\)</span> is the population.</li>
</ul>
</div>
<div id="horizontal-product-differentiation" class="section level3">
<h3><span class="header-section-number">4.4.9</span> Horizontal Product Differentiation</h3>
<ul>
<li><strong>horizontal product differentiation</strong>: consumers do not agree on the ranking of the choices.</li>
<li>There are two convenience stores <span class="math inline">\(j = 1, 2\)</span> on a street <span class="math inline">\([0, 1]\)</span>.</li>
<li>Let <span class="math inline">\(z_i = L_i\)</span>, the location of consumer <span class="math inline">\(i\)</span> and <span class="math inline">\(x_j = L_j\)</span>, the location of the choice on a street <span class="math inline">\([0, 1]\)</span> with <span class="math inline">\(L_1 &lt; L_2\)</span>.</li>
<li>A consumer has a preference such that:
<span class="math display">\[\begin{equation}
v_{ij} \equiv v(p_j, x_j, y_i, z_i) \equiv s - t |L_i - L_j| - p_j.
\end{equation}\]</span></li>
</ul>
</div>
<div id="horizontal-product-differentiation-1" class="section level3">
<h3><span class="header-section-number">4.4.10</span> Horizontal Product Differentiation</h3>
<ul>
<li>Suppose that the prices are low enough that entire consumers on the street are willing to buy either from the stores.</li>
<li>Consumer <span class="math inline">\(i\)</span> buys from store <span class="math inline">\(1\)</span> if and only if:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;v(p_1, x_1, y_i, z_i) \ge v(p_2, x_2, y_i, z_i)\\
&amp;\Leftrightarrow s - t |L_i - L_1| - p_1 \ge s - t |L_i - L_2|- p_2\\
&amp;\Leftrightarrow L_i \le \frac{p_2 - p_1}{2 t} + \frac{L_1 + L_2}{2} \equiv \overline{L}_1(p_1, p_2).
\end{split}
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(f(L_i)\)</span> be <span class="math inline">\(U[0, 1]\)</span>. Then, the aggregate demand for store 1 is:
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_1(p, L_1, L_2) = N \int_{0}^{\overline{L}_1(p_1, p_2)} d L_i = N\overline{L}_1(p_1, p_2).
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="vertical-product-differentiation" class="section level3">
<h3><span class="header-section-number">4.4.11</span> Vertical Product Differentiation</h3>
<ul>
<li><strong>Vertical product differentiation</strong>: Consumers agree on the ranking of the choices. Consumers can have different willingness to pay.</li>
<li><span class="citation">Timothy F Bresnahan (<a href="#ref-Bresnahan1987">1987</a>)</span> analyzed automobile demand with this framework.</li>
<li>There are <span class="math inline">\(J\)</span> goods and consumer <span class="math inline">\(i\)</span> has a utility such as:
<span class="math display">\[\begin{equation}
v_{ij} \equiv v(p_j, x_j, y_i, z_i) = z_i x_j - p_j,
\end{equation}\]</span>
where <span class="math inline">\(x_j\)</span> is a quality of product <span class="math inline">\(j\)</span> and <span class="math inline">\(z_i\)</span> is the consumer’s willingness to pay for the quality with <span class="math inline">\(x_j &lt; w_{j + 1}\)</span>.</li>
<li>Consumers’ problem is:
<span class="math display">\[\begin{equation}
\max\{0, z_i x_1 - p_1, \cdots, z_i x_j - p_J \}.
\end{equation}\]</span></li>
</ul>
</div>
<div id="vertical-product-differentiation-1" class="section level3">
<h3><span class="header-section-number">4.4.12</span> Vertical Product Differentiation</h3>
<ul>
<li>Consumer <span class="math inline">\(i\)</span> prefers good <span class="math inline">\(j + 1\)</span> to good <span class="math inline">\(j\)</span> if and only if:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;v(p_{j + 1}, w_{j + 1}, y_i, z_i) \ge v(p_j, x_j, y_i, z_i)\\
&amp;\Leftrightarrow z_i w_{j + 1} - p_{j + 1} \ge z_i x_j - p_j\\
&amp;\Leftrightarrow z_i \ge \frac{p_{j + 1} - p_j}{w_{j + 1} - x_j} \equiv \Delta_j.
\end{split}
\end{equation}\]</span></li>
<li>So consumer <span class="math inline">\(i\)</span> purchases good <span class="math inline">\(j\)</span> if and only if <span class="math inline">\(z_i \in [\Delta_{j - 1}, \Delta_j)\)</span> and buys nothing if:
<span class="math display">\[\begin{equation}
z_i \le \Delta_0 \equiv \min\{p_1/x_1, \cdots p_J/x_j\}.
\end{equation}\]</span></li>
<li>Letting <span class="math inline">\(F(z)\)</span> be the distribution function of <span class="math inline">\(z\)</span>, the aggregate demand for good <span class="math inline">\(j\)</span> is:
<span class="math display">\[\begin{equation}
\sigma_j(p, x, z) = N[F(\Delta_{j}) - F(\Delta_{j - 1})].
\end{equation}\]</span></li>
</ul>
</div>
<div id="econometric-models" class="section level3">
<h3><span class="header-section-number">4.4.13</span> Econometric Models</h3>
<ul>
<li>So far there was no econometrics.</li>
<li>Next we define what are observable and unobservable, and what are known and unknown.</li>
<li>Then consider how to identify and estimate the model.</li>
</ul>
</div>
<div id="multinomial-logit-model-preference-shock" class="section level3">
<h3><span class="header-section-number">4.4.14</span> Multinomial Logit Model: Preference Shock</h3>
<ul>
<li>This originates at <span class="citation">Mcfadden (<a href="#ref-Mcfadden1974">1974</a>)</span>.</li>
<li>See <span class="citation">Train (<a href="#ref-Train2009">2009</a>)</span> for reference.</li>
<li>Suppose that there is some unobservable component in consumer characteristics.</li>
<li>In reality, consumers choice change somewhat randomly.</li>
<li>Let’s capture such a <strong>preference shock</strong> by consider the following model:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i) + \epsilon_{ij},
\end{equation}\]</span>
where I assumed that there is no other <span class="math inline">\(z_i\)</span> for exposition simplicity, with some random vector:
<span class="math display">\[\begin{equation}
\epsilon_i \equiv (\epsilon_{i0}, \cdots, \epsilon_{iJ})&#39; \sim G.
\end{equation}\]</span></li>
<li>At this point, <span class="math inline">\(G\)</span> can be any distribution and the shocks can be dependent across <span class="math inline">\(j\)</span> within <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(p, x, y_i, z_i\)</span> are <strong>observed</strong> but <span class="math inline">\(\epsilon_{ij}\)</span> are <strong>unobserved</strong>.</li>
<li>When the realization of the preference shock is given, the consumer choice is: <span class="math display">\[
q_j(p, x, y_i, z_i, \epsilon_{i}) \equiv 1\{j = \text{argmax}_{k = 0, \cdots, J} v(p_k, x_k, y_i, z_i) + \epsilon_{ik}\}
\]</span> for <span class="math inline">\(k = 0, \cdots, J\)</span>.</li>
<li>The <strong>choice probability</strong> as observed by econometrician is: <span class="math display">\[
\sigma_j(p, x, y_i, z_i) \equiv \int q_j(p, x, y_i, z_i, \epsilon_{i}) dG(\epsilon_i).
\]</span></li>
</ul>
</div>
<div id="multinomial-logit-model-distributional-assumption" class="section level3">
<h3><span class="header-section-number">4.4.15</span> Multinomial Logit Model: Distributional Assumption</h3>
<ul>
<li><p>Now assume the followings:</p></li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> are independent across <span class="math inline">\(j\)</span>: <span class="math inline">\(G(\epsilon_i) = \prod_{j = 0, \cdots, J} G_j(\epsilon_{ij})\)</span>.</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span> are identical across <span class="math inline">\(j\)</span>: <span class="math inline">\(G_j(\epsilon_{ij}) = \overline{G}(\epsilon_{ij})\)</span>.</li>
<li><span class="math inline">\(\overline{G}\)</span> is a type-I extreme value.</li>
<li><span class="math inline">\(\rightarrow\)</span> The density <span class="math inline">\(g(\epsilon_{ij}) = \exp[-\exp(-\epsilon_{ij}) - \epsilon_{ij}]\)</span>.</li>
<li>This is called the (homoskedastic) <strong>multinomial logit model</strong>.</li>
<li>Setting the variance of <span class="math inline">\(\epsilon_{ij}\)</span> at 1 for some <span class="math inline">\(j\)</span> is a <strong>scale</strong> normalization.</li>
<li>By dropping some of the assumptions, we can have heteroskedastic multinomial logit model, generalized extreme value model, and so on.</li>
<li><p>Another popular distribution assumption is to assume a multivariate normal distribution of <span class="math inline">\(\epsilon_i\)</span>. This case is called the <strong>multinomial probit model</strong>.</p></li>
</ul>
</div>
<div id="multinomial-logit-model-choice-probability" class="section level3">
<h3><span class="header-section-number">4.4.16</span> Multinomial Logit Model: Choice Probability</h3>
<ul>
<li>The  of consumer <span class="math inline">\(i\)</span> of good <span class="math inline">\(j\)</span> is:
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_j(p, x, y_i, z_i) &amp; \equiv \mathbb{P}\{j = \text{argmax}_{k = 0, 1, \cdots, J} v(p, x_k, y_i, z_i) + \epsilon_{ik}  \}\\
&amp;=\mathbb{P}\{v(p, x_j, y_i, z_i) -  v(p_k, x_k, y_i, z_i) \ge \epsilon_{ik} - \epsilon_{ij}, \forall k \neq j\}\\
&amp; = \text{...after some algebra: leave as an exercise...}\\
&amp;= \frac{\exp[v(p_j, x_j, y_i, z_i) ]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i)] }.
\end{split}
\end{equation}\]</span></li>
<li>For example, if:
<span class="math display">\[\begin{equation}
v(p_k, x_k, y_i, z_i) = \beta_i&#39;x_k + \alpha_i (y_i - p_k),
\end{equation}\]</span></li>
</ul>
<span class="math display">\[\begin{equation}
\begin{pmatrix}
\beta_i \\
\alpha_i
\end{pmatrix}
= 
\begin{pmatrix}
\beta_0 \\
\alpha_0
\end{pmatrix}
+
\begin{pmatrix}
\Gamma\\
\pi&#39;
\end{pmatrix}
 z_i.
\end{equation}\]</span>
<ul>
<li>Then, we have:
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_{j}(p, x, y_i, z_i) &amp;= \frac{\exp[\beta_i&#39;x_j + \alpha_i (y_i - p_j) ]}{\sum_{k = 0}^J \exp[\beta_i&#39;x_k + \alpha_i (y_i - p_k) ]}\\
&amp;= \frac{\exp[\beta_i&#39;x_j - \alpha_i p_j]}{\sum_{k = 0}^J \exp[\beta_i&#39;x_k - \alpha_i p_k]}
\end{split}
\end{equation}\]</span></li>
<li>If we normalize the characteristics vector so that <span class="math inline">\(w_0 = 0\)</span> holds for the outside option, it becomes: <span class="math display">\[
\sigma_{j}(p, x, y_i, z_i) = \frac{\exp[\beta_i&#39;x_j - \alpha_i p_j]}{1 + \sum_{k = 1}^J \exp[\beta_i&#39;x_k - \alpha_i p_k]}
\]</span></li>
</ul>
</div>
<div id="multinomial-logit-model-inclusive-value" class="section level3">
<h3><span class="header-section-number">4.4.17</span> Multinomial Logit Model: Inclusive Value</h3>
<ul>
<li>The expected utility for consumer <span class="math inline">\(i\)</span> before the preference shocks are drawn under multinomial logit model is given by:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\mathbb{E}\{\max_{j = 0, \cdots, J} v(p_j, x_j, y_i, z_i) + \epsilon_{ij}\} \\
&amp;= \text{   ...after some algebra: leave as an exercise...}\\
&amp;= \ln \Bigg\{\sum_{j = 0}^J \exp[v(p_j, x_j, y_i, z_i)] \Bigg\} + constant.
\end{split} 
\end{equation}\]</span></li>
<li>This is sometimes called the <strong>inclusive value</strong> of the choice set.</li>
</ul>
</div>
<div id="maximum-likelihood-estimation-of-multinomial-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.18</span> Maximum Likelihood Estimation of Multinomial Logit Model</h3>
<ul>
<li>Suppose we observe a sequence of income <span class="math inline">\(y_i\)</span>, consumer characteristics <span class="math inline">\(z_i\)</span>, choice <span class="math inline">\(q_{i}\)</span>, product characteristics <span class="math inline">\(x_j\)</span> and price <span class="math inline">\(p_j\)</span>.</li>
<li><span class="math inline">\(q_i = (q_{i0}, \cdots, q_{iJ})&#39;\)</span> and <span class="math inline">\(q_{ij} = 1\)</span> if <span class="math inline">\(j\)</span> is chosen and <span class="math inline">\(0\)</span> otherwise.</li>
<li>The parameter of interest is the mean indirect utility function <span class="math inline">\(v\)</span>.</li>
<li>Then the log likelihood of <span class="math inline">\(\{q_i\}_{i = 1}^N\)</span> conditional on <span class="math inline">\(\{y_i, z_i\}_{i = 1}^N\)</span> and <span class="math inline">\(\{x_j,p_j\}_{j = 1}^J\)</span> is:
<span class="math display">\[\begin{equation}
\begin{split}
l(v; q, y, z, w) &amp;= \sum_{i = 1}^N \ln \mathbb{P}\{q_i = q(p, x, y_i, z_i)|p, x, y_i, z_i\}\\
&amp; = \sum_{i = 1}^N \log \Bigg\{ \prod_{j = 0}^{J} \sigma_{j}(p, x, y_i, z_i)^{q_{ij}} \Bigg\}\\
&amp;= \sum_{i = 1}^N \sum_{j = 0}^J \log \sigma_{j}(p, x, y_i, z_i)^{q_{ij}}.
\end{split}
\end{equation}\]</span></li>
<li>We can estimate the parameters by finding parameters that maximize the log likelihood.</li>
</ul>
</div>
<div id="nonlinear-least-square-estimation-of-multinomial-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.19</span> Nonlinear Least Square Estimation of Multinomial Logit Model</h3>
<ul>
<li>The multinomial logit model can be estimated by nonlinear least square method as well.</li>
<li>Suppose that the share of product <span class="math inline">\(j\)</span> among consumers with characteristics <span class="math inline">\(z\)</span> and income <span class="math inline">\(y\)</span> was:
<span class="math display">\[\begin{equation}
\sigma_j(p, x, y, z).
\end{equation}\]</span></li>
<li>Note that:
<span class="math display">\[\begin{equation}
\begin{split}
\ln \sigma_{j}(p, x, y, z)  &amp;= \ln \Bigg\{ \frac{\exp[v(p_j, x_j, y, z) ]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y, z)] }  \Bigg\}\\
&amp;= v(p_j, x_j, y, z) - \ln\Bigg\{ \sum_{k = 0}^J \exp[v(p_k, x_k, y, z)]  \Bigg\}.
\end{split}
\end{equation}\]</span></li>
<li>Moreover, because of the location normalization of the utility function,
<span class="math display">\[\begin{equation}
\sigma_{0}(p, x, y, z) = \frac{1}{\sum_{k = 0}^J \exp[v(p_j, x_k, y, z)] }.
\end{equation}\]</span></li>
<li>Hence,
<span class="math display">\[\begin{equation}
\ln \sigma_{j}(p, x, y, z) - \ln \sigma_{0}(p, x, y, z) = v(p, x_j, y, z).
\end{equation}\]</span></li>
<li>The left-hand variables are observed in the data.</li>
<li>Let <span class="math inline">\(s_j(y, z)\)</span> be the share of product <span class="math inline">\(j\)</span> among consumers with characteristics <span class="math inline">\(z\)</span> and income <span class="math inline">\(y\)</span> <strong>in the data</strong>.</li>
<li>This can be calculated from the consumer-level data.</li>
<li>More importantly, if there is the total sales data for each demographic, we can use this approach.</li>
<li>Then, we can estimate the parameter by NLLS such that:
<span class="math display">\[\begin{equation}
\min \sum_{(y, z)} \sum_{j = 1}^J \{\ln[s_{j}(y, z)/s_{0}(y, z)] - v(p_j, x_j, y, z)\}^2.
\end{equation}\]</span></li>
<li>If <span class="math inline">\(v\)</span> is linear in parameter, it is the ordinal least squares:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_m) = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span></li>
</ul>
<span class="math display">\[\begin{equation}
\ln[s_{j}(y, z)/s_{0}(y, z)] = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span>
</div>
<div id="iia-problem" class="section level3">
<h3><span class="header-section-number">4.4.20</span> IIA Problem</h3>
<ul>
<li>Multinomial logit problem is intuitive and easy to implement.</li>
<li>However, there are several problems in the model.</li>
<li>The most important problem is the  problem.</li>
<li>Notice that:
<span class="math display">\[\begin{equation}
\frac{\sigma_j(p, x, y, z)}{\sigma_{k}(p, x, y, z)} = \frac{\exp[v(p_j, x_j, y, z)]}{\exp[v(p_k, x_k, y, z)]}.
\end{equation}\]</span></li>
<li>The ratio of choice probabilities between two alternatives depend only on the mean indirect utility of these two alternatives and <strong>independent of irrelevant alternatives (IIA)</strong>.</li>
<li>Why is this a problem?</li>
</ul>
</div>
<div id="blue-bus-and-red-bus-problem" class="section level3">
<h3><span class="header-section-number">4.4.21</span> Blue Bus and Red Bus Problem</h3>
<ul>
<li>Suppose that you can go to a town by bus or by train.</li>
<li>Half of commuters use a bus and the other half use a train.</li>
<li>The existing bus was blue. Now, the county introduced a red bus, which is identical to the existing blue bus.</li>
<li>No one take care of the color of bus. So the mean indirect utility of blue bus and red bus are equal.</li>
<li>What is the new share across blue bus, red bus, and train?</li>
<li>IIA <span class="math inline">\(\to\)</span> share of blue bus = share of train.</li>
<li>Buses are identical <span class="math inline">\(\to\)</span> share of blue bus = share of red bus.</li>
<li>Therefore, shares have to be 1/3, respectively.</li>
<li>But shouldn’t it be that train keeps half share and bus have half share in total?</li>
</ul>
</div>
<div id="restrictive-price-elasticity" class="section level3">
<h3><span class="header-section-number">4.4.22</span> Restrictive Price Elasticity</h3>
<ul>
<li>IIA property restrict price elasticities in an unfavorable manner.</li>
<li>This is a serious problem because the main purpose for us to estimate demand functions is to identify the price elasticity.</li>
<li>Let <span class="math inline">\(v(p_j, x_j, y, z) = \beta_z&#39;x_j - \alpha_z p_j\)</span>. Then, we have:
<span class="math display">\[\begin{equation}
e_{jk} =
\begin{cases}
-\alpha p_{j} (1 - \sigma_j(p, x, y, z)) &amp;\text{   if   } k = j\\
\alpha p_{k} \sigma_k(p_k, x_k, y, z) &amp;\text{   if   } k \neq j.
\end{cases}
\end{equation}\]</span></li>
<li>The price elasticity is completely determined by the existing choice probabilities of the relevant alternatives.</li>
<li>Suppose that there are coca cola, Pepsi cola, and a coffee.</li>
<li>The shares were 1/2, 1/6, 1/3, respectively.</li>
<li>Suppose that the price of coca cola increased.</li>
<li>We expect that they instead purchase Pepsi cola because Pepsi cola is more similar to coca cola than coffee.</li>
<li>However, according to the previous result, twice more consumers substitute to coffee rather than to Pepsi cola.</li>
</ul>
</div>
<div id="monotonic-inclusive-value" class="section level3">
<h3><span class="header-section-number">4.4.23</span> Monotonic Inclusive Value</h3>
<ul>
<li>Suppose that there is a good whose mean indirect utility is <span class="math inline">\(v\)</span>.</li>
<li>The inclusive value for this choice set is <span class="math inline">\(\ln[1 + \exp(v)]\)</span>.</li>
<li>Suppose that we put <span class="math inline">\(J\)</span> same goods on the shelf and consumer can choose any of them.</li>
<li>The inclusive value is <span class="math inline">\(\ln[1 + J \exp(v)]\)</span>.</li>
<li>We just added the same goods. But the expected utility of consumer increases monotonically in the number of alternatives.</li>
</ul>
</div>
<div id="the-source-of-the-problem" class="section level3">
<h3><span class="header-section-number">4.4.24</span> The Source of the Problem</h3>
<ul>
<li><strong>The source of the problem is that there is no correlation in the preference shock across products</strong>.</li>
<li>When the preference shock to coca cola is high, the preference shock to Pepsi cola should be high, while the preference shock to coffee should be relatively independent.</li>
<li>Because the expected value of the maximum of the preference shocks increases according to the number of alternatives, the inclusive value becomes increasing in the number of alternatives.</li>
<li>However, the preference shocks should be the same for the same good. Then, the the expected value of the maximum of the preference shock should not increase even if we add the same products on the shelf.</li>
</ul>
</div>
<div id="correlation-in-preference-shocks" class="section level3">
<h3><span class="header-section-number">4.4.25</span> Correlation in Preference Shocks</h3>
<ul>
<li>Therefore, the preference shock should be such that: preference shocks between two alternative should be more correlated when they are closer in the characteristics space.</li>
<li>So we have to allow the covariance matrix of the preference shock to be free parameters.</li>
<li>If we allow flexible covariance matrix, the curse of dimensionality in the number of alternatives comes back: The dimensionality of the covariance matrix is <span class="math inline">\(J^2\)</span>.</li>
<li>Another way is to remove <span class="math inline">\(\epsilon_{ij}\)</span>: it is called a <strong>pure characteristics model</strong> <span class="citation">(S. Berry &amp; Pakes, <a href="#ref-Berry2007">2007</a>)</span>.</li>
<li>But the pure characteristics model is computationally not straightforward.</li>
<li>We explore the way of introducing mild correlation across similar products in the preference shocks.</li>
</ul>
</div>
<div id="observed-and-unobserved-consumer-heterogeneity" class="section level3">
<h3><span class="header-section-number">4.4.26</span> Observed and Unobserved Consumer Heterogeneity</h3>
<ul>
<li>Consider beverage demand and let <span class="math inline">\(x_j = \text{carbonated}_j\)</span> and <span class="math inline">\(z_i = \text{teenager}_i\)</span>.</li>
<li>Suppose that the mean indirect utility is:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i) = \beta_i (\text{carbonated})_j - \alpha_i p_j,
\end{equation}\]</span></li>
</ul>
<span class="math display">\[\begin{equation}
\beta_i = 0.1 + 0.2 \cdot (\text{carbonated})_i.
\end{equation}\]</span>
<ul>
<li>The mean utility of a carbonated drink for a teenager is 0.3 but only 0.1 for others.</li>
<li>When coca cola was not available, teenager will substitute more to Pepsi cola than non-teenagers.</li>
<li><p>IIA holds at the market-segment level but not at the market level.</p></li>
<li>How to avoid IIA at the market-segment level?: Introduce unobserved consumer heterogeneity.</li>
<li>Suppose that the mean indirect utility is:
<span class="math display">\[\begin{equation}
\beta_i = 0.1 + 0.2 \cdot (\text{carbonated})_i + \nu_i.
\end{equation}\]</span></li>
<li>Consumers with high <span class="math inline">\(\nu_i\)</span> values carbonated drinks more than those with low <span class="math inline">\(\nu_i\)</span> values.</li>
<li>When coca cola was not available, consumers with high <span class="math inline">\(\nu_i\)</span> will substitute more to Pepsi cola than those with low <span class="math inline">\(\nu_i\)</span> values.</li>
<li><p>IIA holds at the market-segment-<span class="math inline">\(\nu\)</span> level but not at the market-segment level.</p></li>
<li><p>In the above example, “<span class="math inline">\(0.2 \cdot (\text{carbonated})_i\)</span>” captures the consumer heterogeneity by observed characteristics and “<span class="math inline">\(\nu_i\)</span>” by unobserved characteristics.</p></li>
</ul>
</div>
<div id="mixed-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.27</span> Mixed Logit Model</h3>
<ul>
<li>Suppose that the mean indirect utility is:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i) = \beta_i&#39; x_j - \alpha_i p_j,
\end{equation}\]</span>
with
<span class="math display">\[\begin{equation}
(\beta_i, \alpha_i) \sim f(\beta_i, \alpha_i|y_i, z_i).
\end{equation}\]</span></li>
<li>If <span class="math inline">\(\epsilon_{ij}\)</span> is drawn i.i.d. from type-I extreme value distribution, the choice probability of good <span class="math inline">\(j\)</span> by consumer <span class="math inline">\(i\)</span> conditional on <span class="math inline">\(p, x, y_i, z_i\)</span> is:
<span class="math display">\[\begin{equation}
s_{j}(p, x, y_i, z_i) = \int_{\beta_i, \alpha_i} \frac{\exp[v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i)]}{\sum_{k = 0}^J \exp[v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i)]} f(\beta_i, \alpha_i|y_i, z_i) d\beta_i d\alpha_i.
\end{equation}\]</span></li>
<li>This is called the <strong>mixed-logit model</strong>.</li>
<li>If the distribution of <span class="math inline">\(\epsilon_{ij}\)</span> is different, it is no longer mixed logit.</li>
<li>Conditional on <span class="math inline">\((\beta_i, \alpha_i)\)</span> the choice probability is written in the same way with the multinomial logit model.</li>
<li><span class="math inline">\(\beta_i, \alpha_i\)</span> are marginal out, because econometrician does not observe them.</li>
</ul>
</div>
<div id="mixed-logit-model-parametric-assumptions" class="section level3">
<h3><span class="header-section-number">4.4.28</span> Mixed Logit Model : Parametric Assumptions</h3>
<ul>
<li>It is often assumed that:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i) = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span></li>
<li><span class="citation">McFadden &amp; Train (<a href="#ref-Mcfadden2000">2000</a>)</span> showed that any discrete choice models that are consistent with the random utility maximization can be arbitrarily closely approximated by this class of mixed-logit model.</li>
<li>The distribution of <span class="math inline">\(\beta_i\)</span> and <span class="math inline">\(\alpha_i\)</span> is often assumed to be:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\beta_i = \beta_0 + \Gamma z_i + \Sigma \nu_i,\\
&amp;\alpha_i = \alpha_0 + \pi&#39; z_i + \Omega \upsilon_i,
\end{split}
\end{equation}\]</span>
where <span class="math inline">\(\nu_i\)</span> and <span class="math inline">\(\upsilon_i\)</span> are i.i.d. standard normal random vectors.</li>
</ul>
</div>
<div id="mixed-logit-model-iia" class="section level3">
<h3><span class="header-section-number">4.4.29</span> Mixed Logit Model: IIA</h3>
<ul>
<li>There is no IIA at the market-segment level:
<span class="math display">\[\begin{equation}
\frac{\sigma_{j}(p, x, y, z)}{\sigma_{l}(p, x, y_i, z_i)} = \frac{\int_{\beta_i, \alpha_i} \frac{\exp[v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i)]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i, \beta_i, \alpha_i)]} f(\beta_i, \alpha_i|y_i) d\beta_i d\alpha_i}{\int_{\beta_i, \alpha_i} \frac{\exp[v(p_l, x_l, y_i, z_i, \beta_i, \alpha_i)]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i, \beta_i, \alpha_i)]} f(\beta_i, \alpha_i|y_i) d\beta_i d\alpha_i}.
\end{equation}\]</span></li>
<li>The share ratio depends on the price and characteristics of all the other products.</li>
</ul>
</div>
<div id="mixed-logit-moel-price-elasticities" class="section level3">
<h3><span class="header-section-number">4.4.30</span> Mixed Logit Moel: Price Elasticities</h3>
<ul>
<li>Let:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i) = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span></li>
<li>The price elasticities of the choice probabilities conditional on <span class="math inline">\(p, x, y_i, z_i\)</span> is:
<span class="math display">\[\begin{equation}
e_{jk} = 
\begin{cases}
-\frac{p_j}{\sigma_j} \int \alpha_i \sigma_{ij}(1 - \sigma_{ij})f(\beta_i, \alpha_i|y_i, z_i) d\beta_i d\alpha_i &amp;\text{   if   } j = k\\
\frac{p_k}{\sigma_j} \int \alpha_i \sigma_{ij} \sigma_{ik} f(\beta_i, \alpha_i|y_i, z_i) d\beta_i d\alpha_i &amp;\text{   otherwise},
\end{cases} 
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\sigma_{ij} = \frac{\exp(\beta_i&#39;x_j - \alpha_i p_j)}{\sum_{k = 0}^J \exp(\beta_i&#39;x_k - \alpha_i p_k)}.
\end{equation}\]</span></li>
<li>The price elasticity depends on the density of unobserved consumer types.</li>
</ul>
</div>
<div id="simulated-maximum-likelihood-estimation-of-the-mixed-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.31</span> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</h3>
<ul>
<li>The choice probability of the mixed logit model is an integration of the multinomial logit choice probability.</li>
<li>This is not derived analytically in general.</li>
<li>We can use simulation to evaluate the choice probability:</li>
<li>Draw <span class="math inline">\(R\)</span> values of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\{\beta^r, \alpha^r \}_{r = 1}^R\)</span>.</li>
<li>Compute the multinomial choice probabilities associated with <span class="math inline">\((\beta^r, \alpha^r)\)</span> for each <span class="math inline">\(r = 1, \cdots, R\)</span>.</li>
<li>Approximate the choice probability with the mean of the simulated multinomial choice share:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) \approx \hat{\sigma}_{j}(p, x, y_i, z_i) \equiv \frac{1}{R} \sum_{r = 1}^R  \frac{\exp[v(p_j, x_j, y_i, z_i, \beta^r, \alpha^r)]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i, \beta^r, \alpha^r)]}.
\end{equation}\]</span></li>
<li>This is one of the numerical integration: <strong>Monte Carlo integration</strong>.</li>
<li>Another approach is to use <strong>quadrature</strong>. See <span class="citation">Judd (<a href="#ref-Judd1998">1998</a>)</span> for reference.</li>
</ul>
</div>
<div id="simulated-maximum-likelihood-estimation-of-the-mixed-logit-model-1" class="section level3">
<h3><span class="header-section-number">4.4.32</span> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</h3>
<ul>
<li>There are <span class="math inline">\(t = 1, \cdots, T\)</span> markets and there <span class="math inline">\(i = 1, \cdots, N\)</span> consumers in each market.</li>
<li>Let <span class="math inline">\(\mathcal{J}_t\)</span> be the set of products that are available in market <span class="math inline">\(t\)</span>.</li>
<li>Suppose that we observe income <span class="math inline">\(y_{it}\)</span>, characteristics <span class="math inline">\(z_{it}\)</span>, and choice <span class="math inline">\(q_{it}\)</span> for each consumer in a market.</li>
<li>Suppose that we observe product characteristics <span class="math inline">\(x_{jt}\)</span> and price <span class="math inline">\(p_{jt}\)</span> of each product in each market.</li>
<li>The simulated conditional log likelihood is:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\sum_{i = 1}^N \sum_{t = 1}^T \ln \mathbb{P}\{q_{it}\\
&amp;= q(p_t, w_t, y_{it}, z_{it})|p_t, w_t, y_{it}, z_{it}\} \approx \sum_{i = 1}^N \ln \Bigg\{ \prod_{j \in \mathcal{J}_t \cup \{0\}} \hat{\sigma}_{j}(p_t, w_t, y_{it}, z_{it})^{q_{itj}} \Bigg\}.
\end{split}
\end{equation}\]</span></li>
<li>We find parameters that maximize the simulated conditional log likelihood.</li>
</ul>
</div>
<div id="simulated-non-linear-least-square-estimation-of-the-mixed-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.33</span> Simulated Non-linear Least Square Estimation of the Mixed Logit Model</h3>
<ul>
<li>Suppose that we only know the sales or share at the market-segment level.</li>
<li>That is, we only observe the share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> among consumers of characteristics <span class="math inline">\(z\)</span> and income <span class="math inline">\(y\)</span>, <span class="math inline">\(s_{jt}(y, z)\)</span>.</li>
<li>Then we can estimate the parameter by:
<span class="math display">\[\begin{equation}
\min \sum_{t = 1}^T \sum_{j \in \mathcal{J}_t \cup \{0\}} \sum_{(y, z) \in \mathcal{Y} \times \mathcal{Z}} \{s_{jt}(y, z) - \hat{\sigma}_{j}(p_t, w_t, y, z)\}^2.
\end{equation}\]</span></li>
</ul>
</div>
<div id="nested-logit-model-a-special-case-of-mixed-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.34</span> Nested Logit Model: A Special Case of Mixed Logit Model</h3>
<ul>
<li>Let <span class="math inline">\(w_{j1}, \cdots, w_{jG}\)</span> be the indicator of product category, i.e., <span class="math inline">\(w_{jg}\)</span> takes value 1 if good <span class="math inline">\(j\)</span> belong to category <span class="math inline">\(g\)</span> and 0 otherwise.</li>
<li>e.g., car category = {Sports, Luxury, Large, Midsize, Small}.</li>
<li>We have:
<span class="math display">\[\begin{equation}
v(p, x_j, y_i, z_i) = \beta&#39;x_j - \alpha_i p_j + \sum_{g = 1}^G \zeta_{ig} w_{jg} + \epsilon_{ij}.
\end{equation}\]</span></li>
<li>If <span class="math inline">\(\zeta_{it}\)</span> takes high value, the consumer attaches higher value to the category.</li>
<li>When a product in category <span class="math inline">\(g\)</span> was not available, consumers with high <span class="math inline">\(\zeta_{ig}\)</span> will substitute more to the other products in the same category than consumers with low <span class="math inline">\(\zeta_{ig}\)</span>.</li>
</ul>
</div>
<div id="nested-logit-model-distributional-assumption" class="section level3">
<h3><span class="header-section-number">4.4.35</span> Nested Logit Model: Distributional Assumption</h3>
<ul>
<li>Let
<span class="math display">\[\begin{equation}
\varepsilon_{ij} \equiv \sum_{g = 1}^G \zeta_{ig} w_{jg} + \epsilon_{ij}.
\end{equation}\]</span></li>
<li>Under certain distributional assumption on <span class="math inline">\(\zeta_{ig}\)</span> and <span class="math inline">\(\epsilon_{ij}\)</span>, the term <span class="math inline">\(\varepsilon_{ij}\)</span> have a cumulative distribution [I forgot the reference! Let me know if you find it]:
<span class="math display">\[\begin{equation}
F(\varepsilon_i) = \exp\Bigg\{- \sum_{g = 1}^G \Bigg(\sum_{j \in \text{   category   } g} \exp[-\varepsilon_{ij}/\lambda_g] \Bigg)^{\lambda_g}  \Bigg\}.
\end{equation}\]</span></li>
</ul>
</div>
<div id="nested-logit-model-choice-probability" class="section level3">
<h3><span class="header-section-number">4.4.36</span> Nested Logit Model: Choice Probability</h3>
<ul>
<li>Under this distributional assumption, the choice probability is:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) = \frac{\exp[v(p, x_j, y_i, z_i)/\lambda_g] \Bigg(\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]\Bigg)^{\lambda_g - 1}}{\sum_{g = 1}^G \Bigg(\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]\Bigg)^{\lambda_g}},
\end{equation}\]</span>
if good <span class="math inline">\(j\)</span> belongs to category <span class="math inline">\(g\)</span>.</li>
<li>The higher <span class="math inline">\(\lambda_g \in [0, 1]\)</span> implies lower correlation within category <span class="math inline">\(g\)</span>.</li>
<li><span class="math inline">\(\lambda_g = 1\)</span> for all <span class="math inline">\(g\)</span> coincides with the multinomial logit model.</li>
</ul>
</div>
<div id="nested-logit-model-decomposition-of-the-choice-probability" class="section level3">
<h3><span class="header-section-number">4.4.37</span> Nested Logit Model: Decomposition of the Choice Probability</h3>
<ul>
<li>The choice probability can be decomposed into two parts:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) = \frac{\exp[v(p, x_j, y_i, z_i)/\lambda_g]}{\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]} \frac{\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]^{\lambda_g}}{\sum_{g = 1}^G \Bigg(\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]\Bigg)^{\lambda_g}}.
\end{equation}\]</span></li>
<li>Letting: <span class="math display">\[
I_{g}(p, x, y_i, z_i) \equiv \log \sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g],
\]</span> we have:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) = \frac{\exp[v(p, x_j, y_i, z_i)/\lambda_g]}{\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]} \frac{\exp[\lambda_g I_{g}(p, x, y_i, z_i)]}{\sum_{g = 1}^G \exp[\lambda_g I_{g}(p, x, y_i, z_i)]}.
\end{equation}\]</span></li>
<li>The second first term can be interpreted as the probability of choosing product <span class="math inline">\(j\)</span> conditional on choosing category <span class="math inline">\(g\)</span> and the second term as the probability of choosing category <span class="math inline">\(g\)</span>.</li>
</ul>
</div>
<div id="discrete-choice-model-with-unobserved-fixed-effects" class="section level3">
<h3><span class="header-section-number">4.4.38</span> Discrete Choice Model with Unobserved Fixed Effects</h3>
<ul>
<li>We have assumed that good <span class="math inline">\(j\)</span> is characterized by a vector of observed characteristics <span class="math inline">\(x_j\)</span>.</li>
<li>Can econometrician observe all the relevant characteristics of the products in the choice set? Maybe no. For example, econometrician may not observe brand values that are created by advertisement and recognized by consumers.</li>
<li>Such unobserved product characteristics is likely to be correlated with the price.</li>
<li>This can cause <strong>endogeneity problems</strong>.</li>
<li>In the following, we consider the situation where only market-segment level share data is available.</li>
<li>Because we can construct the market-share level data from individual choice level data, all the arguments should go through with the individual choice level data.</li>
</ul>
</div>
<div id="unobserved-fixed-effects-in-multinomial-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.39</span> Unobserved Fixed Effects in Multinomial Logit Model</h3>
<ul>
<li>To fix the idea, let’s revisit the multinomial logit model.</li>
<li>For now, we do not consider either observed or unobserved consumer heterogeneity.</li>
<li>Including observed heterogeneity is straightforward.</li>
<li>We discuss how to include unobserved heterogeneity in the subsequent sections.</li>
<li>Suppose that the indirect utility function of good <span class="math inline">\(j\)</span> for consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> is:
<span class="math display">\[\begin{equation}
\beta&#39; x_{jt}  - \alpha p_{jt} - \xi_{jt} + \epsilon_{ik},
\end{equation}\]</span></li>
<li><span class="math inline">\(\epsilon_{ik}\)</span> is i.i.d. Type-I extreme value.</li>
<li><span class="math inline">\(\xi_{jt}\)</span> is the <em>unobserved product-market-specific fixed effect</em> of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span>, which can be correlated with <span class="math inline">\(p_{jt}\)</span>.</li>
<li>We hold the assumption that <span class="math inline">\(x_{jt}\)</span> is uncorrelated with <span class="math inline">\(\xi_{jt}\)</span>.</li>
<li>The choice probability of good <span class="math inline">\(j\)</span> for this consumer and hence the choice share in this market is:</li>
</ul>
<span class="math display">\[\begin{equation}
\sigma_j(p_t, w_t, \xi_t) = \frac{\exp(\beta&#39; x_j - \alpha p_{jt} + \xi_{jt})}{1 + \sum_{k = 1}^J\exp(\beta&#39; x_k - \alpha p_{kt} +  \xi_{kt} ) }.
\end{equation}\]</span>
<ul>
<li>How to deal with the endogeneity between <span class="math inline">\(p_{jt}\)</span> and <span class="math inline">\(\xi_{jt}\)</span>?</li>
</ul>
</div>
<div id="instrumental-variables-and-inversion" class="section level3">
<h3><span class="header-section-number">4.4.40</span> Instrumental Variables and Inversion</h3>
<ul>
<li>Suppose that we have a vector of instrumental variables <span class="math inline">\(w_{jt}\)</span> such that:
<span class="math display">\[\begin{equation}
\mathbb{E}\{\xi_{jt}|w_{jt}\} = 0.
\end{equation}\]</span></li>
<li>In a liner model, we <strong>invert</strong> the model for the unobserved fixed effects:
<span class="math display">\[\begin{equation}
\xi_{jt} = y_{jt} - \beta&#39;x_{jt},
\end{equation}\]</span></li>
<li>Notice that the unobserved fixed effect is written as a function of parameters and data.</li>
<li>Then we exploit the moment condition by:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\mathbb{E}\{\xi_{jt}|w_{jt}\} = 0,\\
&amp;\Rightarrow \mathbb{E}\{ \xi_{jt} w_{jt}\} = 0,\\
&amp;\Leftrightarrow \mathbb{E}\{(y_{jt} - \beta&#39;x_{jt}) w_{jt} \} = 0
\end{split}
\end{equation}\]</span></li>
<li>We can estimate <span class="math inline">\(\beta\)</span> by finding the value that makes the sample analogue of the above expectation zero.</li>
</ul>
</div>
<div id="inversion-in-multinomial-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.41</span> Inversion in Multinomial Logit Model</h3>
<ul>
<li>Can we invert the multinomial model for <span class="math inline">\(\xi_{jt}\)</span>?</li>
<li>We have:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\ln [\sigma_{jt}(p_t, x_t, \xi_t) / \sigma_{0t}(p_t, x_t, \xi_t)] = \beta&#39; x_j - \alpha p_{jt} + \xi_{jt}\\
&amp;\Leftrightarrow \xi_{jt} = \ln [\sigma_j(p_t, x_t, \xi_t) / \sigma_0(p_t, x_t, \xi_t)] - [\beta&#39; x_j - \alpha p_{jt}].
\end{split}
\end{equation}\]</span></li>
<li>Therefore, the moment condition can be written as:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\mathbb{E}\{\xi_{jt}|w_{jt}\} = 0,\\
&amp;\Rightarrow \mathbb{E}\{\xi_{jt} w_{jt}\} = 0,\\
&amp;\Leftrightarrow \mathbb{E}\{(\ln [\sigma_{jt}(p_t, x_t, \xi_t) / \sigma_{0t}(p_t, x_t, \xi_t)] - [\beta&#39; x_j - \alpha p_{jt}]) w_{jt}  \} = 0.
\end{split}
\end{equation}\]</span></li>
<li>We can evaluate the sample analogue of the expectation by replacing the theoretical choice probability <span class="math inline">\(\sigma\)</span> with the observed share <span class="math inline">\(s\)</span>.</li>
<li>At the end, it is no different from the linear model where the dependent variable is <span class="math inline">\(\ln s_{jt}/s_{0t}\)</span>.</li>
</ul>
</div>
<div id="market-invariant-product-specific-fixed-effects" class="section level3">
<h3><span class="header-section-number">4.4.42</span> Market-invariant Product-specific Fixed Effects</h3>
<ul>
<li>Furthermore, if you can assume <span class="math inline">\(\xi_{jt} = \xi_j\)</span>, then
<span class="math display">\[\begin{equation}
\ln [\sigma_j(p_t, x_t, \xi_t) / \sigma_0(p_t, x_t, \xi_t)] = \beta&#39; x_{jt} - \alpha p_{jt} + \xi_{j}.
\end{equation}\]</span></li>
<li>This is nothing but a linear regression on <span class="math inline">\(x_j\)</span> and <span class="math inline">\(p_{jt}\)</span> with product-specific unobserved fixed effect.</li>
<li>This can be estimated by a within-estimator.</li>
<li>This specification is a good starting point: we better start with the simplest specification and use the estimate as the initial guess for the following specifications.</li>
</ul>
</div>
<div id="unobserved-consumer-heterogeneity-and-unobserved-fixed-effects-in-mixed-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.43</span> Unobserved Consumer Heterogeneity and Unobserved Fixed Effects in Mixed-logit Model</h3>
<ul>
<li>So far we abstracted away from the unobserved consumer heterogeneity.</li>
<li>Next, suppose that the indirect utility function of good <span class="math inline">\(j\)</span> for consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> is:
<span class="math display">\[\begin{equation}
\beta_i&#39; x_{jt}  - \alpha_i p_{jt} - \xi_{jt} + \epsilon_{ik},
\end{equation}\]</span>
where <span class="math inline">\(\epsilon_{ik}\)</span> is i.i.d. Type-I extreme value.</li>
<li>The coefficient are drawn according to:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\beta_{it} = \beta_0 + \Sigma \nu_{it},\\
&amp;\alpha_{it} = \alpha_0 + \Omega \upsilon_{it},
\end{split}
\end{equation}\]</span></li>
<li><span class="math inline">\(\nu_i\)</span> are i.i.d. standard normal random variables.</li>
<li>Then the indirect utility of good <span class="math inline">\(j\)</span> for consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> is written as:
<span class="math display">\[\begin{equation}
\underbrace{\beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt}}_{\text{(conditional) mean}} + \underbrace{\nu_{it}&#39; \Sigma x_{jt} - \upsilon_{it}&#39; \Omega p_{jt}}_{\text{deviation from the mean}} 
\end{equation}\]</span></li>
<li>We refer to <span class="math inline">\(\beta_0, \alpha_0\)</span> as <strong>linear parameters</strong> and <span class="math inline">\(\Sigma, \Omega\)</span> as <strong>non-linear parameters</strong>, because of the reason I explain in the subsequent section.</li>
<li>Let <span class="math inline">\(\theta_1\)</span> be the linear parameters and <span class="math inline">\(\theta_2\)</span> the non-linear parameters and let <span class="math inline">\(\theta = (\theta_1&#39;, \theta_2&#39;)&#39;\)</span>.</li>
</ul>
</div>
<div id="unobserved-fixed-effects-in-mixed-logit-model" class="section level3">
<h3><span class="header-section-number">4.4.44</span> Unobserved Fixed Effects in Mixed-logit Model</h3>
<ul>
<li>The choice share of good <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> is:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\sigma_{j}(p_t, x_t, \xi_t, y, z; \theta)\\
&amp;= \int \frac{\exp[\beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt} + \nu_{it}&#39; \Sigma x_{jt} - \upsilon_{it}&#39; \Omega p_{jt}]}{1 + \sum_{k \in \mathcal{J}_t} \exp[\exp[\beta_0&#39; x_{kt} - \alpha_0 p_{kt} + \xi_{kt} + \nu_{it}&#39; \Sigma x_{kt} - \upsilon_{it}&#39; \Omega p_{kt}]]} f(\nu, \upsilon) d \nu d \upsilon.
\end{split}
\end{equation}\]</span></li>
<li>How can we represent <span class="math inline">\(\xi_{jt}\)</span> as a function of parameters of interest to exploit the moment condition?</li>
</ul>
</div>
<div id="representing-xi_jt-as-a-function-of-parameters-of-interest" class="section level3">
<h3><span class="header-section-number">4.4.45</span> Representing <span class="math inline">\(\xi_{jt}\)</span> as a Function of Parameters of Interest</h3>
<ul>
<li>Let <span class="math inline">\(s_{jt}\)</span> be the share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span>.</li>
<li>The following system of equations implicitly determines <span class="math inline">\(\xi_{jt}\)</span> as a function of parameters of interest:
<span class="math display">\[\begin{equation}
s_{jt} = \sigma_j(p_t, x_t, \xi_t; \theta).
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(\xi_{jt}(\theta)\)</span> is the solution to the system of equations above given parameter <span class="math inline">\(\theta\)</span>.</li>
<li>If it exists, it is the unobserved heterogeneity as a function of parameters and data.</li>
<li>Does this solution exist?</li>
<li>Is it unique?</li>
<li>Is there efficient method to find the solution?</li>
</ul>
</div>
<div id="summarizing-the-conditional-mean-term" class="section level3">
<h3><span class="header-section-number">4.4.46</span> Summarizing the Conditional Mean Term</h3>
<ul>
<li>Now, let <span class="math inline">\(\delta_{jt}\)</span> be the conditional mean term in the indirect utility:
<span class="math display">\[\begin{equation}
\delta_{jt} \equiv \beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt}.
\end{equation}\]</span></li>
<li>I call it the average utility of the product in the market.</li>
<li>Then, the choice share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> is written as:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\sigma_{jt}(\delta_t, \theta_2) \\
&amp;\equiv \int \frac{\exp\Bigg(\delta_{jt} + \nu&#39; \Sigma x_{jt} - \upsilon&#39; \Omega p_{jt}\Bigg)}{1 + \sum_{k \in \mathcal{J}_t} \exp\Bigg(\delta_{kt} + \nu&#39; \Sigma x_{kt} - \upsilon&#39; \Omega p_{kt}\Bigg)} f(\nu, \upsilon) d\nu d\upsilon,
\end{split}
\end{equation}\]</span>
for <span class="math inline">\(j = 1, \cdots, J, t = 1, \cdots, T\)</span>.</li>
</ul>
</div>
<div id="contraction-mapping-for-delta_t." class="section level3">
<h3><span class="header-section-number">4.4.47</span> Contraction Mapping for <span class="math inline">\(\delta_t\)</span>.</h3>
<ul>
<li>Now, fix <span class="math inline">\(\theta_2\)</span> and define an operator <span class="math inline">\(T\)</span> such that:
<span class="math display">\[\begin{equation}
T_t(\delta_t) = \delta_t + \ln \underbrace{s_{jt}}_{\text{data}} - \ln \underbrace{\sigma_{jt}(\delta_t, \theta_2)}_{\text{model}}.
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(\delta_t^{(0)} = (\delta_{1t}^{(0)}, \cdots, \delta_{Jt}^{(0)})&#39;\)</span> be an arbitrary starting vector of average utility of products in a market.</li>
<li>Using the operator above, we update <span class="math inline">\(\delta_{t}^{(r)}\)</span> by:
<span class="math display">\[\begin{equation}
\delta_{t}^{(r + 1)} = T_t(\delta_{t}^{(r)}) = \delta_t^{(r)} + \ln s_{jt} - \ln \sigma_{jt}(\delta_t^{(r)}, \theta_2),
\end{equation}\]</span>
for <span class="math inline">\(r = 0, 1, \cdots\)</span>.</li>
<li><span class="citation">S. Berry, Levinsohn, &amp; Pakes (<a href="#ref-Berry1995a">1995</a>)</span> proved that <span class="math inline">\(T_t\)</span> as specified above is a <strong>contraction mapping with modulus less than one</strong>.</li>
<li>This means that:
<ol style="list-style-type: decimal">
<li><span class="math inline">\(T_t\)</span> has a unique fixed point;</li>
<li>For arbitrary <span class="math inline">\(\delta_t^{(r)}\)</span>, <span class="math inline">\(\lim_{r \to \infty} T_t^r(\delta_t^{(0)})\)</span> is the unique fixed point.</li>
</ol></li>
<li>The fixed point of <span class="math inline">\(T_t\)</span> is <span class="math inline">\(\delta_t^*\)</span> such that <span class="math inline">\(\delta_t^* = T_t(\delta_t^*)\)</span>, i.e.,
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\delta_t^* = \delta_t^* + \ln s_{jt} - \ln \sigma_{jt}(\delta_t^*, \theta_2),\\
&amp;\Leftrightarrow s_{jt} = \sigma_{jt}(\delta_t^*, \theta_2).
\end{split}
\end{equation}\]</span></li>
<li>So, the fixed point <span class="math inline">\(\delta_t^*\)</span> is the conditional mean indirect utility that solves the equality given non-linear parameter <span class="math inline">\(\theta_2\)</span>.</li>
<li>Moreover, the solution is unique.</li>
<li>Moreover, it can be found by iterating the operator.</li>
<li>Let <span class="math inline">\(\delta_t(\theta_2)\)</span> be the solution to this equation, i.e., the limit of this operation.</li>
<li>The above result is useful because it ensures the inversion and provides the algorithm to find the solution.</li>
<li>The invertibility itself holds under more general settings <span class="citation">(S. Berry, Gandhi, &amp; Haile, <a href="#ref-Berry2013">2013</a>)</span>.</li>
</ul>
</div>
<div id="solving-for-xi_jttheta" class="section level3">
<h3><span class="header-section-number">4.4.48</span> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span></h3>
<ul>
<li>We defined the average utility as:
<span class="math display">\[\begin{equation}
\delta_{jt} =  \beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt}.
\end{equation}\]</span></li>
<li>Hence, if we set:
<span class="math display">\[\begin{equation}
\xi_{jt}(\theta) \equiv \delta_t(\theta_2) - \Bigg[\sum_{l = 1}^L \beta_{l} w_{jl} - \alpha_0 p_{jt} \Bigg],
\end{equation}\]</span>
the <span class="math inline">\(\xi_{jt}(\theta)\)</span> solves the equality:
<span class="math display">\[\begin{equation}
s_{jt} = \sigma_{j}(p_t, x, \xi_t; \theta).
\end{equation}\]</span></li>
</ul>
</div>
<div id="solving-for-xi_jttheta-summary" class="section level3">
<h3><span class="header-section-number">4.4.49</span> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span>: Summary</h3>
<ul>
<li>In summary, <span class="math inline">\(\xi_{jt}\)</span> that solves the equality exists and unique, and can be computed by:</li>
<li>Fix <span class="math inline">\(\theta = \{\theta_1, \theta_2\}\)</span>.</li>
<li>Fix arbitrary starting value <span class="math inline">\(\delta_t^{(0)}\)</span> for <span class="math inline">\(t = 1, \cdots, T\)</span>.</li>
<li>Let <span class="math inline">\(\delta_t(\theta_2)\)</span> be the limit of <span class="math inline">\(T_t^r(\delta_t^{(0)})\)</span> for <span class="math inline">\(r = 0, 1, \cdots\)</span> for each <span class="math inline">\(t = 1, \cdots, T\)</span>.</li>
<li>Stop the iteration if <span class="math inline">\(|\delta_t(\theta_2)^{(r + 1)} - \delta_t(\theta_2)^{(r)}|\)</span> is below a threshold.</li>
<li>Let <span class="math inline">\(\xi_{jt}(\theta)\)</span> be such that:
<span class="math display">\[\begin{equation}
\xi_{jt}(\theta) = \delta_{jt}(\theta_2) - \beta_0&#39; x_{jt} - \alpha_0 p_{jt}.
\end{equation}\]</span></li>
<li>Then we can evaluate the moment at <span class="math inline">\(\theta\)</span> by:
<span class="math display">\[\begin{equation}
\mathbb{E}\{\xi_{jt}(\theta)|w_{jt}\} = 0.
\end{equation}\]</span></li>
<li>We run this algorithm every time we evaluate the moment condition at a parameter value.</li>
</ul>
</div>
<div id="gmm-objective-function" class="section level3">
<h3><span class="header-section-number">4.4.50</span> GMM Objective Function</h3>
<ul>
<li>Find <span class="math inline">\(\theta\)</span> that solves:
<span class="math display">\[\begin{equation}
\min_{\theta} \xi(\theta)&#39; W \Phi^{-1} W&#39; \xi(\theta),
\end{equation}\]</span>
where <span class="math inline">\(\Phi\)</span> is a weight matrix,
<span class="math display">\[\begin{equation}
\xi(\theta) = 
\begin{pmatrix}
\xi_{11}(\theta)\\
\vdots\\
\xi_{J_1 1}(\theta)\\
\vdots\\
\xi_{1T} \\
\vdots\\
\xi_{J_T T}
\end{pmatrix},
W = 
\begin{pmatrix}
w_{11}&#39; \\
\vdots \\
w_{J_11}&#39; \\
\vdots \\
w_{1T}&#39; \\
\vdots \\
w_{J_TT}&#39; \\
\end{pmatrix}.
\end{equation}\]</span></li>
<li>There are <span class="math inline">\(J \to \infty\)</span> and <span class="math inline">\(T \to \infty\)</span> asymptotics. Either is fine to consistently estimate the parameters.</li>
<li><span class="math inline">\(w_{jt} = (x_{jt}&#39;, w_{jt}^*)&#39;\)</span> where <span class="math inline">\(w_{jt}^*\)</span> is an excluded instrument that is relevant to <span class="math inline">\(p_{jt}\)</span>.</li>
</ul>
</div>
<div id="estimating-linear-parameters" class="section level3">
<h3><span class="header-section-number">4.4.51</span> Estimating Linear Parameters</h3>
<ul>
<li>The first-order condition for <span class="math inline">\(\theta_1\)</span> is:
<span class="math display">\[\begin{equation}
\theta_1 = (X_1&#39;W \Phi^{-1} W&#39;X_1)^{-1} X_1&#39; W \Phi^{-1} W&#39; \delta(\theta_2),
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
X_1 = 
\begin{pmatrix}
x_{11}&#39; &amp; - p_{11}\\
\vdots &amp; \vdots \\
x_{J_1 1}&#39; &amp; - p_{J_1 1}\\
\vdots &amp; \vdots \\
x_{1T}&#39; &amp; - p_{1T}\\
\vdots &amp; \vdots \\
x_{J_T T} &amp; - p_{J_T T}
\end{pmatrix},
\delta(\theta_2) =
\begin{pmatrix}
\delta_1(\theta_2)\\
\vdots\\
\delta_T(\theta_2)
\end{pmatrix}
\end{equation}\]</span>
.</li>
<li>If <span class="math inline">\(\theta_2\)</span> is given, the optimal <span class="math inline">\(\theta_1\)</span> is computed by the above formula.</li>
<li><span class="math inline">\(\rightarrow\)</span> We only have to search over <span class="math inline">\(\theta_2\)</span>.</li>
<li>This is the reason why we called <span class="math inline">\(\theta_1\)</span> linear parameters and <span class="math inline">\(\theta_2\)</span> non-linear parameters.</li>
</ul>
</div>
<div id="blp-algorithm" class="section level3">
<h3><span class="header-section-number">4.4.52</span> BLP Algorithm</h3>
<ul>
<li>Find <span class="math inline">\(\theta_2\)</span> that maximizes the GMM objective function.</li>
<li>To do so:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Pick up <span class="math inline">\(\theta_2\)</span>.</li>
<li>Compute <span class="math inline">\(\delta(\theta_2)\)</span> by the fixed-point algorithm.</li>
<li>Compute associated <span class="math inline">\(\theta_1\)</span> by the formula:
<span class="math display">\[\begin{equation}
\theta_1 = (X_1&#39;W \Phi^{-1} W&#39;X_1)^{-1} X_1&#39; W \Phi^{-1} W&#39; \delta(\theta_2),
\end{equation}\]</span></li>
<li>Compute <span class="math inline">\(\xi(\theta)\)</span> from the above <span class="math inline">\(\delta(\theta_2)\)</span> and <span class="math inline">\(\theta_1\)</span>.</li>
<li>Evaluate the GMM objective function with the <span class="math inline">\(\xi(\theta)\)</span>.</li>
</ol>
</div>
<div id="mathematical-program-with-equilibrium-constraints-mpec" class="section level3">
<h3><span class="header-section-number">4.4.53</span> Mathematical Program with Equilibrium Constraints (MPEC)</h3>
<ul>
<li>In the BLP algorithm, for each parameter <span class="math inline">\(\theta\)</span>, find <span class="math inline">\(\xi(\theta)\)</span> that solve:
<span class="math display">\[\begin{equation}
s = \sigma(p, x, \xi; \theta)
\end{equation}\]</span>
by the fixed-point algorithm and then evaluate the GMM objective function.</li>
<li>This inner loop takes time if the stopping criterion is tight.</li>
<li>If the stopping criterion is loose, the loop may stop earlier but the error may be unacceptably large.</li>
<li><span class="citation">Dubé, Fox, &amp; Su (<a href="#ref-Dube2012">2012</a>)</span> suggest to minimize the GMM objective function with the above equation as the constraints.
<span class="math display">\[\begin{equation}
\min_{\theta} \xi(\theta)&#39; W \Phi^{-1} W&#39; \xi(\theta) \text{   s.t.   } s = \sigma(p, x, \xi; \theta).
\end{equation}\]</span></li>
<li>To enjoy the benefit of this approach, we have to analytically derive the gradient and hessian of the objective function and the constraints, which are anyway needed if we estimate the standard error with the plug-in method.</li>
<li>If the problem is of small scale, BLP algorithm will be fast enough and easier to implement.</li>
<li>If the problem is of large scale, you may better use the MPEC approach.</li>
</ul>
</div>
<div id="instrumental-variables" class="section level3">
<h3><span class="header-section-number">4.4.54</span> Instrumental Variables</h3>
<ul>
<li>The remaining problem is how to choose the excluded instrumental variable <span class="math inline">\(w_{jt}^*\)</span> for each product/market.</li>
<li><strong>Cost shifters</strong>:
<ul>
<li>Traditional instruments.</li>
</ul></li>
<li><strong>Hausman-type IV</strong> <span class="citation">(Hausman, Leonard, &amp; Zona, <a href="#ref-Hausman1994">1994</a>)</span>:
<ul>
<li>Assume that demand shocks are independent across markets, whereas the cost shocks are correlated.</li>
<li>The latter will be true if the product is produced by the same manufacturer.</li>
<li>Then, the price of the same product in the other markets <span class="math inline">\(p_{j, -t}\)</span> will be valid instruments for the price of the product in a given market, <span class="math inline">\(p_{jt}\)</span>.</li>
</ul></li>
<li><strong>BLP-type IV</strong> <span class="citation">(S. Berry et al., <a href="#ref-Berry1995a">1995</a>)</span>:
<ul>
<li>In oligopoly, the price of a good in a market depends on the market structure, i.e., what kind of products are available in the market.</li>
<li>For example, if there are similar products in the market, the price will tend to be lower.</li>
<li>Then, the product characteristics of other products in the market , will be valid instrument for the price of goods in a given market, <span class="math inline">\(p_{jt}\)</span>.</li>
<li>If there are multi-product firms, whether the other good is owned by the same company will also affect the price.</li>
<li>Specifically, <span class="citation">S. Berry et al. (<a href="#ref-Berry1995a">1995</a>)</span> use:</li>
</ul></li>
</ul>
<span class="math display">\[\begin{equation}
\sum_{k \neq j \in \mathcal{J}_t \cap \mathcal{F}_{f}} x_{kt},
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
\sum_{k \neq j \in \mathcal{J}_t \setminus \mathcal{F}_{f}} x_{kt}.
\end{equation}\]</span>
<ul>
<li><span class="math inline">\(f\)</span> is the firm that owns product <span class="math inline">\(j\)</span> and <span class="math inline">\(\mathcal{F}_{f}\)</span> is the set of products firm <span class="math inline">\(f\)</span> owns.</li>
<li><strong>Differentiation IV</strong> <span class="citation">(Gandhi &amp; Houde, <a href="#ref-Gandhi2015a">2015</a>)</span>:
<ul>
<li>Let <span class="math inline">\(d_{jkt} = d(x_{jt}, x_{kt})\)</span> be some distance between product characteristics.</li>
<li>They showed that under certain conditions the optimal BLP-type IV is a function <span class="math inline">\(d_{-jt}\{d_{jkt}\}_{k \neq j \in \mathcal{J}_t}\)</span>.</li>
<li>The suggest to use the moments of <span class="math inline">\(d_{-jt}\)</span> as the excluded instrument variables.</li>
</ul></li>
<li>Weak instruments problem of BLP-type IV:
<ul>
<li><span class="citation">Armstrong (<a href="#ref-Armstrong2016b">2016</a>)</span> argued that estimates based on BLP-type IV may be inconsistent when <span class="math inline">\(J \times \infty\)</span> asymptotics is considered, because then the market approaches the competitive market and the correlation between the markup and the product characteristics of the rivals disappear.</li>
<li>Specifically, the estimator is inconsistent if all of the following conditions are met:</li>
</ul>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(J \to \infty\)</span> but <span class="math inline">\(T\)</span> is fixed;</li>
<li>The demand/cost functions are such that the correlation between markups and characteristics of other products decreases quickly enough as <span class="math inline">\(J \to \infty\)</span>.</li>
<li>There is no cost instruments or other sources of identification.</li>
</ol></li>
</ul>
<!-- ### Control Function Approach -->
<!-- - The equilibrium price vector in a market is determined by product characteristics, and productivity and demand conditions. -->
<!-- - It will depends on the unobserved product characteristics $\xi_{jt}$. -->
<!-- - Suppose that the equilibrium price vector in a market is determined by: -->
<!-- \begin{equation} -->
<!-- p_{t} = P(x_t, w_t, \xi_t), -->
<!-- \end{equation} -->
<!-- where $w_t$ is a vector of variables that affect the price but are excluded from the indirect utility function. -->
<!-- - If we can estimate it and it is invertible in $\xi_t$, then, we can have a proxy for $\xi_t$ such as: -->
<!-- \begin{equation} -->
<!-- \hat{\xi}_t = \hat{P}^{-1}(x_t, z_t). -->
<!-- \end{equation} -->
<!-- - If we insert this into the previous models, $\xi_{jt}$ is no longer __unobserved__ product characteristics. -->
<!-- - This approach is similar to Olley and Pakes method for production function estimation. -->

</div>
</div>
</div>
<h3> References</h3>
<div id="refs" class="references">
<div id="ref-Nevo2000c">
<p>Nevo, A. (2000). <em>Mergers with differentiated products: the case of the ready-to-eat cereal industry</em> (No. 3) (Vol. 31).</p>
</div>
<div id="ref-Chung2002">
<p>Chung, W., &amp; Alcácer, J. (2002). Knowledge Seeking and Location Choice of Foreign Direct Investment in the United States. <em>Management Science</em>, <em>48</em>(12).</p>
</div>
<div id="ref-Rysman2004">
<p>Rysman, M. (2004). <em>Competition Between Networks: A Study of the Market for Yellow Pages</em> (Vol. 71, pp. 483–512).</p>
</div>
<div id="ref-Gentzkow2004">
<p>Gentzow, M. (2004). <em>Valuing new goods in a model with complementarity : Online newspapers</em> (No. 3) (Vol. 97, pp. 713–744).</p>
</div>
<div id="ref-Bayer2007">
<p>Bayer, P., Ferreira, F., Mcmillan, R., Altonji, J., Bajari, P., Berry, S., … Timmins, C. (2007). <em>A Unified Framework for Measuring Preferences for Schools and Neighborhoods</em> (No. 4) (Vol. 115).</p>
</div>
<div id="ref-Archak2011">
<p>Archak, N., Ghose, A., &amp; Ipeirotis, P. G. (2011). Deriving the Pricing Power of Product Features by Mining Consumer Reviews. <em>Management Science</em>, <em>57</em>(8), 1485–1509.</p>
</div>
<div id="ref-Holmes2011">
<p>Holmes, B. Y. T. H. J. H. (2011). The Diffusion of Wal-Mart and Economies of Density. <em>Econometrica</em>, <em>79</em>(1), 253–302.</p>
</div>
<div id="ref-Handbury2014">
<p>Handbury, J., &amp; Weinstein, D. E. (2014). Goods Prices and Availability in Cities. <em>The Review of Economic Studies</em>, <em>82</em>(1), 258–296.</p>
</div>
<div id="ref-Samuelson1938">
<p>Samuelson, P. A. (1938). A Note on the Pure Theory of Consumer’s Behaviour. <em>Economica</em>, <em>5</em>(17), 61–71.</p>
</div>
<div id="ref-Houthakker1950">
<p>Houthakker, H. S. (1950). Revealed Preference and the Utility Function Author. <em>Economica</em>, <em>17</em>(66), 159–174.</p>
</div>
<div id="ref-Richter1966">
<p>Richter, M. K. (1966). Revealed Preference Theory. <em>Econometrica</em>, <em>34</em>(3).</p>
</div>
<div id="ref-Afriat1967">
<p>Afriat, S. N. (1967). The Construction of Utility Functions from Expenditure Data. <em>International Economic Review</em>, <em>8</em>(1).</p>
</div>
<div id="ref-Varian1982">
<p>Varian, H. R. (1982). The Nonparametric Approach to Demand Analysis. <em>Econometrica</em>, <em>50</em>(4), 945–973.</p>
</div>
<div id="ref-Deaton1980">
<p>Deaton, A., &amp; Muellbauer, J. (1980). <em>An Almost Ideal Demand System</em> (No. 3) (Vol. 70, pp. 312–326).</p>
</div>
<div id="ref-AngusDeaton1980">
<p>Angus Deaton, &amp; John Muellbauer. (1980). <em>Economics and Consumer Behavior</em>. New York: Cambridge University Press.</p>
</div>
<div id="ref-Muellbauer1976">
<p>Muellbauer, J. (1976). Community Preferences and the Representative Consumer Author. <em>Econometrica</em>, <em>44</em>(5), 979–999.</p>
</div>
<div id="ref-RichardStone1954">
<p>Richard Stone. (1954). <em>The Measurement of Consumers’ Expenditure and Behaviour in the United Kingdom 1920-1938, vol. 1</em>. Cambridge: Cambridge University Press.</p>
</div>
<div id="ref-Lancaster1966">
<p>Lancaster, K. J. (1966). A New Approach to Consumer Theory. <em>Journal of Political Economy</em>, <em>74</em>(2), 132–157.</p>
</div>
<div id="ref-Muth1966">
<p>Muth, R. F. (1966). <em>Household Production and Consumer Demand Functions</em> (No. 3) (Vol. 34, pp. 699–708).</p>
</div>
<div id="ref-Rosen1974">
<p>Rosen, S. (1974). Hedonic Prices and Implicit Markets: Product Differentiation in Pure Competition. <em>Journal of Political Economy</em>, <em>82</em>(1), 34–55.</p>
</div>
<div id="ref-Muellbauer1974">
<p>Muellbauer, J. (1974). Household Production Theory, Quality, and the &quot;Hedonic Technique. <em>The American Economic Review</em>, <em>64</em>(6), 977–994.</p>
</div>
<div id="ref-Gorman1980">
<p>Gorman, W. M. (1980). <em>A Possible Procedure for Analysing Quality Differentials in the Egg Market</em> (No. 5) (Vol. 47, pp. 843–856).</p>
</div>
<div id="ref-Blow2008">
<p>Blow, L., Browning, M., &amp; Crawford, I. (2008). <em>Revealed Preference Analysis of Characteristics Models</em> (Vol. 75, pp. 371–389).</p>
</div>
<div id="ref-Bresnahan1987">
<p>Bresnahan, T. F. (1987). The Empirical Renaissance in Industrial Economics. <em>The Journal of Industrial Economics</em>, <em>35</em>(4), 457–482.</p>
</div>
<div id="ref-Mcfadden1974">
<p>Mcfadden, D. L. (1974). Conditional Logit Analysis of Qualitative Choice Behavior. In P. Zarembka (Ed.), <em>Frontiers in econometrics</em>. New York: Academic Press.</p>
</div>
<div id="ref-Train2009">
<p>Train, K. (2009). <em>Discrete Choice Methods with Simulation</em>. Cambridge: Cambridge University Press.</p>
</div>
<div id="ref-Berry2007">
<p>Berry, S., &amp; Pakes, A. (2007). The Pure Characteristics Demand Model. <em>International Economic Review</em>, <em>48</em>(4), 1193–1225.</p>
</div>
<div id="ref-Mcfadden2000">
<p>McFadden, D., &amp; Train, K. (2000). Mixed MNL models for discrete response. <em>Journal of Applied Econometrics</em>, <em>15</em>(5), 447–470.</p>
</div>
<div id="ref-Judd1998">
<p>Judd, K. L. (1998). <em>Numerical methods in economics</em> (p. 633). MIT Press.</p>
</div>
<div id="ref-Berry1995a">
<p>Berry, S., Levinsohn, J., &amp; Pakes, A. (1995). Automobile Prices in Market Equilibrium. <em>Econometrica</em>, <em>63</em>(4), 841–890.</p>
</div>
<div id="ref-Berry2013">
<p>Berry, S., Gandhi, A., &amp; Haile, P. (2013). Connected Substitutes and Invertibility of Demand. <em>Econometrica</em>, <em>81</em>(5), 2087–2111.</p>
</div>
<div id="ref-Dube2012">
<p>Dubé, J.-P., Fox, J. T., &amp; Su, C.-L. (2012). Improving the Numerical Performance of Static and Dynamic Aggregate Discrete Choice Random Coefficients Demand Estimation. <em>Econometrica</em>, <em>80</em>(5), 2231–2267.</p>
</div>
<div id="ref-Hausman1994">
<p>Hausman, Leonard, &amp; Zona. (1994). Competitive Analysis with Differenciated Products. <em>Annales d’Économie et de Statistique</em>, (34), 159–180.</p>
</div>
<div id="ref-Gandhi2015a">
<p>Gandhi, A., &amp; Houde, J.-F. (2015). <em>Measuring Substitution Patterns in Differentiated Products Industries</em>.</p>
</div>
<div id="ref-Armstrong2016b">
<p>Armstrong, T. B. (2016). Large Market Asymptotics for Differentiated Product Demand Estimators with Economic Models of Supply. <em>Econometrica</em>, <em>84</em>(5), 1961–1980.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="production.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="assignment1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["lecture.pdf", "lecture.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
