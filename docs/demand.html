<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Demand Function Estimation | ECON5630 Topics in Empirical Industrial Organization</title>
  <meta name="description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Demand Function Estimation | ECON5630 Topics in Empirical Industrial Organization" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Demand Function Estimation | ECON5630 Topics in Empirical Industrial Organization" />
  
  <meta name="twitter:description" content="Thie is a lecture note for ECON5630 at Hong Kong University of Science and Technology." />
  

<meta name="author" content="Kohei Kawaguchi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="production.html"/>
<link rel="next" href="merger.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECON5630</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#general-information"><i class="fa fa-check"></i><b>1.2</b> General Information</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#class-time"><i class="fa fa-check"></i><b>1.2.1</b> Class Time</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#description"><i class="fa fa-check"></i><b>1.2.2</b> Description</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#expectation-and-goals"><i class="fa fa-check"></i><b>1.2.3</b> Expectation and Goals</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#required-environment"><i class="fa fa-check"></i><b>1.3</b> Required Environment</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#evaluation"><i class="fa fa-check"></i><b>1.4</b> Evaluation</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#academic-integrity"><i class="fa fa-check"></i><b>1.5</b> Academic Integrity</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.6</b> Schedule</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#course-materials"><i class="fa fa-check"></i><b>1.7</b> Course Materials</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#code"><i class="fa fa-check"></i><b>1.7.1</b> Code</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#r-and-rstudio"><i class="fa fa-check"></i><b>1.7.2</b> R and RStudio</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#handbook-chapters"><i class="fa fa-check"></i><b>1.7.3</b> Handbook Chapters</a></li>
<li class="chapter" data-level="1.7.4" data-path="index.html"><a href="index.html#books"><i class="fa fa-check"></i><b>1.7.4</b> Books</a></li>
<li class="chapter" data-level="1.7.5" data-path="index.html"><a href="index.html#papers"><i class="fa fa-check"></i><b>1.7.5</b> Papers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-are-structural-models"><i class="fa fa-check"></i><b>2.1</b> What are structural models?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#example-linear-demand-and-supply-model"><i class="fa fa-check"></i><b>2.2</b> Example: Linear demand and supply model</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#ordinary-least-squares-ols-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.3</b> Ordinary-Least-Squares (OLS) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#maximum-likelihood-estimation-mle-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.4</b> Maximum-Likelihood Estimation (MLE) of the demand and supply model</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#simulation-based-simulated-likelihood-or-simulated-method-of-moments-methods"><i class="fa fa-check"></i><b>2.5</b> Simulation-based (Simulated-Likelihood or Simulated-Method-of-Moments) methods</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#two-stage-least-squares-2sls-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.6</b> Two-Stage Least Squares (2SLS) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#instrumental-variables-iv-and-generalized-method-of-moments-gmm-estimation-of-the-demand-and-supply-model"><i class="fa fa-check"></i><b>2.7</b> Instrumental-Variables (IV) and Generalized Method of Moments (GMM) estimation of the demand and supply model</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#general-case"><i class="fa fa-check"></i><b>2.8</b> General Case</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#structural-estimation-and-counterfactual-analysis"><i class="fa fa-check"></i><b>2.9</b> Structural Estimation and Counterfactual Analysis</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="intro.html"><a href="intro.html#example"><i class="fa fa-check"></i><b>2.9.1</b> Example</a></li>
<li class="chapter" data-level="2.9.2" data-path="intro.html"><a href="intro.html#recap"><i class="fa fa-check"></i><b>2.9.2</b> Recap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="production.html"><a href="production.html"><i class="fa fa-check"></i><b>3</b> Production and Cost Function Estimation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="production.html"><a href="production.html#motivations"><i class="fa fa-check"></i><b>3.1</b> Motivations</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="production.html"><a href="production.html#io"><i class="fa fa-check"></i><b>3.1.1</b> IO</a></li>
<li class="chapter" data-level="3.1.2" data-path="production.html"><a href="production.html#development"><i class="fa fa-check"></i><b>3.1.2</b> Development</a></li>
<li class="chapter" data-level="3.1.3" data-path="production.html"><a href="production.html#trade"><i class="fa fa-check"></i><b>3.1.3</b> Trade</a></li>
<li class="chapter" data-level="3.1.4" data-path="production.html"><a href="production.html#management"><i class="fa fa-check"></i><b>3.1.4</b> Management</a></li>
<li class="chapter" data-level="3.1.5" data-path="production.html"><a href="production.html#education"><i class="fa fa-check"></i><b>3.1.5</b> Education</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="production.html"><a href="production.html#analyzing-producer-behaviors"><i class="fa fa-check"></i><b>3.2</b> Analyzing Producer Behaviors</a></li>
<li class="chapter" data-level="3.3" data-path="production.html"><a href="production.html#production-function-estimation"><i class="fa fa-check"></i><b>3.3</b> Production Function Estimation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="production.html"><a href="production.html#cobb-douglas-specification-as-a-benchmark"><i class="fa fa-check"></i><b>3.3.1</b> Cobb-Douglas Specification as a Benchmark</a></li>
<li class="chapter" data-level="3.3.2" data-path="production.html"><a href="production.html#potential-bias-i-endogeneity"><i class="fa fa-check"></i><b>3.3.2</b> Potential Bias I: Endogeneity</a></li>
<li class="chapter" data-level="3.3.3" data-path="production.html"><a href="production.html#potential-bias-ii-selection"><i class="fa fa-check"></i><b>3.3.3</b> Potential Bias II: Selection</a></li>
<li class="chapter" data-level="3.3.4" data-path="production.html"><a href="production.html#how-to-resolve-endogeneity-bias"><i class="fa fa-check"></i><b>3.3.4</b> How to Resolve Endogeneity Bias?</a></li>
<li class="chapter" data-level="3.3.5" data-path="production.html"><a href="production.html#panel-data"><i class="fa fa-check"></i><b>3.3.5</b> Panel Data</a></li>
<li class="chapter" data-level="3.3.6" data-path="production.html"><a href="production.html#first-order-condition-for-inputs"><i class="fa fa-check"></i><b>3.3.6</b> First-Order Condition for Inputs</a></li>
<li class="chapter" data-level="3.3.7" data-path="production.html"><a href="production.html#productioniv"><i class="fa fa-check"></i><b>3.3.7</b> Instrumental Variable</a></li>
<li class="chapter" data-level="3.3.8" data-path="production.html"><a href="production.html#olley-pakes-approach"><i class="fa fa-check"></i><b>3.3.8</b> Olley-Pakes Approach</a></li>
<li class="chapter" data-level="3.3.9" data-path="production.html"><a href="production.html#assumption-i-information-set"><i class="fa fa-check"></i><b>3.3.9</b> Assumption I: Information Set</a></li>
<li class="chapter" data-level="3.3.10" data-path="production.html"><a href="production.html#assumption-ii-first-order-markov"><i class="fa fa-check"></i><b>3.3.10</b> Assumption II: First Order Markov</a></li>
<li class="chapter" data-level="3.3.11" data-path="production.html"><a href="production.html#assumption-iii-timing-of-input-choices"><i class="fa fa-check"></i><b>3.3.11</b> Assumption III: Timing of Input Choices</a></li>
<li class="chapter" data-level="3.3.12" data-path="production.html"><a href="production.html#assumption-iv-scalar-unobservable"><i class="fa fa-check"></i><b>3.3.12</b> Assumption IV: Scalar Unobservable</a></li>
<li class="chapter" data-level="3.3.13" data-path="production.html"><a href="production.html#assumption-iv-strict-monotonicity"><i class="fa fa-check"></i><b>3.3.13</b> Assumption IV: Strict Monotonicity</a></li>
<li class="chapter" data-level="3.3.14" data-path="production.html"><a href="production.html#two-step-approach-the-first-step"><i class="fa fa-check"></i><b>3.3.14</b> Two-step Approach: The First Step</a></li>
<li class="chapter" data-level="3.3.15" data-path="production.html"><a href="production.html#two-step-approach-the-second-step"><i class="fa fa-check"></i><b>3.3.15</b> Two-step Approach: The Second Step</a></li>
<li class="chapter" data-level="3.3.16" data-path="production.html"><a href="production.html#identification-of-the-anticipated-shocks"><i class="fa fa-check"></i><b>3.3.16</b> Identification of the Anticipated Shocks</a></li>
<li class="chapter" data-level="3.3.17" data-path="production.html"><a href="production.html#two-step-estimation-of-olley1996."><i class="fa fa-check"></i><b>3.3.17</b> Two-Step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span>.</a></li>
<li class="chapter" data-level="3.3.18" data-path="production.html"><a href="production.html#from-an-economic-models-to-an-econometric-model"><i class="fa fa-check"></i><b>3.3.18</b> From An Economic Models to An Econometric Model</a></li>
<li class="chapter" data-level="3.3.19" data-path="production.html"><a href="production.html#how-to-resolve-selection-bias"><i class="fa fa-check"></i><b>3.3.19</b> How to Resolve Selection Bias</a></li>
<li class="chapter" data-level="3.3.20" data-path="production.html"><a href="production.html#correction-in-the-first-step"><i class="fa fa-check"></i><b>3.3.20</b> Correction in the First Step</a></li>
<li class="chapter" data-level="3.3.21" data-path="production.html"><a href="production.html#correction-in-the-second-step-i-the-source-of-bias"><i class="fa fa-check"></i><b>3.3.21</b> Correction in the Second Step I: The Source of Bias</a></li>
<li class="chapter" data-level="3.3.22" data-path="production.html"><a href="production.html#correction-in-the-second-step-ii-conditional-exit-probability"><i class="fa fa-check"></i><b>3.3.22</b> Correction in the Second Step II: Conditional Exit Probability</a></li>
<li class="chapter" data-level="3.3.23" data-path="production.html"><a href="production.html#correction-in-the-second-step-iii-invertibility-in-threshold"><i class="fa fa-check"></i><b>3.3.23</b> Correction in the Second Step III: Invertibility in Threshold</a></li>
<li class="chapter" data-level="3.3.24" data-path="production.html"><a href="production.html#correction-in-the-second-step-iv-controlling-the-threshold"><i class="fa fa-check"></i><b>3.3.24</b> Correction in the Second Step IV: Controlling the Threshold</a></li>
<li class="chapter" data-level="3.3.25" data-path="production.html"><a href="production.html#three-step-estimation-of-olley1996"><i class="fa fa-check"></i><b>3.3.25</b> Three Step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span></a></li>
<li class="chapter" data-level="3.3.26" data-path="production.html"><a href="production.html#zero-investment-problem"><i class="fa fa-check"></i><b>3.3.26</b> Zero Investment Problem</a></li>
<li class="chapter" data-level="3.3.27" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-i-discard-some-data"><i class="fa fa-check"></i><b>3.3.27</b> Tackle Zero Investment Problem I: Discard Some Data</a></li>
<li class="chapter" data-level="3.3.28" data-path="production.html"><a href="production.html#tackle-zero-investment-problem-ii-use-another-proxy"><i class="fa fa-check"></i><b>3.3.28</b> Tackle Zero Investment Problem II: Use Another Proxy</a></li>
<li class="chapter" data-level="3.3.29" data-path="production.html"><a href="production.html#one-step-estimation-of-olley1996-and-levinsohn2003"><i class="fa fa-check"></i><b>3.3.29</b> One-step Estimation of <span class="citation">Olley &amp; Pakes (1996)</span> and <span class="citation">Levinsohn &amp; Petrin (2003)</span></a></li>
<li class="chapter" data-level="3.3.30" data-path="production.html"><a href="production.html#scalar-unobservable-problem-finite-order-markov-process"><i class="fa fa-check"></i><b>3.3.30</b> Scalar Unobservable Problem: Finite-order Markov Process</a></li>
<li class="chapter" data-level="3.3.31" data-path="production.html"><a href="production.html#scalar-unobservable-problem-demand-and-productivity-shocks"><i class="fa fa-check"></i><b>3.3.31</b> Scalar Unobservable Problem: Demand and Productivity Shocks</a></li>
<li class="chapter" data-level="3.3.32" data-path="production.html"><a href="production.html#collinearity-problem"><i class="fa fa-check"></i><b>3.3.32</b> Collinearity Problem</a></li>
<li class="chapter" data-level="3.3.33" data-path="production.html"><a href="production.html#tackle-collinearity-problem-peculiar-assumptions"><i class="fa fa-check"></i><b>3.3.33</b> Tackle Collinearity Problem: Peculiar Assumptions</a></li>
<li class="chapter" data-level="3.3.34" data-path="production.html"><a href="production.html#tackle-collinearity-problem-share-regression"><i class="fa fa-check"></i><b>3.3.34</b> Tackle Collinearity Problem: Share Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="production.html"><a href="production.html#cost-function-estimation"><i class="fa fa-check"></i><b>3.4</b> Cost Function Estimation</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="production.html"><a href="production.html#cost-function-duality"><i class="fa fa-check"></i><b>3.4.1</b> Cost Function: Duality</a></li>
<li class="chapter" data-level="3.4.2" data-path="production.html"><a href="production.html#translog-cost-function"><i class="fa fa-check"></i><b>3.4.2</b> Translog Cost Function</a></li>
<li class="chapter" data-level="3.4.3" data-path="production.html"><a href="production.html#translog-cost-function-integrability"><i class="fa fa-check"></i><b>3.4.3</b> Translog Cost Function: Integrability</a></li>
<li class="chapter" data-level="3.4.4" data-path="production.html"><a href="production.html#two-approaches"><i class="fa fa-check"></i><b>3.4.4</b> Two Approaches</a></li>
<li class="chapter" data-level="3.4.5" data-path="production.html"><a href="production.html#cost-data-approach"><i class="fa fa-check"></i><b>3.4.5</b> Cost Data Approach</a></li>
<li class="chapter" data-level="3.4.6" data-path="production.html"><a href="production.html#revealed-preference-approach"><i class="fa fa-check"></i><b>3.4.6</b> Revealed Preference Approach</a></li>
<li class="chapter" data-level="3.4.7" data-path="production.html"><a href="production.html#single-product-monopolist"><i class="fa fa-check"></i><b>3.4.7</b> Single-product Monopolist</a></li>
<li class="chapter" data-level="3.4.8" data-path="production.html"><a href="production.html#multi-product-monopolist-case"><i class="fa fa-check"></i><b>3.4.8</b> Multi-product Monopolist Case</a></li>
<li class="chapter" data-level="3.4.9" data-path="production.html"><a href="production.html#oligopoly"><i class="fa fa-check"></i><b>3.4.9</b> Oligopoly</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="demand.html"><a href="demand.html"><i class="fa fa-check"></i><b>4</b> Demand Function Estimation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="demand.html"><a href="demand.html#motivations-1"><i class="fa fa-check"></i><b>4.1</b> Motivations</a></li>
<li class="chapter" data-level="4.2" data-path="demand.html"><a href="demand.html#analyzing-consumer-behaviors"><i class="fa fa-check"></i><b>4.2</b> Analyzing Consumer Behaviors</a></li>
<li class="chapter" data-level="4.3" data-path="demand.html"><a href="demand.html#continuous-choice"><i class="fa fa-check"></i><b>4.3</b> Continuous Choice</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="demand.html"><a href="demand.html#duality-between-utility-and-expenditure-functions"><i class="fa fa-check"></i><b>4.3.1</b> Duality between Utility and Expenditure Functions</a></li>
<li class="chapter" data-level="4.3.2" data-path="demand.html"><a href="demand.html#deriving-other-functions"><i class="fa fa-check"></i><b>4.3.2</b> Deriving Other Functions</a></li>
<li class="chapter" data-level="4.3.3" data-path="demand.html"><a href="demand.html#starting-from-an-indirect-utility-function"><i class="fa fa-check"></i><b>4.3.3</b> Starting from an Indirect Utility Function</a></li>
<li class="chapter" data-level="4.3.4" data-path="demand.html"><a href="demand.html#expenditure-share-equation"><i class="fa fa-check"></i><b>4.3.4</b> Expenditure Share Equation</a></li>
<li class="chapter" data-level="4.3.5" data-path="demand.html"><a href="demand.html#almost-ideal-demand-system-aids"><i class="fa fa-check"></i><b>4.3.5</b> Almost Ideal Demand System (AIDS)</a></li>
<li class="chapter" data-level="4.3.6" data-path="demand.html"><a href="demand.html#piglog-class"><i class="fa fa-check"></i><b>4.3.6</b> PIGLOG Class</a></li>
<li class="chapter" data-level="4.3.7" data-path="demand.html"><a href="demand.html#derive-the-share-equation-i"><i class="fa fa-check"></i><b>4.3.7</b> Derive the Share Equation I</a></li>
<li class="chapter" data-level="4.3.8" data-path="demand.html"><a href="demand.html#derive-the-share-equation-ii"><i class="fa fa-check"></i><b>4.3.8</b> Derive the Share Equation II</a></li>
<li class="chapter" data-level="4.3.9" data-path="demand.html"><a href="demand.html#specify-the-detail-ii"><i class="fa fa-check"></i><b>4.3.9</b> Specify the Detail II</a></li>
<li class="chapter" data-level="4.3.10" data-path="demand.html"><a href="demand.html#estimation"><i class="fa fa-check"></i><b>4.3.10</b> Estimation</a></li>
<li class="chapter" data-level="4.3.11" data-path="demand.html"><a href="demand.html#from-product-space-approach-to-characteristics-space-approach"><i class="fa fa-check"></i><b>4.3.11</b> From Product Space Approach to Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.3.12" data-path="demand.html"><a href="demand.html#from-continuous-choice-approach-to-discrete-choice-approach"><i class="fa fa-check"></i><b>4.3.12</b> From Continuous Choice Approach to Discrete Choice Approach</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="demand.html"><a href="demand.html#discrete-choice"><i class="fa fa-check"></i><b>4.4</b> Discrete Choice</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="demand.html"><a href="demand.html#discrete-choice-approach"><i class="fa fa-check"></i><b>4.4.1</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.2" data-path="demand.html"><a href="demand.html#discrete-choice-approach-1"><i class="fa fa-check"></i><b>4.4.2</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.3" data-path="demand.html"><a href="demand.html#discrete-choice-approach-2"><i class="fa fa-check"></i><b>4.4.3</b> Discrete Choice Approach</a></li>
<li class="chapter" data-level="4.4.4" data-path="demand.html"><a href="demand.html#characteristics-space-approach"><i class="fa fa-check"></i><b>4.4.4</b> Characteristics Space Approach</a></li>
<li class="chapter" data-level="4.4.5" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect"><i class="fa fa-check"></i><b>4.4.5</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.6" data-path="demand.html"><a href="demand.html#weak-separability-and-income-effect-1"><i class="fa fa-check"></i><b>4.4.6</b> Weak Separability and Income Effect</a></li>
<li class="chapter" data-level="4.4.7" data-path="demand.html"><a href="demand.html#utility-function-normalization"><i class="fa fa-check"></i><b>4.4.7</b> Utility Function Normalization</a></li>
<li class="chapter" data-level="4.4.8" data-path="demand.html"><a href="demand.html#aggregation-of-the-individual-demand"><i class="fa fa-check"></i><b>4.4.8</b> Aggregation of the Individual Demand</a></li>
<li class="chapter" data-level="4.4.9" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation"><i class="fa fa-check"></i><b>4.4.9</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.10" data-path="demand.html"><a href="demand.html#horizontal-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.10</b> Horizontal Product Differentiation</a></li>
<li class="chapter" data-level="4.4.11" data-path="demand.html"><a href="demand.html#vertical-product-differentiation"><i class="fa fa-check"></i><b>4.4.11</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.12" data-path="demand.html"><a href="demand.html#vertical-product-differentiation-1"><i class="fa fa-check"></i><b>4.4.12</b> Vertical Product Differentiation</a></li>
<li class="chapter" data-level="4.4.13" data-path="demand.html"><a href="demand.html#econometric-models"><i class="fa fa-check"></i><b>4.4.13</b> Econometric Models</a></li>
<li class="chapter" data-level="4.4.14" data-path="demand.html"><a href="demand.html#multinomial-logit-model-preference-shock"><i class="fa fa-check"></i><b>4.4.14</b> Multinomial Logit Model: Preference Shock</a></li>
<li class="chapter" data-level="4.4.15" data-path="demand.html"><a href="demand.html#multinomial-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.15</b> Multinomial Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.16" data-path="demand.html"><a href="demand.html#multinomial-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.16</b> Multinomial Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.17" data-path="demand.html"><a href="demand.html#multinomial-logit-model-inclusive-value"><i class="fa fa-check"></i><b>4.4.17</b> Multinomial Logit Model: Inclusive Value</a></li>
<li class="chapter" data-level="4.4.18" data-path="demand.html"><a href="demand.html#maximum-likelihood-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.18</b> Maximum Likelihood Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.19" data-path="demand.html"><a href="demand.html#nonlinear-least-square-estimation-of-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.19</b> Nonlinear Least Square Estimation of Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.20" data-path="demand.html"><a href="demand.html#iia-problem"><i class="fa fa-check"></i><b>4.4.20</b> IIA Problem</a></li>
<li class="chapter" data-level="4.4.21" data-path="demand.html"><a href="demand.html#blue-bus-and-red-bus-problem"><i class="fa fa-check"></i><b>4.4.21</b> Blue Bus and Red Bus Problem</a></li>
<li class="chapter" data-level="4.4.22" data-path="demand.html"><a href="demand.html#restrictive-price-elasticity"><i class="fa fa-check"></i><b>4.4.22</b> Restrictive Price Elasticity</a></li>
<li class="chapter" data-level="4.4.23" data-path="demand.html"><a href="demand.html#monotonic-inclusive-value"><i class="fa fa-check"></i><b>4.4.23</b> Monotonic Inclusive Value</a></li>
<li class="chapter" data-level="4.4.24" data-path="demand.html"><a href="demand.html#the-source-of-the-problem"><i class="fa fa-check"></i><b>4.4.24</b> The Source of the Problem</a></li>
<li class="chapter" data-level="4.4.25" data-path="demand.html"><a href="demand.html#correlation-in-preference-shocks"><i class="fa fa-check"></i><b>4.4.25</b> Correlation in Preference Shocks</a></li>
<li class="chapter" data-level="4.4.26" data-path="demand.html"><a href="demand.html#observed-and-unobserved-consumer-heterogeneity"><i class="fa fa-check"></i><b>4.4.26</b> Observed and Unobserved Consumer Heterogeneity</a></li>
<li class="chapter" data-level="4.4.27" data-path="demand.html"><a href="demand.html#mixed-logit-model"><i class="fa fa-check"></i><b>4.4.27</b> Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.28" data-path="demand.html"><a href="demand.html#mixed-logit-model-parametric-assumptions"><i class="fa fa-check"></i><b>4.4.28</b> Mixed Logit Model : Parametric Assumptions</a></li>
<li class="chapter" data-level="4.4.29" data-path="demand.html"><a href="demand.html#mixed-logit-model-iia"><i class="fa fa-check"></i><b>4.4.29</b> Mixed Logit Model: IIA</a></li>
<li class="chapter" data-level="4.4.30" data-path="demand.html"><a href="demand.html#mixed-logit-moel-price-elasticities"><i class="fa fa-check"></i><b>4.4.30</b> Mixed Logit Moel: Price Elasticities</a></li>
<li class="chapter" data-level="4.4.31" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.31</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.32" data-path="demand.html"><a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model-1"><i class="fa fa-check"></i><b>4.4.32</b> Simulated Maximum Likelihood Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.33" data-path="demand.html"><a href="demand.html#simulated-non-linear-least-square-estimation-of-the-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.33</b> Simulated Non-linear Least Square Estimation of the Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.34" data-path="demand.html"><a href="demand.html#numerical-integration-with-quadrature"><i class="fa fa-check"></i><b>4.4.34</b> Numerical Integration with Quadrature</a></li>
<li class="chapter" data-level="4.4.35" data-path="demand.html"><a href="demand.html#nested-logit-model-a-special-case-of-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.35</b> Nested Logit Model: A Special Case of Mixed Logit Model</a></li>
<li class="chapter" data-level="4.4.36" data-path="demand.html"><a href="demand.html#nested-logit-model-distributional-assumption"><i class="fa fa-check"></i><b>4.4.36</b> Nested Logit Model: Distributional Assumption</a></li>
<li class="chapter" data-level="4.4.37" data-path="demand.html"><a href="demand.html#nested-logit-model-choice-probability"><i class="fa fa-check"></i><b>4.4.37</b> Nested Logit Model: Choice Probability</a></li>
<li class="chapter" data-level="4.4.38" data-path="demand.html"><a href="demand.html#nested-logit-model-decomposition-of-the-choice-probability"><i class="fa fa-check"></i><b>4.4.38</b> Nested Logit Model: Decomposition of the Choice Probability</a></li>
<li class="chapter" data-level="4.4.39" data-path="demand.html"><a href="demand.html#nested-logit-mode-outside-inside-category-and-category-specific-shares"><i class="fa fa-check"></i><b>4.4.39</b> Nested Logit Mode: Outside, Inside-Category, and Category-specific Shares</a></li>
<li class="chapter" data-level="4.4.40" data-path="demand.html"><a href="demand.html#nonlinear-least-square-estimation-of-nested-logit-model"><i class="fa fa-check"></i><b>4.4.40</b> Nonlinear Least Square Estimation of Nested Logit Model</a></li>
<li class="chapter" data-level="4.4.41" data-path="demand.html"><a href="demand.html#discrete-choice-model-with-unobserved-fixed-effects"><i class="fa fa-check"></i><b>4.4.41</b> Discrete Choice Model with Unobserved Fixed Effects</a></li>
<li class="chapter" data-level="4.4.42" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.42</b> Unobserved Fixed Effects in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.43" data-path="demand.html"><a href="demand.html#instrumental-variables-and-inversion"><i class="fa fa-check"></i><b>4.4.43</b> Instrumental Variables and Inversion</a></li>
<li class="chapter" data-level="4.4.44" data-path="demand.html"><a href="demand.html#inversion-in-multinomial-logit-model"><i class="fa fa-check"></i><b>4.4.44</b> Inversion in Multinomial Logit Model</a></li>
<li class="chapter" data-level="4.4.45" data-path="demand.html"><a href="demand.html#market-invariant-product-specific-fixed-effects"><i class="fa fa-check"></i><b>4.4.45</b> Market-invariant Product-specific Fixed Effects</a></li>
<li class="chapter" data-level="4.4.46" data-path="demand.html"><a href="demand.html#unobserved-consumer-heterogeneity-and-unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.46</b> Unobserved Consumer Heterogeneity and Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.47" data-path="demand.html"><a href="demand.html#unobserved-fixed-effects-in-mixed-logit-model"><i class="fa fa-check"></i><b>4.4.47</b> Unobserved Fixed Effects in Mixed-logit Model</a></li>
<li class="chapter" data-level="4.4.48" data-path="demand.html"><a href="demand.html#representing-xi_jt-as-a-function-of-parameters-of-interest"><i class="fa fa-check"></i><b>4.4.48</b> Representing <span class="math inline">\(\xi_{jt}\)</span> as a Function of Parameters of Interest</a></li>
<li class="chapter" data-level="4.4.49" data-path="demand.html"><a href="demand.html#summarizing-the-conditional-mean-term"><i class="fa fa-check"></i><b>4.4.49</b> Summarizing the Conditional Mean Term</a></li>
<li class="chapter" data-level="4.4.50" data-path="demand.html"><a href="demand.html#contraction-mapping-for-delta_t."><i class="fa fa-check"></i><b>4.4.50</b> Contraction Mapping for <span class="math inline">\(\delta_t\)</span>.</a></li>
<li class="chapter" data-level="4.4.51" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta"><i class="fa fa-check"></i><b>4.4.51</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span></a></li>
<li class="chapter" data-level="4.4.52" data-path="demand.html"><a href="demand.html#solving-for-xi_jttheta-summary"><i class="fa fa-check"></i><b>4.4.52</b> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span>: Summary</a></li>
<li class="chapter" data-level="4.4.53" data-path="demand.html"><a href="demand.html#gmm-objective-function"><i class="fa fa-check"></i><b>4.4.53</b> GMM Objective Function</a></li>
<li class="chapter" data-level="4.4.54" data-path="demand.html"><a href="demand.html#estimating-linear-parameters"><i class="fa fa-check"></i><b>4.4.54</b> Estimating Linear Parameters</a></li>
<li class="chapter" data-level="4.4.55" data-path="demand.html"><a href="demand.html#blp-algorithm"><i class="fa fa-check"></i><b>4.4.55</b> BLP Algorithm</a></li>
<li class="chapter" data-level="4.4.56" data-path="demand.html"><a href="demand.html#mathematical-program-with-equilibrium-constraints-mpec"><i class="fa fa-check"></i><b>4.4.56</b> Mathematical Program with Equilibrium Constraints (MPEC)</a></li>
<li class="chapter" data-level="4.4.57" data-path="demand.html"><a href="demand.html#control-function-approach"><i class="fa fa-check"></i><b>4.4.57</b> Control Function Approach</a></li>
<li class="chapter" data-level="4.4.58" data-path="demand.html"><a href="demand.html#control-function-approach-1"><i class="fa fa-check"></i><b>4.4.58</b> Control Function Approach</a></li>
<li class="chapter" data-level="4.4.59" data-path="demand.html"><a href="demand.html#instrumental-variables"><i class="fa fa-check"></i><b>4.4.59</b> Instrumental Variables</a></li>
<li class="chapter" data-level="4.4.60" data-path="demand.html"><a href="demand.html#pyblp"><i class="fa fa-check"></i><b>4.4.60</b> PyBLP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="merger.html"><a href="merger.html"><i class="fa fa-check"></i><b>5</b> Merger Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="merger.html"><a href="merger.html#motivations-2"><i class="fa fa-check"></i><b>5.1</b> Motivations</a></li>
<li class="chapter" data-level="5.2" data-path="merger.html"><a href="merger.html#identification-of-conduct"><i class="fa fa-check"></i><b>5.2</b> Identification of Conduct</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="merger.html"><a href="merger.html#identification-of-conduct-1"><i class="fa fa-check"></i><b>5.2.1</b> Identification of Conduct</a></li>
<li class="chapter" data-level="5.2.2" data-path="merger.html"><a href="merger.html#marginal-revenue-function"><i class="fa fa-check"></i><b>5.2.2</b> Marginal Revenue Function</a></li>
<li class="chapter" data-level="5.2.3" data-path="merger.html"><a href="merger.html#first-order-condition"><i class="fa fa-check"></i><b>5.2.3</b> First-Order Condition</a></li>
<li class="chapter" data-level="5.2.4" data-path="merger.html"><a href="merger.html#linear-model"><i class="fa fa-check"></i><b>5.2.4</b> Linear Model</a></li>
<li class="chapter" data-level="5.2.5" data-path="merger.html"><a href="merger.html#pricing-equation"><i class="fa fa-check"></i><b>5.2.5</b> Pricing Equation</a></li>
<li class="chapter" data-level="5.2.6" data-path="merger.html"><a href="merger.html#identification-of-inverse-demand-function-and-pricing-equation"><i class="fa fa-check"></i><b>5.2.6</b> Identification of Inverse Demand Function and Pricing Equation</a></li>
<li class="chapter" data-level="5.2.7" data-path="merger.html"><a href="merger.html#the-conduct-parameter-is-unidentified"><i class="fa fa-check"></i><b>5.2.7</b> The Conduct Parameter is Unidentified</a></li>
<li class="chapter" data-level="5.2.8" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-when-cost-data-is-available"><i class="fa fa-check"></i><b>5.2.8</b> Identification of the Conduct Parameter: When Cost Data is Available</a></li>
<li class="chapter" data-level="5.2.9" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-when-cost-data-is-not-available"><i class="fa fa-check"></i><b>5.2.9</b> Identification of the Conduct Parameter: When Cost Data is Not Available</a></li>
<li class="chapter" data-level="5.2.10" data-path="merger.html"><a href="merger.html#identification-of-the-conduct-parameter-demand-rotater-is-available"><i class="fa fa-check"></i><b>5.2.10</b> Identification of the Conduct Parameter: Demand Rotater is Available</a></li>
<li class="chapter" data-level="5.2.11" data-path="merger.html"><a href="merger.html#identification-of-conduct-in-differentiated-product-market"><i class="fa fa-check"></i><b>5.2.11</b> Identification of Conduct in Differentiated Product Market</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="merger.html"><a href="merger.html#merger-simulation"><i class="fa fa-check"></i><b>5.3</b> Merger Simulation</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="merger.html"><a href="merger.html#unilateral-and-coordinated-effects-of-a-horizontal-merger"><i class="fa fa-check"></i><b>5.3.1</b> Unilateral and Coordinated Effects of a Horizontal Merger</a></li>
<li class="chapter" data-level="5.3.2" data-path="merger.html"><a href="merger.html#merger-simulation-1"><i class="fa fa-check"></i><b>5.3.2</b> Merger Simulation</a></li>
<li class="chapter" data-level="5.3.3" data-path="merger.html"><a href="merger.html#quantifying-the-unilateral-effect"><i class="fa fa-check"></i><b>5.3.3</b> Quantifying the Unilateral Effect</a></li>
<li class="chapter" data-level="5.3.4" data-path="merger.html"><a href="merger.html#pre-merger-equilibrium"><i class="fa fa-check"></i><b>5.3.4</b> Pre-Merger Equilibrium</a></li>
<li class="chapter" data-level="5.3.5" data-path="merger.html"><a href="merger.html#post-merger-equilibrium"><i class="fa fa-check"></i><b>5.3.5</b> Post-Merger Equilibrium</a></li>
<li class="chapter" data-level="5.3.6" data-path="merger.html"><a href="merger.html#consumer-surplus"><i class="fa fa-check"></i><b>5.3.6</b> Consumer Surplus</a></li>
<li class="chapter" data-level="5.3.7" data-path="merger.html"><a href="merger.html#quantifying-the-coordinated-effect"><i class="fa fa-check"></i><b>5.3.7</b> Quantifying the Coordinated Effect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="entryexit.html"><a href="entryexit.html"><i class="fa fa-check"></i><b>6</b> Entry and Exit</a>
<ul>
<li class="chapter" data-level="6.1" data-path="entryexit.html"><a href="entryexit.html#motivations-3"><i class="fa fa-check"></i><b>6.1</b> Motivations</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="entryexit.html"><a href="entryexit.html#entry-cost-mode-of-competition-and-market-structure"><i class="fa fa-check"></i><b>6.1.1</b> Entry Cost, Mode of Competition, and Market Structure</a></li>
<li class="chapter" data-level="6.1.2" data-path="entryexit.html"><a href="entryexit.html#exogenous-and-endogenous-entry-cost"><i class="fa fa-check"></i><b>6.1.2</b> Exogenous and Endogenous Entry Cost</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="entryexit.html"><a href="entryexit.html#monopoly-entry"><i class="fa fa-check"></i><b>6.2</b> Monopoly Entry</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="entryexit.html"><a href="entryexit.html#variable-profits-and-fixed-costs"><i class="fa fa-check"></i><b>6.2.1</b> Variable Profits and Fixed Costs</a></li>
<li class="chapter" data-level="6.2.2" data-path="entryexit.html"><a href="entryexit.html#non-identification"><i class="fa fa-check"></i><b>6.2.2</b> Non-Identification</a></li>
<li class="chapter" data-level="6.2.3" data-path="entryexit.html"><a href="entryexit.html#restrictions-for-identification."><i class="fa fa-check"></i><b>6.2.3</b> Restrictions for Identification.</a></li>
<li class="chapter" data-level="6.2.4" data-path="entryexit.html"><a href="entryexit.html#homogeneous-of-degree-1-variable-profits"><i class="fa fa-check"></i><b>6.2.4</b> Homogeneous of Degree 1 Variable Profits</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="entryexit.html"><a href="entryexit.html#complete-information-homogeneous-oligopoly-entry"><i class="fa fa-check"></i><b>6.3</b> Complete-Information Homogeneous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="entryexit.html"><a href="entryexit.html#variable-and-fixed-costs"><i class="fa fa-check"></i><b>6.3.1</b> Variable and Fixed Costs</a></li>
<li class="chapter" data-level="6.3.2" data-path="entryexit.html"><a href="entryexit.html#equilibrium-condition"><i class="fa fa-check"></i><b>6.3.2</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="6.3.3" data-path="entryexit.html"><a href="entryexit.html#identification-under-a-shape-restriction"><i class="fa fa-check"></i><b>6.3.3</b> Identification under a Shape Restriction</a></li>
<li class="chapter" data-level="6.3.4" data-path="entryexit.html"><a href="entryexit.html#log-likelihood-function"><i class="fa fa-check"></i><b>6.3.4</b> Log Likelihood Function</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="entryexit.html"><a href="entryexit.html#complete-information-heterogeneous-oligopoly-entry"><i class="fa fa-check"></i><b>6.4</b> Complete-Information Heterogeneous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="entryexit.html"><a href="entryexit.html#bivartiate-game-with-heterogeneous-profits"><i class="fa fa-check"></i><b>6.4.1</b> Bivartiate Game with Heterogeneous Profits</a></li>
<li class="chapter" data-level="6.4.2" data-path="entryexit.html"><a href="entryexit.html#sampling-assumption-and-observations"><i class="fa fa-check"></i><b>6.4.2</b> Sampling Assumption and Observations</a></li>
<li class="chapter" data-level="6.4.3" data-path="entryexit.html"><a href="entryexit.html#identification-assuming-pure-strategy-equilibrium"><i class="fa fa-check"></i><b>6.4.3</b> Identification Assuming Pure-Strategy Equilibrium</a></li>
<li class="chapter" data-level="6.4.4" data-path="entryexit.html"><a href="entryexit.html#heterogeneous-independent-fixed-costs"><i class="fa fa-check"></i><b>6.4.4</b> Heterogeneous Independent Fixed Costs</a></li>
<li class="chapter" data-level="6.4.5" data-path="entryexit.html"><a href="entryexit.html#heterogenous-and-market-level-correlated-fixed-costs"><i class="fa fa-check"></i><b>6.4.5</b> Heterogenous and Market-Level Correlated Fixed Costs</a></li>
<li class="chapter" data-level="6.4.6" data-path="entryexit.html"><a href="entryexit.html#inference-based-on-a-unique-prediction"><i class="fa fa-check"></i><b>6.4.6</b> Inference Based On a Unique Prediction</a></li>
<li class="chapter" data-level="6.4.7" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-one-shot-game"><i class="fa fa-check"></i><b>6.4.7</b> Entry in the Airline Industry: One-shot Game</a></li>
<li class="chapter" data-level="6.4.8" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-profit-function"><i class="fa fa-check"></i><b>6.4.8</b> Entry in the Airline Industry: Profit Function</a></li>
<li class="chapter" data-level="6.4.9" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-profit-function-1"><i class="fa fa-check"></i><b>6.4.9</b> Entry in the Airline Industry: Profit Function</a></li>
<li class="chapter" data-level="6.4.10" data-path="entryexit.html"><a href="entryexit.html#entry-in-the-airline-industry-likelihood-function"><i class="fa fa-check"></i><b>6.4.10</b> Entry in the Airline Industry: Likelihood Function</a></li>
<li class="chapter" data-level="6.4.11" data-path="entryexit.html"><a href="entryexit.html#is-the-equilibrium-number-of-firms-unique"><i class="fa fa-check"></i><b>6.4.11</b> Is the Equilibrium Number of Firms Unique?</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="entryexit.html"><a href="entryexit.html#multiple-prediction"><i class="fa fa-check"></i><b>6.5</b> Multiple Prediction</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="entryexit.html"><a href="entryexit.html#multiple-equilibria-in-bivariate-game-with-heterogenous-profits"><i class="fa fa-check"></i><b>6.5.1</b> Multiple Equilibria in Bivariate Game with Heterogenous Profits</a></li>
<li class="chapter" data-level="6.5.2" data-path="entryexit.html"><a href="entryexit.html#multiple-prediction-in-bivariate-game-with-heterogenous-profits"><i class="fa fa-check"></i><b>6.5.2</b> Multiple Prediction in Bivariate Game with Heterogenous Profits</a></li>
<li class="chapter" data-level="6.5.3" data-path="entryexit.html"><a href="entryexit.html#inference-based-on-moment-inequalities"><i class="fa fa-check"></i><b>6.5.3</b> Inference Based on Moment Inequalities</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="entryexit.html"><a href="entryexit.html#incompelete-information-heterogenous-oligopoly-entry"><i class="fa fa-check"></i><b>6.6</b> Incompelete-Information Heterogenous Oligopoly Entry</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="entryexit.html"><a href="entryexit.html#bivariate-case"><i class="fa fa-check"></i><b>6.6.1</b> Bivariate Case</a></li>
<li class="chapter" data-level="6.6.2" data-path="entryexit.html"><a href="entryexit.html#the-equilibrium-strategy-and-belief"><i class="fa fa-check"></i><b>6.6.2</b> The Equilibrium Strategy and Belief</a></li>
<li class="chapter" data-level="6.6.3" data-path="entryexit.html"><a href="entryexit.html#equilibrium-selection-and-likelihood"><i class="fa fa-check"></i><b>6.6.3</b> Equilibrium Selection and Likelihood</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dynamics.html"><a href="dynamics.html"><i class="fa fa-check"></i><b>7</b> Dynamic Decision Model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dynamics.html"><a href="dynamics.html#motivations-4"><i class="fa fa-check"></i><b>7.1</b> Motivations</a></li>
<li class="chapter" data-level="7.2" data-path="dynamics.html"><a href="dynamics.html#single-agent-model"><i class="fa fa-check"></i><b>7.2</b> Single-Agent Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="dynamics.html"><a href="dynamics.html#setting"><i class="fa fa-check"></i><b>7.2.1</b> Setting</a></li>
<li class="chapter" data-level="7.2.2" data-path="dynamics.html"><a href="dynamics.html#timing-of-the-model"><i class="fa fa-check"></i><b>7.2.2</b> Timing of the Model</a></li>
<li class="chapter" data-level="7.2.3" data-path="dynamics.html"><a href="dynamics.html#period-payoff"><i class="fa fa-check"></i><b>7.2.3</b> Period Payoff</a></li>
<li class="chapter" data-level="7.2.4" data-path="dynamics.html"><a href="dynamics.html#markovian-framework"><i class="fa fa-check"></i><b>7.2.4</b> Markovian Framework</a></li>
<li class="chapter" data-level="7.2.5" data-path="dynamics.html"><a href="dynamics.html#belief"><i class="fa fa-check"></i><b>7.2.5</b> Belief</a></li>
<li class="chapter" data-level="7.2.6" data-path="dynamics.html"><a href="dynamics.html#decision-problem"><i class="fa fa-check"></i><b>7.2.6</b> Decision Problem</a></li>
<li class="chapter" data-level="7.2.7" data-path="dynamics.html"><a href="dynamics.html#value-function-and-ex-ante-value-function"><i class="fa fa-check"></i><b>7.2.7</b> Value Function and Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.2.8" data-path="dynamics.html"><a href="dynamics.html#choice-specific-value-function"><i class="fa fa-check"></i><b>7.2.8</b> Choice-specific Value Function</a></li>
<li class="chapter" data-level="7.2.9" data-path="dynamics.html"><a href="dynamics.html#optimality-condition"><i class="fa fa-check"></i><b>7.2.9</b> Optimality Condition</a></li>
<li class="chapter" data-level="7.2.10" data-path="dynamics.html"><a href="dynamics.html#optimal-conditional-choice-probability"><i class="fa fa-check"></i><b>7.2.10</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.2.11" data-path="dynamics.html"><a href="dynamics.html#optimality-condition-1"><i class="fa fa-check"></i><b>7.2.11</b> Optimality Condition</a></li>
<li class="chapter" data-level="7.2.12" data-path="dynamics.html"><a href="dynamics.html#mapping-from-a-conditional-choice-probability-to-an-ex-ante-value-function"><i class="fa fa-check"></i><b>7.2.12</b> Mapping from a Conditional Choice Probability to an Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.2.13" data-path="dynamics.html"><a href="dynamics.html#mapping-from-an-ex-ante-value-function-to-an-optimal-conditional-choice-probability"><i class="fa fa-check"></i><b>7.2.13</b> Mapping from an Ex-ante Value Function to an Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.2.14" data-path="dynamics.html"><a href="dynamics.html#the-optimality-conditions"><i class="fa fa-check"></i><b>7.2.14</b> The Optimality Conditions</a></li>
<li class="chapter" data-level="7.2.15" data-path="dynamics.html"><a href="dynamics.html#fixed-point-algorithm"><i class="fa fa-check"></i><b>7.2.15</b> Fixed-point Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="dynamics.html"><a href="dynamics.html#identification"><i class="fa fa-check"></i><b>7.3</b> Identification</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="dynamics.html"><a href="dynamics.html#unidentification-result"><i class="fa fa-check"></i><b>7.3.1</b> Unidentification Result</a></li>
<li class="chapter" data-level="7.3.2" data-path="dynamics.html"><a href="dynamics.html#identification-when-beta-and-f-is-known"><i class="fa fa-check"></i><b>7.3.2</b> Identification when <span class="math inline">\(\beta\)</span> and <span class="math inline">\(F\)</span> is Known</a></li>
<li class="chapter" data-level="7.3.3" data-path="dynamics.html"><a href="dynamics.html#crucial-assumptions-for-the-argument"><i class="fa fa-check"></i><b>7.3.3</b> Crucial Assumptions for the Argument</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="dynamics.html"><a href="dynamics.html#estimation-by-nested-fixed-point-algorithm"><i class="fa fa-check"></i><b>7.4</b> Estimation by Nested Fixed-point Algorithm</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="dynamics.html"><a href="dynamics.html#nested-fixed-point-algorithm"><i class="fa fa-check"></i><b>7.4.1</b> Nested Fixed-Point Algorithm</a></li>
<li class="chapter" data-level="7.4.2" data-path="dynamics.html"><a href="dynamics.html#solving-for-the-ex-ante-value-function"><i class="fa fa-check"></i><b>7.4.2</b> Solving for the Ex-ante Value Function</a></li>
<li class="chapter" data-level="7.4.3" data-path="dynamics.html"><a href="dynamics.html#estimation-by-nested-fixed-point-algorithm-1"><i class="fa fa-check"></i><b>7.4.3</b> Estimation by Nested Fixed-Point Algorithm</a></li>
<li class="chapter" data-level="7.4.4" data-path="dynamics.html"><a href="dynamics.html#full-and-partial-likelihood"><i class="fa fa-check"></i><b>7.4.4</b> Full and Partial Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="dynamics.html"><a href="dynamics.html#estimation-by-conditional-choice-probability-ccp-approach"><i class="fa fa-check"></i><b>7.5</b> Estimation by Conditional Choice Probability (CCP) Approach</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="dynamics.html"><a href="dynamics.html#ccp-approach"><i class="fa fa-check"></i><b>7.5.1</b> CCP Approach</a></li>
<li class="chapter" data-level="7.5.2" data-path="dynamics.html"><a href="dynamics.html#first-step-estimating-ccp"><i class="fa fa-check"></i><b>7.5.2</b> First Step: Estimating CCP</a></li>
<li class="chapter" data-level="7.5.3" data-path="dynamics.html"><a href="dynamics.html#first-step-estimating-ccp-1"><i class="fa fa-check"></i><b>7.5.3</b> First Step: Estimating CCP</a></li>
<li class="chapter" data-level="7.5.4" data-path="dynamics.html"><a href="dynamics.html#second-step-estimating-structural-parameters"><i class="fa fa-check"></i><b>7.5.4</b> Second Step: Estimating Structural Parameters</a></li>
<li class="chapter" data-level="7.5.5" data-path="dynamics.html"><a href="dynamics.html#second-step-estimating-structural-parameters-1"><i class="fa fa-check"></i><b>7.5.5</b> Second Step: Estimating Structural Parameters</a></li>
<li class="chapter" data-level="7.5.6" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution"><i class="fa fa-check"></i><b>7.5.6</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.7" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-1"><i class="fa fa-check"></i><b>7.5.7</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.8" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-2"><i class="fa fa-check"></i><b>7.5.8</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.9" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-3"><i class="fa fa-check"></i><b>7.5.9</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.10" data-path="dynamics.html"><a href="dynamics.html#type-i-extreme-value-distribution-4"><i class="fa fa-check"></i><b>7.5.10</b> Type-I Extreme Value Distribution</a></li>
<li class="chapter" data-level="7.5.11" data-path="dynamics.html"><a href="dynamics.html#general-distribution"><i class="fa fa-check"></i><b>7.5.11</b> General Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="dynamics.html"><a href="dynamics.html#unobserved-heterogeneity"><i class="fa fa-check"></i><b>7.6</b> Unobserved Heterogeneity</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="dynamics.html"><a href="dynamics.html#dynamic-decision-model-with-a-finite-mixture"><i class="fa fa-check"></i><b>7.6.1</b> Dynamic Decision Model with a Finite Mixture</a></li>
<li class="chapter" data-level="7.6.2" data-path="dynamics.html"><a href="dynamics.html#setting-1"><i class="fa fa-check"></i><b>7.6.2</b> Setting</a></li>
<li class="chapter" data-level="7.6.3" data-path="dynamics.html"><a href="dynamics.html#observation"><i class="fa fa-check"></i><b>7.6.3</b> Observation</a></li>
<li class="chapter" data-level="7.6.4" data-path="dynamics.html"><a href="dynamics.html#assumptions-finite-mixture"><i class="fa fa-check"></i><b>7.6.4</b> Further Assumptions</a></li>
<li class="chapter" data-level="7.6.5" data-path="dynamics.html"><a href="dynamics.html#lower-dimensional-submodels"><i class="fa fa-check"></i><b>7.6.5</b> Lower-dimensional Submodels</a></li>
<li class="chapter" data-level="7.6.6" data-path="dynamics.html"><a href="dynamics.html#notations"><i class="fa fa-check"></i><b>7.6.6</b> Notations</a></li>
<li class="chapter" data-level="7.6.7" data-path="dynamics.html"><a href="dynamics.html#notations-for-parameters-to-be-identified"><i class="fa fa-check"></i><b>7.6.7</b> Notations for Parameters to be Identified</a></li>
<li class="chapter" data-level="7.6.8" data-path="dynamics.html"><a href="dynamics.html#notations-for-observables"><i class="fa fa-check"></i><b>7.6.8</b> Notations for Observables</a></li>
<li class="chapter" data-level="7.6.9" data-path="dynamics.html"><a href="dynamics.html#sufficient-condition-for-identification"><i class="fa fa-check"></i><b>7.6.9</b> Sufficient Condition for Identification</a></li>
<li class="chapter" data-level="7.6.10" data-path="dynamics.html"><a href="dynamics.html#remarks-on-the-theorem"><i class="fa fa-check"></i><b>7.6.10</b> Remarks on the Theorem</a></li>
<li class="chapter" data-level="7.6.11" data-path="dynamics.html"><a href="dynamics.html#factorization-equations"><i class="fa fa-check"></i><b>7.6.11</b> Factorization Equations</a></li>
<li class="chapter" data-level="7.6.12" data-path="dynamics.html"><a href="dynamics.html#sketch-of-the-proof"><i class="fa fa-check"></i><b>7.6.12</b> Sketch of the Proof</a></li>
<li class="chapter" data-level="7.6.13" data-path="dynamics.html"><a href="dynamics.html#constructive-estimation"><i class="fa fa-check"></i><b>7.6.13</b> Constructive Estimation</a></li>
<li class="chapter" data-level="7.6.14" data-path="dynamics.html"><a href="dynamics.html#estimation-by-an-em-algorithm"><i class="fa fa-check"></i><b>7.6.14</b> Estimation by an EM Algorithm</a></li>
<li class="chapter" data-level="7.6.15" data-path="dynamics.html"><a href="dynamics.html#idea"><i class="fa fa-check"></i><b>7.6.15</b> Idea</a></li>
<li class="chapter" data-level="7.6.16" data-path="dynamics.html"><a href="dynamics.html#optimal-conditional-choice-probability-1"><i class="fa fa-check"></i><b>7.6.16</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="7.6.17" data-path="dynamics.html"><a href="dynamics.html#likelihood-functions"><i class="fa fa-check"></i><b>7.6.17</b> Likelihood Functions</a></li>
<li class="chapter" data-level="7.6.18" data-path="dynamics.html"><a href="dynamics.html#expectation-step"><i class="fa fa-check"></i><b>7.6.18</b> Expectation Step</a></li>
<li class="chapter" data-level="7.6.19" data-path="dynamics.html"><a href="dynamics.html#maximization-step"><i class="fa fa-check"></i><b>7.6.19</b> Maximization Step</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="dynamicgame.html"><a href="dynamicgame.html"><i class="fa fa-check"></i><b>8</b> Dynamic Game</a>
<ul>
<li class="chapter" data-level="8.1" data-path="dynamicgame.html"><a href="dynamicgame.html#multiple-agent-model"><i class="fa fa-check"></i><b>8.1</b> Multiple-Agent Model</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-2"><i class="fa fa-check"></i><b>8.1.1</b> Setting</a></li>
<li class="chapter" data-level="8.1.2" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-model-1"><i class="fa fa-check"></i><b>8.1.2</b> Timing of the Model</a></li>
<li class="chapter" data-level="8.1.3" data-path="dynamicgame.html"><a href="dynamicgame.html#period-profit"><i class="fa fa-check"></i><b>8.1.3</b> Period Profit</a></li>
<li class="chapter" data-level="8.1.4" data-path="dynamicgame.html"><a href="dynamicgame.html#belief-1"><i class="fa fa-check"></i><b>8.1.4</b> Belief</a></li>
<li class="chapter" data-level="8.1.5" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium"><i class="fa fa-check"></i><b>8.1.5</b> Markov Perfect Equilibrium</a></li>
<li class="chapter" data-level="8.1.6" data-path="dynamicgame.html"><a href="dynamicgame.html#ex-ante-value-function"><i class="fa fa-check"></i><b>8.1.6</b> Ex-ante Value Function</a></li>
<li class="chapter" data-level="8.1.7" data-path="dynamicgame.html"><a href="dynamicgame.html#choice-specific-value-function-1"><i class="fa fa-check"></i><b>8.1.7</b> Choice-specific Value Function</a></li>
<li class="chapter" data-level="8.1.8" data-path="dynamicgame.html"><a href="dynamicgame.html#optimality-condition-2"><i class="fa fa-check"></i><b>8.1.8</b> Optimality Condition</a></li>
<li class="chapter" data-level="8.1.9" data-path="dynamicgame.html"><a href="dynamicgame.html#optimal-conditional-choice-probability-2"><i class="fa fa-check"></i><b>8.1.9</b> Optimal Conditional Choice Probability</a></li>
<li class="chapter" data-level="8.1.10" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium-condition-1"><i class="fa fa-check"></i><b>8.1.10</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="8.1.11" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium-condition-2"><i class="fa fa-check"></i><b>8.1.11</b> Equilibrium Condition</a></li>
<li class="chapter" data-level="8.1.12" data-path="dynamicgame.html"><a href="dynamicgame.html#single-path-of-play"><i class="fa fa-check"></i><b>8.1.12</b> Single Path of Play</a></li>
<li class="chapter" data-level="8.1.13" data-path="dynamicgame.html"><a href="dynamicgame.html#identification-1"><i class="fa fa-check"></i><b>8.1.13</b> Identification</a></li>
<li class="chapter" data-level="8.1.14" data-path="dynamicgame.html"><a href="dynamicgame.html#estimation-ccp-approach"><i class="fa fa-check"></i><b>8.1.14</b> Estimation: CCP Approach</a></li>
<li class="chapter" data-level="8.1.15" data-path="dynamicgame.html"><a href="dynamicgame.html#computing-psi"><i class="fa fa-check"></i><b>8.1.15</b> Computing <span class="math inline">\(\Psi\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="dynamicgame.html"><a href="dynamicgame.html#with-continuous-dynamic-choice"><i class="fa fa-check"></i><b>8.2</b> With Continuous Dynamic Choice</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="dynamicgame.html"><a href="dynamicgame.html#continuous-control"><i class="fa fa-check"></i><b>8.2.1</b> Continuous Control</a></li>
<li class="chapter" data-level="8.2.2" data-path="dynamicgame.html"><a href="dynamicgame.html#period-payoff-1"><i class="fa fa-check"></i><b>8.2.2</b> Period Payoff</a></li>
<li class="chapter" data-level="8.2.3" data-path="dynamicgame.html"><a href="dynamicgame.html#policy-function-estimation-with-continuous-control"><i class="fa fa-check"></i><b>8.2.3</b> Policy Function Estimation with Continuous Control</a></li>
<li class="chapter" data-level="8.2.4" data-path="dynamicgame.html"><a href="dynamicgame.html#converting-to-the-standard-discrete-choice-model"><i class="fa fa-check"></i><b>8.2.4</b> Converting to the Standard Discrete Choice Model</a></li>
<li class="chapter" data-level="8.2.5" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-based-ccp-approach"><i class="fa fa-check"></i><b>8.2.5</b> Value Function Based CCP Approach</a></li>
<li class="chapter" data-level="8.2.6" data-path="dynamicgame.html"><a href="dynamicgame.html#approximating-the-ex-ante-value-function"><i class="fa fa-check"></i><b>8.2.6</b> Approximating the Ex-ante Value Function</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="dynamicgame.html"><a href="dynamicgame.html#dynamic-oligopoly-model"><i class="fa fa-check"></i><b>8.3</b> Dynamic Oligopoly Model</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="dynamicgame.html"><a href="dynamicgame.html#ryancostenvironmentregulation2012"><i class="fa fa-check"></i><b>8.3.1</b> <span class="citation">Ryan (2012)</span></a></li>
<li class="chapter" data-level="8.3.2" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-3"><i class="fa fa-check"></i><b>8.3.2</b> Setting</a></li>
<li class="chapter" data-level="8.3.3" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-game"><i class="fa fa-check"></i><b>8.3.3</b> Timing of the Game</a></li>
<li class="chapter" data-level="8.3.4" data-path="dynamicgame.html"><a href="dynamicgame.html#demand-function"><i class="fa fa-check"></i><b>8.3.4</b> Demand Function</a></li>
<li class="chapter" data-level="8.3.5" data-path="dynamicgame.html"><a href="dynamicgame.html#production-cost-function"><i class="fa fa-check"></i><b>8.3.5</b> Production Cost Function</a></li>
<li class="chapter" data-level="8.3.6" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-cost"><i class="fa fa-check"></i><b>8.3.6</b> Investment Cost</a></li>
<li class="chapter" data-level="8.3.7" data-path="dynamicgame.html"><a href="dynamicgame.html#entry-and-exit-costs"><i class="fa fa-check"></i><b>8.3.7</b> Entry and Exit Costs</a></li>
<li class="chapter" data-level="8.3.8" data-path="dynamicgame.html"><a href="dynamicgame.html#period-profit-function"><i class="fa fa-check"></i><b>8.3.8</b> Period Profit Function</a></li>
<li class="chapter" data-level="8.3.9" data-path="dynamicgame.html"><a href="dynamicgame.html#transition"><i class="fa fa-check"></i><b>8.3.9</b> Transition</a></li>
<li class="chapter" data-level="8.3.10" data-path="dynamicgame.html"><a href="dynamicgame.html#equilibrium"><i class="fa fa-check"></i><b>8.3.10</b> Equilibrium</a></li>
<li class="chapter" data-level="8.3.11" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-for-incumbents"><i class="fa fa-check"></i><b>8.3.11</b> Value Function for Incumbents</a></li>
<li class="chapter" data-level="8.3.12" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function-for-entrants"><i class="fa fa-check"></i><b>8.3.12</b> Value Function for Entrants</a></li>
<li class="chapter" data-level="8.3.13" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium-1"><i class="fa fa-check"></i><b>8.3.13</b> Markov Perfect Equilibrium</a></li>
<li class="chapter" data-level="8.3.14" data-path="dynamicgame.html"><a href="dynamicgame.html#demand-and-production-cost-estimation"><i class="fa fa-check"></i><b>8.3.14</b> Demand and Production Cost Estimation</a></li>
<li class="chapter" data-level="8.3.15" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-policy-function-estimation"><i class="fa fa-check"></i><b>8.3.15</b> Investment Policy Function Estimation</a></li>
<li class="chapter" data-level="8.3.16" data-path="dynamicgame.html"><a href="dynamicgame.html#investment-policy-function-estimation-1"><i class="fa fa-check"></i><b>8.3.16</b> Investment Policy Function Estimation</a></li>
<li class="chapter" data-level="8.3.17" data-path="dynamicgame.html"><a href="dynamicgame.html#entry-and-exit-policy-functions"><i class="fa fa-check"></i><b>8.3.17</b> Entry and Exit Policy Functions</a></li>
<li class="chapter" data-level="8.3.18" data-path="dynamicgame.html"><a href="dynamicgame.html#bbl-estimation"><i class="fa fa-check"></i><b>8.3.18</b> BBL Estimation</a></li>
<li class="chapter" data-level="8.3.19" data-path="dynamicgame.html"><a href="dynamicgame.html#structural-parameters-estimation-results"><i class="fa fa-check"></i><b>8.3.19</b> Structural Parameters Estimation Results</a></li>
<li class="chapter" data-level="8.3.20" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation"><i class="fa fa-check"></i><b>8.3.20</b> Counterfactual Simulation</a></li>
<li class="chapter" data-level="8.3.21" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation-results"><i class="fa fa-check"></i><b>8.3.21</b> Counterfactual Simulation Results</a></li>
<li class="chapter" data-level="8.3.22" data-path="dynamicgame.html"><a href="dynamicgame.html#counterfactual-simulation-estimation-results"><i class="fa fa-check"></i><b>8.3.22</b> Counterfactual Simulation Estimation Results</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="dynamicgame.html"><a href="dynamicgame.html#dynamic-oligopoly-with-many-firms"><i class="fa fa-check"></i><b>8.4</b> Dynamic Oligopoly with Many Firms</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="dynamicgame.html"><a href="dynamicgame.html#setting-4"><i class="fa fa-check"></i><b>8.4.1</b> Setting</a></li>
<li class="chapter" data-level="8.4.2" data-path="dynamicgame.html"><a href="dynamicgame.html#timing-of-the-game-1"><i class="fa fa-check"></i><b>8.4.2</b> Timing of the Game</a></li>
<li class="chapter" data-level="8.4.3" data-path="dynamicgame.html"><a href="dynamicgame.html#assumptions"><i class="fa fa-check"></i><b>8.4.3</b> Assumptions</a></li>
<li class="chapter" data-level="8.4.4" data-path="dynamicgame.html"><a href="dynamicgame.html#strategy-profile"><i class="fa fa-check"></i><b>8.4.4</b> Strategy Profile</a></li>
<li class="chapter" data-level="8.4.5" data-path="dynamicgame.html"><a href="dynamicgame.html#value-function"><i class="fa fa-check"></i><b>8.4.5</b> Value Function</a></li>
<li class="chapter" data-level="8.4.6" data-path="dynamicgame.html"><a href="dynamicgame.html#markov-perfect-equilibrium-2"><i class="fa fa-check"></i><b>8.4.6</b> Markov-perfect Equilibrium</a></li>
<li class="chapter" data-level="8.4.7" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-strategy"><i class="fa fa-check"></i><b>8.4.7</b> Oblivious Strategy</a></li>
<li class="chapter" data-level="8.4.8" data-path="dynamicgame.html"><a href="dynamicgame.html#long-run-average-industry-state"><i class="fa fa-check"></i><b>8.4.8</b> Long-run Average Industry State</a></li>
<li class="chapter" data-level="8.4.9" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-value-function"><i class="fa fa-check"></i><b>8.4.9</b> Oblivious Value Function</a></li>
<li class="chapter" data-level="8.4.10" data-path="dynamicgame.html"><a href="dynamicgame.html#oblivious-equilibrium"><i class="fa fa-check"></i><b>8.4.10</b> Oblivious Equilibrium</a></li>
<li class="chapter" data-level="8.4.11" data-path="dynamicgame.html"><a href="dynamicgame.html#asymptotic-results-and-extensions"><i class="fa fa-check"></i><b>8.4.11</b> Asymptotic Results and Extensions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="auction.html"><a href="auction.html"><i class="fa fa-check"></i><b>9</b> Auction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="auction.html"><a href="auction.html#general-symmetric-information-model"><i class="fa fa-check"></i><b>9.1</b> General symmetric information model</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="auction.html"><a href="auction.html#setting-5"><i class="fa fa-check"></i><b>9.1.1</b> Setting</a></li>
<li class="chapter" data-level="9.1.2" data-path="auction.html"><a href="auction.html#discussion-about-the-asssumptions"><i class="fa fa-check"></i><b>9.1.2</b> Discussion About the Asssumptions</a></li>
<li class="chapter" data-level="9.1.3" data-path="auction.html"><a href="auction.html#bidding-strategy"><i class="fa fa-check"></i><b>9.1.3</b> Bidding Strategy</a></li>
<li class="chapter" data-level="9.1.4" data-path="auction.html"><a href="auction.html#special-cases"><i class="fa fa-check"></i><b>9.1.4</b> Special Cases</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="auction.html"><a href="auction.html#second-price-auctions"><i class="fa fa-check"></i><b>9.2</b> Second-Price Auctions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="auction.html"><a href="auction.html#the-button-auction"><i class="fa fa-check"></i><b>9.2.1</b> The Button Auction</a></li>
<li class="chapter" data-level="9.2.2" data-path="auction.html"><a href="auction.html#equilibrium-bidding-strategies"><i class="fa fa-check"></i><b>9.2.2</b> Equilibrium Bidding Strategies</a></li>
<li class="chapter" data-level="9.2.3" data-path="auction.html"><a href="auction.html#reserve-price"><i class="fa fa-check"></i><b>9.2.3</b> Reserve Price</a></li>
<li class="chapter" data-level="9.2.4" data-path="auction.html"><a href="auction.html#variations"><i class="fa fa-check"></i><b>9.2.4</b> Variations</a></li>
<li class="chapter" data-level="9.2.5" data-path="auction.html"><a href="auction.html#estimation-of-a-ipv-button-auction"><i class="fa fa-check"></i><b>9.2.5</b> Estimation of a IPV Button Auction</a></li>
<li class="chapter" data-level="9.2.6" data-path="auction.html"><a href="auction.html#likelihood-of-ipv-button-auction"><i class="fa fa-check"></i><b>9.2.6</b> Likelihood of IPV Button Auction</a></li>
<li class="chapter" data-level="9.2.7" data-path="auction.html"><a href="auction.html#optimal-reserve-price"><i class="fa fa-check"></i><b>9.2.7</b> Optimal Reserve Price</a></li>
<li class="chapter" data-level="9.2.8" data-path="auction.html"><a href="auction.html#likelihood-of-ipv-english-auction-with-bid-data"><i class="fa fa-check"></i><b>9.2.8</b> Likelihood of IPV English Auction with Bid Data</a></li>
<li class="chapter" data-level="9.2.9" data-path="auction.html"><a href="auction.html#observed-heterogeneity"><i class="fa fa-check"></i><b>9.2.9</b> Observed Heterogeneity</a></li>
<li class="chapter" data-level="9.2.10" data-path="auction.html"><a href="auction.html#identification-2"><i class="fa fa-check"></i><b>9.2.10</b> Identification</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="auction.html"><a href="auction.html#first-price-auctions"><i class="fa fa-check"></i><b>9.3</b> First-Price Auctions</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="auction.html"><a href="auction.html#first-price-sealed-bid-auction"><i class="fa fa-check"></i><b>9.3.1</b> First-Price Sealed Bid Auction</a></li>
<li class="chapter" data-level="9.3.2" data-path="auction.html"><a href="auction.html#equilibrium-bidding-strategies-1"><i class="fa fa-check"></i><b>9.3.2</b> Equilibrium Bidding Strategies</a></li>
<li class="chapter" data-level="9.3.3" data-path="auction.html"><a href="auction.html#maximum-likelihood-estimation-of-the-ipv-first-price-auction"><i class="fa fa-check"></i><b>9.3.3</b> Maximum Likelihood Estimation of the IPV First-Price Auction</a></li>
<li class="chapter" data-level="9.3.4" data-path="auction.html"><a href="auction.html#non-parametric-approach"><i class="fa fa-check"></i><b>9.3.4</b> Non-Parametric Approach</a></li>
<li class="chapter" data-level="9.3.5" data-path="auction.html"><a href="auction.html#non-parmaetric-approach-estimation"><i class="fa fa-check"></i><b>9.3.5</b> Non-Parmaetric Approach: Estimation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>10</b> Applications</a>
<ul>
<li class="chapter" data-level="10.1" data-path="applications.html"><a href="applications.html#section"><i class="fa fa-check"></i><b>10.1</b> 2018-2019</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="applications.html"><a href="applications.html#american-economic-review"><i class="fa fa-check"></i><b>10.1.1</b> American Economic Review</a></li>
<li class="chapter" data-level="10.1.2" data-path="applications.html"><a href="applications.html#econometrica"><i class="fa fa-check"></i><b>10.1.2</b> Econometrica</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="applications.html"><a href="applications.html#asymmetric-information-and-market-power"><i class="fa fa-check"></i><b>10.2</b> Asymmetric Information and Market Power</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="applications.html"><a href="applications.html#motivation"><i class="fa fa-check"></i><b>10.2.1</b> Motivation</a></li>
<li class="chapter" data-level="10.2.2" data-path="applications.html"><a href="applications.html#question-method-and-materials"><i class="fa fa-check"></i><b>10.2.2</b> Question, Method, and Materials</a></li>
<li class="chapter" data-level="10.2.3" data-path="applications.html"><a href="applications.html#findings"><i class="fa fa-check"></i><b>10.2.3</b> Findings</a></li>
<li class="chapter" data-level="10.2.4" data-path="applications.html"><a href="applications.html#policy-experiments"><i class="fa fa-check"></i><b>10.2.4</b> Policy Experiments</a></li>
<li class="chapter" data-level="10.2.5" data-path="applications.html"><a href="applications.html#source"><i class="fa fa-check"></i><b>10.2.5</b> Source</a></li>
<li class="chapter" data-level="10.2.6" data-path="applications.html"><a href="applications.html#loan-data"><i class="fa fa-check"></i><b>10.2.6</b> Loan Data</a></li>
<li class="chapter" data-level="10.2.7" data-path="applications.html"><a href="applications.html#firm-data"><i class="fa fa-check"></i><b>10.2.7</b> Firm Data</a></li>
<li class="chapter" data-level="10.2.8" data-path="applications.html"><a href="applications.html#default-data"><i class="fa fa-check"></i><b>10.2.8</b> Default Data</a></li>
<li class="chapter" data-level="10.2.9" data-path="applications.html"><a href="applications.html#positive-correlation-tests"><i class="fa fa-check"></i><b>10.2.9</b> Positive Correlation Tests</a></li>
<li class="chapter" data-level="10.2.10" data-path="applications.html"><a href="applications.html#setting-6"><i class="fa fa-check"></i><b>10.2.10</b> Setting</a></li>
<li class="chapter" data-level="10.2.11" data-path="applications.html"><a href="applications.html#firm-preference-over-banks"><i class="fa fa-check"></i><b>10.2.11</b> Firm Preference over Banks</a></li>
<li class="chapter" data-level="10.2.12" data-path="applications.html"><a href="applications.html#required-loand-amount"><i class="fa fa-check"></i><b>10.2.12</b> Required Loand Amount</a></li>
<li class="chapter" data-level="10.2.13" data-path="applications.html"><a href="applications.html#default-decision"><i class="fa fa-check"></i><b>10.2.13</b> Default Decision</a></li>
<li class="chapter" data-level="10.2.14" data-path="applications.html"><a href="applications.html#information-structure"><i class="fa fa-check"></i><b>10.2.14</b> Information Structure</a></li>
<li class="chapter" data-level="10.2.15" data-path="applications.html"><a href="applications.html#moral-hazard"><i class="fa fa-check"></i><b>10.2.15</b> Moral Hazard</a></li>
<li class="chapter" data-level="10.2.16" data-path="applications.html"><a href="applications.html#bank-problem"><i class="fa fa-check"></i><b>10.2.16</b> Bank Problem</a></li>
<li class="chapter" data-level="10.2.17" data-path="applications.html"><a href="applications.html#the-effect-of-price-on-default-probability"><i class="fa fa-check"></i><b>10.2.17</b> The Effect of Price on Default Probability</a></li>
<li class="chapter" data-level="10.2.18" data-path="applications.html"><a href="applications.html#the-first-order-condition"><i class="fa fa-check"></i><b>10.2.18</b> The First-Order Condition</a></li>
<li class="chapter" data-level="10.2.19" data-path="applications.html"><a href="applications.html#the-effect-of-higher-adverse-selection"><i class="fa fa-check"></i><b>10.2.19</b> The Effect of Higher Adverse Selection</a></li>
<li class="chapter" data-level="10.2.20" data-path="applications.html"><a href="applications.html#estimating-equilibrium-pricing-strategy-and-augmenting-missing-price-data"><i class="fa fa-check"></i><b>10.2.20</b> Estimating Equilibrium Pricing Strategy and Augmenting Missing Price Data</a></li>
<li class="chapter" data-level="10.2.21" data-path="applications.html"><a href="applications.html#inserting-pricing-estimates-into-the-utility"><i class="fa fa-check"></i><b>10.2.21</b> Inserting Pricing Estimates into the Utility</a></li>
<li class="chapter" data-level="10.2.22" data-path="applications.html"><a href="applications.html#choice-probability"><i class="fa fa-check"></i><b>10.2.22</b> Choice Probability</a></li>
<li class="chapter" data-level="10.2.23" data-path="applications.html"><a href="applications.html#equilibrium-loan-strategy"><i class="fa fa-check"></i><b>10.2.23</b> Equilibrium Loan Strategy</a></li>
<li class="chapter" data-level="10.2.24" data-path="applications.html"><a href="applications.html#equilibrium-default-strategy"><i class="fa fa-check"></i><b>10.2.24</b> Equilibrium Default Strategy</a></li>
<li class="chapter" data-level="10.2.25" data-path="applications.html"><a href="applications.html#control-function-approach-to-deal-with-endogeneity-in-loand-and-defaulty-equations"><i class="fa fa-check"></i><b>10.2.25</b> Control Function Approach to Deal with Endogeneity in Loand and Defaulty Equations</a></li>
<li class="chapter" data-level="10.2.26" data-path="applications.html"><a href="applications.html#first-stage-estimation"><i class="fa fa-check"></i><b>10.2.26</b> First-Stage Estimation</a></li>
<li class="chapter" data-level="10.2.27" data-path="applications.html"><a href="applications.html#second-stage-estimation"><i class="fa fa-check"></i><b>10.2.27</b> Second-Stage Estimation</a></li>
<li class="chapter" data-level="10.2.28" data-path="applications.html"><a href="applications.html#estimation-results"><i class="fa fa-check"></i><b>10.2.28</b> Estimation Results</a></li>
<li class="chapter" data-level="10.2.29" data-path="applications.html"><a href="applications.html#findings-from-estimation-results"><i class="fa fa-check"></i><b>10.2.29</b> Findings from Estimation Results</a></li>
<li class="chapter" data-level="10.2.30" data-path="applications.html"><a href="applications.html#fit-of-the-model"><i class="fa fa-check"></i><b>10.2.30</b> Fit of the Model</a></li>
<li class="chapter" data-level="10.2.31" data-path="applications.html"><a href="applications.html#counterfactuals"><i class="fa fa-check"></i><b>10.2.31</b> Counterfactuals</a></li>
<li class="chapter" data-level="10.2.32" data-path="applications.html"><a href="applications.html#what-if-adverse-selection-got-severer"><i class="fa fa-check"></i><b>10.2.32</b> What if Adverse Selection Got Severer?</a></li>
<li class="chapter" data-level="10.2.33" data-path="applications.html"><a href="applications.html#what-if-cost-of-capital-increased"><i class="fa fa-check"></i><b>10.2.33</b> What if Cost of Capital Increased?</a></li>
<li class="chapter" data-level="10.2.34" data-path="applications.html"><a href="applications.html#merger-simulation-2"><i class="fa fa-check"></i><b>10.2.34</b> Merger Simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="assignment1.html"><a href="assignment1.html"><i class="fa fa-check"></i><b>11</b> Assignment 1: Basic Programming in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="assignment1.html"><a href="assignment1.html#simulate-data"><i class="fa fa-check"></i><b>11.1</b> Simulate data</a></li>
<li class="chapter" data-level="11.2" data-path="assignment1.html"><a href="assignment1.html#estimate-the-parameter"><i class="fa fa-check"></i><b>11.2</b> Estimate the parameter</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="assignment2.html"><a href="assignment2.html"><i class="fa fa-check"></i><b>12</b> Assignment 2: Production Function Estimation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="assignment2.html"><a href="assignment2.html#simulate-data-1"><i class="fa fa-check"></i><b>12.1</b> Simulate data</a></li>
<li class="chapter" data-level="12.2" data-path="assignment2.html"><a href="assignment2.html#estimate-the-parameters"><i class="fa fa-check"></i><b>12.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="assignment3.html"><a href="assignment3.html"><i class="fa fa-check"></i><b>13</b> Assignment 3: Demand Function Estimation I</a>
<ul>
<li class="chapter" data-level="13.1" data-path="assignment3.html"><a href="assignment3.html#simulate-data-2"><i class="fa fa-check"></i><b>13.1</b> Simulate data</a></li>
<li class="chapter" data-level="13.2" data-path="assignment3.html"><a href="assignment3.html#estimate-the-parameters-1"><i class="fa fa-check"></i><b>13.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="assignment4.html"><a href="assignment4.html"><i class="fa fa-check"></i><b>14</b> Assignment 4: Demand Function Estimation II</a>
<ul>
<li class="chapter" data-level="14.1" data-path="assignment4.html"><a href="assignment4.html#simulate-data-3"><i class="fa fa-check"></i><b>14.1</b> Simulate data</a></li>
<li class="chapter" data-level="14.2" data-path="assignment4.html"><a href="assignment4.html#estimate-the-parameters-2"><i class="fa fa-check"></i><b>14.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="assignment5.html"><a href="assignment5.html"><i class="fa fa-check"></i><b>15</b> Assignment 5: Merger Simulation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="assignment5.html"><a href="assignment5.html#simulate-data-4"><i class="fa fa-check"></i><b>15.1</b> Simulate data</a></li>
<li class="chapter" data-level="15.2" data-path="assignment5.html"><a href="assignment5.html#estimate-the-parameters-3"><i class="fa fa-check"></i><b>15.2</b> Estimate the parameters</a></li>
<li class="chapter" data-level="15.3" data-path="assignment5.html"><a href="assignment5.html#conduct-counterfactual-simulation"><i class="fa fa-check"></i><b>15.3</b> Conduct counterfactual simulation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="assignment6.html"><a href="assignment6.html"><i class="fa fa-check"></i><b>16</b> Assignment 6: Entry and Exit Analysis</a>
<ul>
<li class="chapter" data-level="16.1" data-path="assignment6.html"><a href="assignment6.html#simulate-data-5"><i class="fa fa-check"></i><b>16.1</b> Simulate data</a></li>
<li class="chapter" data-level="16.2" data-path="assignment6.html"><a href="assignment6.html#estimate-the-parameters-4"><i class="fa fa-check"></i><b>16.2</b> Estimate the parameters</a></li>
<li class="chapter" data-level="16.3" data-path="assignment6.html"><a href="assignment6.html#conduct-counterfactual-simulations"><i class="fa fa-check"></i><b>16.3</b> Conduct counterfactual simulations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="assignment7.html"><a href="assignment7.html"><i class="fa fa-check"></i><b>17</b> Assignment 7: Dynamic Decision</a>
<ul>
<li class="chapter" data-level="17.1" data-path="assignment7.html"><a href="assignment7.html#simulate-data-6"><i class="fa fa-check"></i><b>17.1</b> Simulate data</a></li>
<li class="chapter" data-level="17.2" data-path="assignment7.html"><a href="assignment7.html#estimate-parameters"><i class="fa fa-check"></i><b>17.2</b> Estimate parameters</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="assignment8.html"><a href="assignment8.html"><i class="fa fa-check"></i><b>18</b> Assignment 8: Dynamic Game</a>
<ul>
<li class="chapter" data-level="18.1" data-path="assignment8.html"><a href="assignment8.html#simulate-data-7"><i class="fa fa-check"></i><b>18.1</b> Simulate data</a></li>
<li class="chapter" data-level="18.2" data-path="assignment8.html"><a href="assignment8.html#estimate-parameters-1"><i class="fa fa-check"></i><b>18.2</b> Estimate parameters</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="assignment9.html"><a href="assignment9.html"><i class="fa fa-check"></i><b>19</b> Assignment 9: Auction</a>
<ul>
<li class="chapter" data-level="19.1" data-path="assignment9.html"><a href="assignment9.html#simulate-data-8"><i class="fa fa-check"></i><b>19.1</b> Simulate data</a></li>
<li class="chapter" data-level="19.2" data-path="assignment9.html"><a href="assignment9.html#estimate-the-parameters-5"><i class="fa fa-check"></i><b>19.2</b> Estimate the parameters</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>20</b> Integrating with C++ using Rcpp and RcppEigen</a>
<ul>
<li class="chapter" data-level="20.1" data-path="rcpp.html"><a href="rcpp.html#prerequisite"><i class="fa fa-check"></i><b>20.1</b> Prerequisite</a></li>
<li class="chapter" data-level="20.2" data-path="rcpp.html"><a href="rcpp.html#workflow"><i class="fa fa-check"></i><b>20.2</b> Workflow</a></li>
<li class="chapter" data-level="20.3" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-as-rcpp-objects"><i class="fa fa-check"></i><b>20.3</b> Passing R Objects as Rcpp Objects</a></li>
<li class="chapter" data-level="20.4" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-as-eigen-objects"><i class="fa fa-check"></i><b>20.4</b> Passing R Objects as Eigen Objects</a></li>
<li class="chapter" data-level="20.5" data-path="rcpp.html"><a href="rcpp.html#passing-r-objects-in-other-objects-in-cc"><i class="fa fa-check"></i><b>20.5</b> Passing R Objects in Other Objects in C/C++</a></li>
<li class="chapter" data-level="20.6" data-path="rcpp.html"><a href="rcpp.html#manipulating-objects-in-a-c-function"><i class="fa fa-check"></i><b>20.6</b> Manipulating Objects in a C++ Function</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="rcpp.html"><a href="rcpp.html#matrix-and-vector-arithmetic"><i class="fa fa-check"></i><b>20.6.1</b> Matrix and Vector Arithmetic</a></li>
<li class="chapter" data-level="20.6.2" data-path="rcpp.html"><a href="rcpp.html#the-array-class-and-coefficient-wise-operations"><i class="fa fa-check"></i><b>20.6.2</b> The Array Class and Coefficient-wise Operations</a></li>
<li class="chapter" data-level="20.6.3" data-path="rcpp.html"><a href="rcpp.html#solving-linear-least-squares-systems"><i class="fa fa-check"></i><b>20.6.3</b> Solving Linear Least Squares Systems</a></li>
<li class="chapter" data-level="20.6.4" data-path="rcpp.html"><a href="rcpp.html#accessing-to-elements-of-a-matrix-and-vector"><i class="fa fa-check"></i><b>20.6.4</b> Accessing to Elements of a Matrix and Vector</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>21</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECON5630 Topics in Empirical Industrial Organization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="demand" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Demand Function Estimation<a href="demand.html#demand" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="motivations-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Motivations<a href="demand.html#motivations-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>From the demand function and utility maximization assumption, we can reveal the preference of the decision maker.</p></li>
<li><p>Thus, estimating demand function is necessary for <strong>evaluating the consumer welfare</strong>.</p></li>
<li><p>In IO, estimating the <strong>price elasticity of demand</strong> is especially important, because it determines the <strong>market power</strong> of a monopolist and the size of the dead-weight loss.</p></li>
<li><p>In macroeconomics, estimating demand is important to determine the <strong>price level</strong>, because the price level is the minimum expenditure for a consumer to achieve the certain level of utility.</p></li>
<li><p>In marketing, estimating demand is necessary to design the optimal pricing, advertising, and all the other marketing interventions.</p></li>
<li><p>In principle, the theory can be applied to whatever decisions other than the consumer choice.</p></li>
<li><p><span class="citation">Nevo (<a href="#ref-Nevo2000c">2000</a>)</span>:</p>
<ul>
<li>How do the hypothetical mergers in the ready-to-eat cereal industry affect the market price, markup, and consumer surplus?</li>
<li>To do so, the authors estimate the demand for ready-to-eat cereals and the cost functions for each product. Then, the authors conduct counterfactual simulations of mergers to quantify the effects.</li>
</ul></li>
<li><p><span class="citation">Chung &amp; Alcácer (<a href="#ref-Chung2002">2002</a>)</span>:</p>
<ul>
<li>To what extent do firms go abroad to access technology available in other locations?</li>
<li>To study this issue, the authors estimate firms’ locational choices when going abroad.</li>
</ul></li>
<li><p><span class="citation">Rysman (<a href="#ref-Rysman2004">2004</a>)</span>:</p>
<ul>
<li>In Yellow pages, how do consumers evaluate the advertisement on it, and how do advertisers value consumer usage?</li>
<li>To study this, the author simultaneously estimates the consumer demand for usage of a directory, advertiser demand for advertising, and a publisher’s first-order condition.</li>
</ul></li>
<li><p><span class="citation">Gentzow (<a href="#ref-Gentzkow2004">2004</a>)</span>:</p>
<ul>
<li>Are online and print newspapers substitutes or complements?</li>
<li>To study this, the author estimates a demand function in which online and print newspapers can be either substitutes or complements.</li>
</ul></li>
<li><p><span class="citation">Bayer et al. (<a href="#ref-Bayer2007">2007</a>)</span>:</p>
<ul>
<li>What are people’s preferences for schools and neighborhoods? How is this capitalized into housing prices?</li>
<li>To do so, the authors estimate the discrete choice of residents over locations. To deal with the endogeneity between the neighborhood and the unobserved attributes of the location, the authors use the discontinuity at the school attendance zone.</li>
</ul></li>
<li><p><span class="citation">Archak, Ghose, &amp; Ipeirotis (<a href="#ref-Archak2011">2011</a>)</span>:</p>
<ul>
<li>How does the information embedded in product reviews affect consumer choice?</li>
<li>To study this, the authors estimate the discrete choice model of consumers in which the text information from the product reviews is included as the product attributes.</li>
</ul></li>
<li><p><span class="citation">Holmes (<a href="#ref-Holmes2011">2011</a>)</span>:</p>
<ul>
<li>Wal-Mart maintains high store density. How large is the economy of density and the sales cannibalization?</li>
<li>To study this, the author first estimates the demand function across neighborhood Wal-Mart to capture the sales cannibalization, and then estimates the cost structure from their entry and exit behaviors.</li>
</ul></li>
<li><p><span class="citation">Handbury &amp; Weinstein (<a href="#ref-Handbury2014">2014</a>)</span>:</p>
<ul>
<li>Urban and rural areas differ in available products. How does the price difference change if the heterogeneity in the product availability is incorporated?</li>
<li>To do so, the authors estimate the demand function at each location, and then construct the spatial price index based on the available products at each location.</li>
</ul></li>
</ul>
</div>
<div id="analyzing-consumer-behaviors" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Analyzing Consumer Behaviors<a href="demand.html#analyzing-consumer-behaviors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p><strong>Alternative set</strong>.</p></li>
<li><p><strong>Utility function</strong>.</p>
<ul>
<li>Add system of <strong>choice sets</strong>.</li>
<li>Add utility maximization.</li>
</ul></li>
<li><p><span class="math inline">\(\rightarrow\)</span> <strong>Demand function</strong>.</p></li>
<li><p>In the case of producer behavior, there was a chance to directly observe the output of the most primitive function, the production function.</p></li>
<li><p>In the case of consumer behavior, we never directly observe the output of the most primitive function, the utility function.</p></li>
<li><p>We can at most identify demand functions.</p></li>
<li><p><strong>Revealed preference theory</strong>:</p>
<ul>
<li><span class="citation">Samuelson (<a href="#ref-Samuelson1938">1938</a>)</span>, <span class="citation">Houthakker (<a href="#ref-Houthakker1950">1950</a>)</span>, <span class="citation">Richter (<a href="#ref-Richter1966">1966</a>)</span>, <span class="citation">Afriat (<a href="#ref-Afriat1967">1967</a>)</span>, <span class="citation">Varian (<a href="#ref-Varian1982">1982</a>)</span>.</li>
<li>If the demand function is derived from a preference by maximizing the preference, the demand function should satisfy some restrictions.</li>
<li>If the assumption is true, we can recover part of the preference from the demand function.</li>
</ul></li>
</ul>
</div>
<div id="continuous-choice" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Continuous Choice<a href="demand.html#continuous-choice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>The alternative set <span class="math inline">\(\mathcal{X}\)</span> is a subset of <span class="math inline">\(\mathbb{R}^J\)</span>.</li>
<li>The utility function <span class="math inline">\(u\)</span> is rational, monotone, and continuous on <span class="math inline">\(\mathcal{X}\)</span>.</li>
<li>The choice sets are given by a system of <strong>linear budget sets</strong>:
<span class="math display">\[
\mathcal{B}(p, w) = \{q \in \mathcal{X}: p \cdot q \le w\}.
\]</span></li>
<li>If choice sets are non-linear, the following duality approach needs to be modified.</li>
</ul>
<div id="duality-between-utility-and-expenditure-functions" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Duality between Utility and Expenditure Functions<a href="demand.html#duality-between-utility-and-expenditure-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>It is rather a special case that we can derive a closed-form solution to a utility maximization problem.</li>
<li>We can use the first-order conditions as moment conditions for identification.
<span class="math display">\[\begin{equation}
\frac{\partial u(q)}{\partial q_i} = \lambda p_i, i = 1, \cdots, J.
\end{equation}\]</span></li>
<li>The derivation of a demand function from the identified utility function in general requires numerical simulation, which can be troublesome.</li>
<li>As well as the duality between production and cost functions, we have the same duality theorem for utility and expenditure functions.</li>
<li>There is a one-to-one mapping between a class of utility functions and a class of expenditure functions.</li>
<li>Therefore, it is okay to start from an expenditure function.</li>
<li>It is rare that we can recover the utility function associated with an expenditure function in closed form. But it is not often required for analysis.</li>
<li>Moreover, we can easily derive other important functions from the expenditure functions.</li>
<li>Let <span class="math inline">\(p\)</span> be the price vector and <span class="math inline">\(u\)</span> be the target utility level.</li>
<li>Let <span class="math inline">\(u(q)\)</span> be a utility function.</li>
<li>An expenditure function associated with the utility function is defined by:
<span class="math display">\[\begin{equation}
e(u, p) = \min_{q} p \cdot q, \text{ subject to } u(q) \ge u.
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(x\)</span> be the total expenditure such that:
<span class="math display">\[\begin{equation}
x = e(u, p).
\end{equation}\]</span></li>
<li>We can start the analysis by specifying this function instead of the utility function.</li>
</ul>
</div>
<div id="deriving-other-functions" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Deriving Other Functions<a href="demand.html#deriving-other-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>It is easy to derive other functions from an expenditure function.</li>
<li><strong>Indirect utility function</strong>: invert the expenditure function to get:
<span class="math display">\[\begin{equation}
u = e^{-1}(p, x) \equiv v(p, x).
\end{equation}\]</span></li>
<li><strong>Hicksian demand function</strong>: apply Shepard’s lemma:
<span class="math display">\[\begin{equation}
q_i = \frac{\partial e(u, p)}{\partial p_i} \equiv h_i(u, p).
\end{equation}\]</span></li>
<li><strong>Marshallian demand function</strong>: insert Hicksian demand function to the expenditure function:
<span class="math display">\[\begin{equation}
q_i = h_i(v(p, x), p) \equiv d_i(p, x).
\end{equation}\]</span></li>
</ul>
</div>
<div id="starting-from-an-indirect-utility-function" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Starting from an Indirect Utility Function<a href="demand.html#starting-from-an-indirect-utility-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>It is almost equivalent to start from an indirect utility function.</li>
<li>An indirect utility function with the utility function is defined by:
<span class="math display">\[\begin{equation}
v(p, x) \equiv \max_{q} u(q), \text{ subject to } p&#39;q \le x.
\end{equation}\]</span></li>
<li>We can derive the Marshallian demand function by Roy’s identity:
<span class="math display">\[\begin{equation}
q_i = \frac{- \partial v(p, x)/\partial p_i}{\partial v(p, x)/\partial x} \equiv d_i(p, x).
\end{equation}\]</span></li>
</ul>
</div>
<div id="expenditure-share-equation" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Expenditure Share Equation<a href="demand.html#expenditure-share-equation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let’s start from an expenditure function <span class="math inline">\(e(p, x)\)</span>.</li>
<li>By Shepard’s lemma, we have:
<span class="math display">\[\begin{equation}
\frac{\partial \ln e(u, p)}{\partial \ln p_i} = \frac{\partial e(u, p)}{\partial p_i} \frac{p_i}{e(u, p)} = \frac{p_i q_i}{x} \equiv w_i.
\end{equation}\]</span></li>
<li>We call this an expenditure share equation.</li>
<li>The estimation is based on the share equations.</li>
</ul>
</div>
<div id="almost-ideal-demand-system-aids" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Almost Ideal Demand System (AIDS)<a href="demand.html#almost-ideal-demand-system-aids" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Based on <span class="citation">Deaton &amp; Muellbauer (<a href="#ref-Deaton1980">1980</a>)</span>.</li>
<li>See <span class="citation">Angus Deaton &amp; John Muellbauer (<a href="#ref-AngusDeaton1980">1980</a>)</span> for further reference.</li>
<li>Consider an expenditure function that satisfies the following useful conditions:
<ul>
<li>It allows aggregation (this motivation is less important in recent days).</li>
<li>It gives an arbitrary first-order approximation to any demand system.</li>
<li>It can satisfy the restrictions of utility maximization.</li>
<li>It can be used to test the restrictions of utility maximization.</li>
</ul></li>
</ul>
</div>
<div id="piglog-class" class="section level3 hasAnchor" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> PIGLOG Class<a href="demand.html#piglog-class" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>PIGLOG (price-independent generalized logarithmic) class <span class="citation">(<a href="#ref-Muellbauer1976">Muellbauer, 1976</a>)</span>.
<span class="math display">\[\begin{equation}
\ln e(u, p) = (1 - u) \ln a(p) + u\ln b(p),
\end{equation}\]</span>
where <span class="math inline">\(a(p)\)</span> and <span class="math inline">\(b(p)\)</span> are arbitrary linear homogeneous concave functions.</li>
<li>Consider households that differ in total income.</li>
<li>The PIGLOG form ensures that the aggregate demand can be written in the same form where the total income is replaced with the sum of household total income.</li>
<li>The derivatives should be given free parameters for the model to be an arbitrary first-order approximation to any demand system.</li>
<li>In AIDS, we specify <span class="math inline">\(a(p)\)</span> and <span class="math inline">\(b(p)\)</span> as:
<span class="math display">\[\begin{equation}
\begin{split}
\ln a(p) &amp;\equiv a_0 + \sum_{k} \alpha_k \ln p_k + \frac{1}{2}\sum_{k} \sum_{j} \gamma_{kj}^* \ln p_k \ln p_j\\
\ln b(p) &amp;\equiv \ln a(p) + \beta_0  \prod_{k} p_k^{\beta_k}.
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="derive-the-share-equation-i" class="section level3 hasAnchor" number="4.3.7">
<h3><span class="header-section-number">4.3.7</span> Derive the Share Equation I<a href="demand.html#derive-the-share-equation-i" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>By Roy’s identity, we can derive the associated share equation:
<span class="math display">\[\begin{equation}
w_i \equiv \frac{\partial \ln e(u, p)}{\partial \ln p_i} = \alpha_i + \sum_{j} \gamma_{ij} \log p_j + \beta_i u \beta_0 \prod_{k} p_k^{\beta_k},
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\gamma_{ij} = \frac{1}{2}(\gamma_{ij}^* + \gamma_{ji}^*).
\end{equation}\]</span></li>
</ul>
</div>
<div id="derive-the-share-equation-ii" class="section level3 hasAnchor" number="4.3.8">
<h3><span class="header-section-number">4.3.8</span> Derive the Share Equation II<a href="demand.html#derive-the-share-equation-ii" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Insert the indirect utility function <span class="math inline">\(u = v(p, x)\)</span> to get:
<span class="math display">\[\begin{equation}
w_i = \alpha_i + \sum_{j} \gamma_{ij} \ln p_j + \beta_i \ln \frac{x}{P},
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\ln P \equiv  \alpha_0 + \sum_{k} \alpha_k \ln p_k + \frac{1}{2} \sum_{j} \sum_{k} \gamma_{kj} \ln p_k \ln p_j.
\end{equation}\]</span></li>
<li><span class="math inline">\(P\)</span> is a price index associated with the given preference.</li>
<li>With the specification of <span class="citation">Richard Stone (<a href="#ref-RichardStone1954">1954</a>)</span>, it becomes <span class="math inline">\(\ln P = \sum_{j} x_j \ln p_j\)</span>.</li>
<li>It can be used as an approximation.</li>
</ul>
</div>
<div id="specify-the-detail-ii" class="section level3 hasAnchor" number="4.3.9">
<h3><span class="header-section-number">4.3.9</span> Specify the Detail II<a href="demand.html#specify-the-detail-ii" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>It can satisfy the restrictions of utility maximization.</li>
<li>It can be used to test the restrictions of utility maximization.
<ul>
<li><span class="math inline">\(\sum_{j} x_j = 1\)</span>:
<span class="math display">\[\begin{equation}
\sum_{j} \alpha_j = 1, \sum_{j} \gamma_{jk} = 0, \sum_{j} \beta_j = 0.
\end{equation}\]</span></li>
<li><span class="math inline">\(e(u, p)\)</span> is linear homogeneous in <span class="math inline">\(p\)</span>:
<span class="math display">\[\begin{equation}
\sum_{j} \gamma_{ij} = 0.
\end{equation}\]</span></li>
<li>Symmetry:
<span class="math display">\[\begin{equation}
\gamma_{ij} = \gamma_{ji}.
\end{equation}\]</span></li>
</ul></li>
</ul>
</div>
<div id="estimation" class="section level3 hasAnchor" number="4.3.10">
<h3><span class="header-section-number">4.3.10</span> Estimation<a href="demand.html#estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>We can estimate parameters based on the share equations.</li>
<li>If we use aggregate data, the aggregate error term is correlated with the price vector.</li>
<li>Therefore, we need at least as many instrumental variables as the dimension of the price vector.</li>
<li>With valid instrumental variables, we can estimate the model with GMM.</li>
<li>If we use household-level data, the household-specific errors controlling for aggregate errors will not be correlated with the price vector if the price is determined in a competitive market.</li>
</ul>
</div>
<div id="from-product-space-approach-to-characteristics-space-approach" class="section level3 hasAnchor" number="4.3.11">
<h3><span class="header-section-number">4.3.11</span> From Product Space Approach to Characteristics Space Approach<a href="demand.html#from-product-space-approach-to-characteristics-space-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The framework up to here is called the <strong>product space approach</strong> because the utility has been defined over a product space.</li>
<li>When there are <span class="math inline">\(J\)</span> goods, there are <span class="math inline">\(J^2\)</span> parameters for prices.</li>
<li>One way to resolve this issue is to introduce a priori knowledge about the preference.</li>
<li>For example, we can introduce a priori segmentation with separability.</li>
<li>It is hard to evaluate the effect of introducing new product.</li>
<li>Again, we have to a priori decide which segment/product is similar to the new product.</li>
<li>This leads us to the <strong>characteristics space approach</strong> <span class="citation">(<a href="#ref-Lancaster1966">Lancaster, 1966</a>; <a href="#ref-Muth1966">Muth, 1966</a>)</span>:
<ul>
<li>Consumption is an activity in which goods are inputs and in which the output is a collection of characteristics.</li>
<li>Utility ranks collections of characteristics and only ranks collections of goods indirectly through the characteristics that they possess.</li>
<li>There are <span class="math inline">\(k = 1, \cdots, K\)</span> activities.</li>
<li>The activity <span class="math inline">\(y\)</span> requires consuming <span class="math inline">\(x = A y\)</span> products.</li>
<li>The activity <span class="math inline">\(y\)</span> generates <span class="math inline">\(z = B y\)</span> characteristics.</li>
<li>The budget constraint is <span class="math inline">\(p \cdot x \le 1\)</span>.</li>
<li>The utility is defined over the characteristics <span class="math inline">\(u(z)\)</span>.</li>
<li>The consumer’s problem is:
<span class="math display">\[
  \max_y u(z)
  \]</span>
subject to
<span class="math display">\[
  p \cdot x \le 1, x = Ay, z = By, x, y, z \ge 0.
  \]</span></li>
</ul></li>
<li>Then, only the dimension of characteristics matters, and the value of new products can be evaluated by their contribution to the production of characteristics.</li>
<li>The early applications include <span class="citation">Rosen (<a href="#ref-Rosen1974">1974</a>)</span>, <span class="citation">Muellbauer (<a href="#ref-Muellbauer1974">1974</a>)</span>, and <span class="citation">Gorman (<a href="#ref-Gorman1980">1980</a>)</span>.</li>
<li>The nonparametric analysis based on the revealed preference is in <span class="citation">Blow, Browning, &amp; Crawford (<a href="#ref-Blow2008">2008</a>)</span>.</li>
</ul>
</div>
<div id="from-continuous-choice-approach-to-discrete-choice-approach" class="section level3 hasAnchor" number="4.3.12">
<h3><span class="header-section-number">4.3.12</span> From Continuous Choice Approach to Discrete Choice Approach<a href="demand.html#from-continuous-choice-approach-to-discrete-choice-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The aggregate demand is a collection of choices across consumers and within consumers over time.</li>
<li>It makes sense to model individual choices and then aggregate rather than directly modeling the aggregate demand.</li>
<li>The resulting aggregate demand will satisfy restrictions that are consistent with the underlying consumer choice model.</li>
<li>If there is an interaction across choices, the aggregation is not trivial.</li>
<li>This is especially true when aggregating choices within consumers.</li>
<li>For now, assume that each choice is independent.</li>
</ul>
</div>
</div>
<div id="discrete-choice" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Discrete Choice<a href="demand.html#discrete-choice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="discrete-choice-approach" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Discrete Choice Approach<a href="demand.html#discrete-choice-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let <span class="math inline">\(u(q, z_i)\)</span> be the utility of a consumer over <span class="math inline">\(J + 1\)</span> dimensional consumption bundle <span class="math inline">\(q\)</span> characterized by consumer characteristics <span class="math inline">\(z_i\)</span>.</li>
<li>The consumer solves:
<span class="math display">\[\begin{equation}
V(p, y_i, z_i) = \max_{q}u(q, z_i), \text{   s.t.   } p&#39;q \le y_i.
\end{equation}\]</span></li>
<li>Alternative <span class="math inline">\(0\)</span> is an <strong>outside good</strong>.</li>
<li>Normalize <span class="math inline">\(p_0 = 1\)</span>.</li>
<li>We call alternatives <span class="math inline">\(j = 1, \cdots, J\)</span> <strong>inside goods</strong>.</li>
<li>The choice space is restricted on:
<span class="math display">\[\begin{equation}
\begin{split}
Q = \{q:&amp; q_0 \in [0, M], q_j \in \{0, 1\}, j = 1, \cdots, J,\\
&amp; q_j q_k = 0, \forall j \neq k, j, k &gt; 0, M &lt; \infty\}.
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="discrete-choice-approach-1" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Discrete Choice Approach<a href="demand.html#discrete-choice-approach-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The budget constraint reduces to:
<span class="math display">\[\begin{equation}
\begin{cases}
q_0 + p_j q_j = y &amp;\text{   if   } q_j = 1, j &gt; 0\\
q_0 = y &amp;\text{   otherwise}.
\end{cases}
\end{equation}\]</span></li>
<li>Hence,
<span class="math display">\[\begin{equation}
q_0 = y - \sum_{j = 1}^J p_j q_j.
\end{equation}\]</span></li>
</ul>
</div>
<div id="discrete-choice-approach-2" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Discrete Choice Approach<a href="demand.html#discrete-choice-approach-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The utility maximization problem can be written as:
<span class="math display">\[\begin{equation}
V(p, y_i, z_i) = \max_{j = 0, 1, \cdots, J}  v_j(p_j, y_i, z_i),
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\begin{split}
&amp;v_j(p_j, y_i, z_i)\\
&amp; =
\begin{cases}
u(y_i - p_j, 0, \cdots, \underbrace{1}_{q_j}, \cdots, 0, z_i) &amp;\text{   if  }j &gt; 0,\\
u(y_i, 0, \cdots, 0, z_i) &amp;\text{   if   }j = 0,
\end{cases}
\end{split}
\end{equation}\]</span>
is called the <strong>choice-specific indirect utility</strong>.</li>
</ul>
</div>
<div id="characteristics-space-approach" class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Characteristics Space Approach<a href="demand.html#characteristics-space-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Preference is defined over the characteristics of alternatives, <span class="math inline">\(x_j\)</span>:</p></li>
<li><p>Car: vehicle, engine power, model-year, car maker, etc.</p></li>
<li><p>PC: CPU power, number of cores, memory, HDD volume, etc.</p></li>
<li><p>The choice-specific indirect utility is a function of the characteristics of the alternative:
<span class="math display">\[\begin{equation}
\begin{split}
v_j(p_j, y_i, z_i) &amp;= u(y_i - p_j, 0, \cdots, \underbrace{1}_{q_j}, \cdots, 0, z_i)\\
&amp;= u^*(y_i - p_j, x_j, z_i)\\
&amp;\equiv v(p_j, x_j, y_i, z_i).
\end{split}
\end{equation}\]</span></p></li>
</ul>
</div>
<div id="weak-separability-and-income-effect" class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Weak Separability and Income Effect<a href="demand.html#weak-separability-and-income-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>We usually focus on a particular product category such as cars, PCs, cereals, detergents, and so on.</li>
<li>Assume that the preference is separable between the category in question (<strong>inside goods</strong>) and other categories (<strong>outside goods</strong>).</li>
<li><span class="math inline">\(u(q) = u[q_I, v(q_O)]\)</span>:
<ul>
<li><span class="math inline">\(q_I\)</span>: the consumption vector of inside goods.</li>
<li><span class="math inline">\(q_O\)</span>: the consumption vector of outside goods.</li>
<li>Increasing in <span class="math inline">\(v_O = v(q_O)\)</span>.</li>
</ul></li>
<li><span class="math inline">\(p = (p_I, p_O)\)</span>:
<ul>
<li><span class="math inline">\(p_I\)</span>: the price vector of inside goods.</li>
<li><span class="math inline">\(p_O\)</span>: the price vector of outside goods.</li>
</ul></li>
<li>When <span class="math inline">\(y_O\)</span> is left for the outside goods, the conditional demand for the outside goods <span class="math inline">\(q_O(y_O, p_O)\)</span> exists.</li>
<li>Inserting this into the utility function gives:
<span class="math display">\[\begin{equation}
u\{q_I, v[q_O(y_O, p_O)]\} \equiv \tilde{u}(q_I, y_O; p_O).
\end{equation}\]</span></li>
</ul>
</div>
<div id="weak-separability-and-income-effect-1" class="section level3 hasAnchor" number="4.4.6">
<h3><span class="header-section-number">4.4.6</span> Weak Separability and Income Effect<a href="demand.html#weak-separability-and-income-effect-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Thus, how the preference for the outside good is modeled determines how the individual income affects the choice.
<span class="math display">\[\begin{equation}
\begin{split}
&amp;u(y_i - p_j, x_j, z_i) = \tilde{u}(x_j, z_i) + \alpha(y_i - p_j).\\
&amp;u(y_i - p_j, x_j, z_i) = \tilde{u}(x_j, z_i) + \alpha \ln (y_i - p_j).
\end{split}
\end{equation}\]</span></li>
<li>In the first example, the income level does not affect the choice because the term <span class="math inline">\(\alpha y_i\)</span> is common and constant across choices (there is no income effect).</li>
<li>We often do not observe the income of a consumer, <span class="math inline">\(y_i\)</span>.</li>
<li>Remember that the price of a product enters because we consider the <strong>indirect</strong> utility function here.</li>
</ul>
</div>
<div id="utility-function-normalization" class="section level3 hasAnchor" number="4.4.7">
<h3><span class="header-section-number">4.4.7</span> Utility Function Normalization<a href="demand.html#utility-function-normalization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The <strong>location</strong> of utility function is often normalized by setting:
<span class="math display">\[\begin{equation}
u(y^*, 0, \cdots, 0, z) = 0,
\end{equation}\]</span>
for a certain choice of <span class="math inline">\(y^*\)</span> for any consumer segment <span class="math inline">\(z_i\)</span>.</li>
</ul>
</div>
<div id="aggregation-of-the-individual-demand" class="section level3 hasAnchor" number="4.4.8">
<h3><span class="header-section-number">4.4.8</span> Aggregation of the Individual Demand<a href="demand.html#aggregation-of-the-individual-demand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let <span class="math inline">\(q(p, x, y_i, z_i) = \{q_j(p, x, y_i, z_i)\}_{j = 0, \cdots, J}\)</span> be the demand function of consumer <span class="math inline">\(i\)</span>, that is:
<span class="math display">\[\begin{equation}
q_j(p, x, y_i, z_i) = 1 \Leftrightarrow j = \text{argmax}_{j = 0, 1, \cdots, J}  v(p_j, x_j, y_i, z_i).
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(f(y, z)\)</span> be the joint distribution of the income and other consumer characteristics.</li>
<li>The aggregate demand for good <span class="math inline">\(j\)</span> is:
<span class="math display">\[\begin{equation}
\sigma_j(p, x) \equiv N \int  q_j(p, x, y, z) f(y, z) dy dz,
\end{equation}\]</span>
where <span class="math inline">\(N\)</span> is the population.</li>
</ul>
</div>
<div id="horizontal-product-differentiation" class="section level3 hasAnchor" number="4.4.9">
<h3><span class="header-section-number">4.4.9</span> Horizontal Product Differentiation<a href="demand.html#horizontal-product-differentiation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>horizontal product differentiation</strong>: consumers do not agree on the ranking of the choices.</li>
<li>There are two convenience stores <span class="math inline">\(j = 1, 2\)</span> on a street <span class="math inline">\([0, 1]\)</span>.</li>
<li>Let <span class="math inline">\(z_i\)</span> be the location of consumer <span class="math inline">\(i\)</span> and <span class="math inline">\(x_j\)</span> be the location of the choice on a street <span class="math inline">\([0, 1]\)</span> with <span class="math inline">\(x_1 &lt; x_2\)</span>.</li>
<li>A consumer has a preference such that:
<span class="math display">\[\begin{equation}
v_{ij} \equiv v(p_j, x_j, y_i, z_i) \equiv s - t |z_i - x_j| - p_j.
\end{equation}\]</span></li>
</ul>
</div>
<div id="horizontal-product-differentiation-1" class="section level3 hasAnchor" number="4.4.10">
<h3><span class="header-section-number">4.4.10</span> Horizontal Product Differentiation<a href="demand.html#horizontal-product-differentiation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Suppose that the prices are low enough that entire consumers on the street are willing to buy either from the stores.</li>
<li>Consumer <span class="math inline">\(i\)</span> buys from store <span class="math inline">\(1\)</span> if and only if:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;v(p_1, x_1, y_i, z_i) \ge v(p_2, x_2, y_i, z_i)\\
&amp;\Leftrightarrow s - t |z_i - x_1| - p_1 \ge s - t |z_i - x_2|- p_2\\
&amp;\Leftrightarrow z_i \le \frac{p_2 - p_1}{2 t} + \frac{x_1 + x_2}{2} \equiv \overline{z}_1(p_1, p_2).
\end{split}
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(f(z_i)\)</span> be <span class="math inline">\(U[0, 1]\)</span>. Then, the aggregate demand for store 1 is:
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_1(p, x) = N \int_{0}^{\overline{z}_1(p_1, p_2)} d z_i = N\overline{z}_1(p_1, p_2).
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="vertical-product-differentiation" class="section level3 hasAnchor" number="4.4.11">
<h3><span class="header-section-number">4.4.11</span> Vertical Product Differentiation<a href="demand.html#vertical-product-differentiation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>Vertical product differentiation</strong>: Consumers agree on the ranking of the choices. Consumers can have different willingness to pay.</li>
<li><span class="citation">Timothy F. Bresnahan (<a href="#ref-Bresnahan1987">1987</a>)</span> analyzed automobile demand with this framework.</li>
<li>There are <span class="math inline">\(J\)</span> goods and consumer <span class="math inline">\(i\)</span> has a utility such as:
<span class="math display">\[\begin{equation}
v_{ij} \equiv v(p_j, x_j, y_i, z_i) = z_i x_j - p_j,
\end{equation}\]</span>
where <span class="math inline">\(x_j\)</span> is a quality of product <span class="math inline">\(j\)</span> and <span class="math inline">\(z_i\)</span> is the consumer’s willingness to pay for the quality with <span class="math inline">\(x_j &lt; x_{j + 1}\)</span>.</li>
<li>Consumers’ problem is:
<span class="math display">\[\begin{equation}
\max\{0, z_i x_1 - p_1, \cdots, z_i x_J - p_J \}.
\end{equation}\]</span></li>
</ul>
</div>
<div id="vertical-product-differentiation-1" class="section level3 hasAnchor" number="4.4.12">
<h3><span class="header-section-number">4.4.12</span> Vertical Product Differentiation<a href="demand.html#vertical-product-differentiation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Consumer <span class="math inline">\(i\)</span> prefers good <span class="math inline">\(j + 1\)</span> to good <span class="math inline">\(j\)</span> if and only if:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;v(p_{j + 1}, x_{j + 1}, y_i, z_i) \ge v(p_j, x_j, y_i, z_i)\\
&amp;\Leftrightarrow z_i x_{j + 1} - p_{j + 1} \ge z_i x_j - p_j\\
&amp;\Leftrightarrow z_i \ge \frac{p_{j + 1} - p_j}{x_{j + 1} - x_j} \equiv \Delta_j.
\end{split}
\end{equation}\]</span></li>
<li>So consumer <span class="math inline">\(i\)</span> purchases good <span class="math inline">\(j\)</span> if and only if <span class="math inline">\(z_i \in [\Delta_{j - 1}, \Delta_j)\)</span> and buys nothing if:
<span class="math display">\[\begin{equation}
z_i \le \Delta_0 \equiv \min\{p_1/x_1, \cdots p_J/x_j\}.
\end{equation}\]</span></li>
<li>Letting <span class="math inline">\(F(z)\)</span> be the distribution function of <span class="math inline">\(z\)</span>, the aggregate demand for good <span class="math inline">\(j\)</span> is:
<span class="math display">\[\begin{equation}
\sigma_j(p, x, z) = N[F(\Delta_{j}) - F(\Delta_{j - 1})].
\end{equation}\]</span></li>
</ul>
</div>
<div id="econometric-models" class="section level3 hasAnchor" number="4.4.13">
<h3><span class="header-section-number">4.4.13</span> Econometric Models<a href="demand.html#econometric-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>So far there was no econometrics.</li>
<li>Next we define what are observable and unobservable, and what are known and unknown.</li>
<li>Then consider how to identify and estimate the model.</li>
</ul>
</div>
<div id="multinomial-logit-model-preference-shock" class="section level3 hasAnchor" number="4.4.14">
<h3><span class="header-section-number">4.4.14</span> Multinomial Logit Model: Preference Shock<a href="demand.html#multinomial-logit-model-preference-shock" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>This originates at <span class="citation">D. L. Mcfadden (<a href="#ref-Mcfadden1974">1974</a>)</span>.</li>
<li>See <span class="citation">Train (<a href="#ref-Train2009">2009</a>)</span> for reference.</li>
<li>Suppose that there is some unobservable component in consumer characteristics.</li>
<li>In reality, consumers choice change somewhat randomly.</li>
<li>Let’s capture such a <strong>preference shock</strong> by consider the following model:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i) + \epsilon_{ij},
\end{equation}\]</span>
with some random vector:
<span class="math display">\[\begin{equation}
\epsilon_i \equiv (\epsilon_{i0}, \cdots, \epsilon_{iJ})&#39; \sim G.
\end{equation}\]</span></li>
<li>At this point, <span class="math inline">\(G\)</span> can be any distribution and the shocks can be dependent across <span class="math inline">\(j\)</span> within <span class="math inline">\(i\)</span>.</li>
<li><span class="math inline">\(p, x, y_i, z_i\)</span> are <strong>observed</strong> but <span class="math inline">\(\epsilon_{ij}\)</span> are <strong>unobserved</strong>.</li>
<li>When the realization of the preference shock is given, the consumer choice is:
<span class="math display">\[
q_j(p, x, y_i, z_i, \epsilon_{i}) \equiv 1\{j = \text{argmax}_{k = 0, \cdots, J} v(p_k, x_k, y_i, z_i) + \epsilon_{ik}\}
\]</span>
for <span class="math inline">\(k = 0, \cdots, J\)</span>.</li>
<li>The <strong>choice probability</strong> as observed by econometrician is:
<span class="math display">\[
\sigma_j(p, x, y_i, z_i) \equiv \int q_j(p, x, y_i, z_i, \epsilon_{i}) dG(\epsilon_i).
\]</span></li>
</ul>
</div>
<div id="multinomial-logit-model-distributional-assumption" class="section level3 hasAnchor" number="4.4.15">
<h3><span class="header-section-number">4.4.15</span> Multinomial Logit Model: Distributional Assumption<a href="demand.html#multinomial-logit-model-distributional-assumption" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Now assume the followings:</p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span> are independent across <span class="math inline">\(j\)</span>: <span class="math inline">\(G(\epsilon_i) = \prod_{j = 0, \cdots, J} G_j(\epsilon_{ij})\)</span>.</p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span> are identical across <span class="math inline">\(j\)</span>: <span class="math inline">\(G_j(\epsilon_{ij}) = \overline{G}(\epsilon_{ij})\)</span>.</p></li>
<li><p><span class="math inline">\(\overline{G}\)</span> is a type-I extreme value.</p></li>
<li><p><span class="math inline">\(\rightarrow\)</span> The density <span class="math inline">\(g(\epsilon_{ij}) = \exp[-\exp(-\epsilon_{ij}) - \epsilon_{ij}]\)</span>.</p></li>
<li><p>This is called the (homoskedastic) <strong>multinomial logit model</strong>.</p></li>
<li><p>Setting the variance of <span class="math inline">\(\epsilon_{ij}\)</span> at 1 for some <span class="math inline">\(j\)</span> is a <strong>scale</strong> normalization.</p></li>
<li><p>By dropping some of the assumptions, we can have heteroskedastic multinomial logit model, generalized extreme value model, and so on.</p></li>
<li><p>Another popular distribution assumption is to assume a multivariate normal distribution of <span class="math inline">\(\epsilon_i\)</span>. This case is called the <strong>multinomial probit model</strong>.</p></li>
</ul>
</div>
<div id="multinomial-logit-model-choice-probability" class="section level3 hasAnchor" number="4.4.16">
<h3><span class="header-section-number">4.4.16</span> Multinomial Logit Model: Choice Probability<a href="demand.html#multinomial-logit-model-choice-probability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The <strong>choice probability</strong> of consumer <span class="math inline">\(i\)</span> of good <span class="math inline">\(j\)</span> is:
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_j(p, x, y_i, z_i) &amp; \equiv \mathbb{P}\{j = \text{argmax}_{k = 0, 1, \cdots, J} v(p_k, x_k, y_i, z_i) + \epsilon_{ik}  \}\\
&amp;=\mathbb{P}\{v(p_j, x_j, y_i, z_i) -  v(p_k, x_k, y_i, z_i) \ge \epsilon_{ik} - \epsilon_{ij}, \forall k \neq j\}\\
&amp; = \text{...after some algebra: leave as an exercise...}\\
&amp;= \frac{\exp[v(p_j, x_j, y_i, z_i) ]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i)] }.
\end{split}
\end{equation}\]</span></li>
<li>For example, if:
<span class="math display">\[\begin{equation}
v(p_k, x_k, y_i, z_i) = \beta_i&#39;x_k + \alpha_i (y_i - p_k),
\end{equation}\]</span></li>
</ul>
<p><span class="math display">\[\begin{equation}
\begin{pmatrix}
\beta_i \\
\alpha_i
\end{pmatrix}
=
\begin{pmatrix}
\beta_0 \\
\alpha_0
\end{pmatrix}
+
\begin{pmatrix}
\Gamma\\
\pi&#39;
\end{pmatrix}
z_i.
\end{equation}\]</span>
- Then, we have:
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_{j}(p, x, y_i, z_i) &amp;= \frac{\exp[\beta_i&#39;x_j + \alpha_i (y_i - p_j) ]}{\sum_{k = 0}^J \exp[\beta_i&#39;x_k + \alpha_i (y_i - p_k) ]}\\
&amp;= \frac{\exp[\beta_i&#39;x_j - \alpha_i p_j]}{\sum_{k = 0}^J \exp[\beta_i&#39;x_k - \alpha_i p_k]}
\end{split}
\end{equation}\]</span>
- If we normalize the characteristics vector so that <span class="math inline">\(w_0 = 0\)</span> holds for the outside option, it becomes:
<span class="math display">\[
\sigma_{j}(p, x, y_i, z_i) = \frac{\exp[\beta_i&#39;x_j - \alpha_i p_j]}{1 + \sum_{k = 1}^J \exp[\beta_i&#39;x_k - \alpha_i p_k]}
\]</span></p>
</div>
<div id="multinomial-logit-model-inclusive-value" class="section level3 hasAnchor" number="4.4.17">
<h3><span class="header-section-number">4.4.17</span> Multinomial Logit Model: Inclusive Value<a href="demand.html#multinomial-logit-model-inclusive-value" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The expected utility for consumer <span class="math inline">\(i\)</span> before the preference shocks are drawn under multinomial logit model is given by:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\mathbb{E}\{\max_{j = 0, \cdots, J} v(p_j, x_j, y_i, z_i) + \epsilon_{ij}\} \\
&amp;= \text{   ...after some algebra: leave as an exercise...}\\
&amp;= \ln \Bigg\{\sum_{j = 0}^J \exp[v(p_j, x_j, y_i, z_i)] \Bigg\} + constant.
\end{split}
\end{equation}\]</span></li>
<li>This is sometimes called the <strong>inclusive value</strong> of the choice set.</li>
</ul>
</div>
<div id="maximum-likelihood-estimation-of-multinomial-logit-model" class="section level3 hasAnchor" number="4.4.18">
<h3><span class="header-section-number">4.4.18</span> Maximum Likelihood Estimation of Multinomial Logit Model<a href="demand.html#maximum-likelihood-estimation-of-multinomial-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Suppose we observe a sequence of income <span class="math inline">\(y_i\)</span>, consumer characteristics <span class="math inline">\(z_i\)</span>, choice <span class="math inline">\(q_{i}\)</span>, product characteristics <span class="math inline">\(x_j\)</span> and price <span class="math inline">\(p_j\)</span>.</li>
<li><span class="math inline">\(q_i = (q_{i0}, \cdots, q_{iJ})&#39;\)</span> and <span class="math inline">\(q_{ij} = 1\)</span> if <span class="math inline">\(j\)</span> is chosen and <span class="math inline">\(0\)</span> otherwise.</li>
<li>The parameter of interest is the mean indirect utility function <span class="math inline">\(v\)</span>.</li>
<li>Then the log likelihood of <span class="math inline">\(\{q_i\}_{i = 1}^N\)</span> conditional on <span class="math inline">\(\{y_i, z_i\}_{i = 1}^N\)</span> and <span class="math inline">\(\{x_j,p_j\}_{j = 1}^J\)</span> is:
<span class="math display">\[\begin{equation}
\begin{split}
l(v; q, y, z, w) &amp;= \sum_{i = 1}^N \ln \mathbb{P}\{q_i = q(p, x, y_i, z_i)|p, x, y_i, z_i\}\\
&amp; = \sum_{i = 1}^N \log \Bigg\{ \prod_{j = 0}^{J} \sigma_{j}(p, x, y_i, z_i)^{q_{ij}} \Bigg\}\\
&amp;= \sum_{i = 1}^N \sum_{j = 0}^J \log \sigma_{j}(p, x, y_i, z_i)^{q_{ij}}.
\end{split}
\end{equation}\]</span></li>
<li>We can estimate the parameters by finding parameters that maximize the log likelihood.</li>
</ul>
</div>
<div id="nonlinear-least-square-estimation-of-multinomial-logit-model" class="section level3 hasAnchor" number="4.4.19">
<h3><span class="header-section-number">4.4.19</span> Nonlinear Least Square Estimation of Multinomial Logit Model<a href="demand.html#nonlinear-least-square-estimation-of-multinomial-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>The multinomial logit model can be estimated by nonlinear least square method as well.</p></li>
<li><p>Suppose that the share of product <span class="math inline">\(j\)</span> among consumers with characteristics <span class="math inline">\(z\)</span> and income <span class="math inline">\(y\)</span> was:
<span class="math display">\[\begin{equation}
\sigma_j(p, x, y, z).
\end{equation}\]</span></p></li>
<li><p>Note that:
<span class="math display">\[\begin{equation}
\begin{split}
\ln \sigma_{j}(p, x, y, z)  &amp;= \ln \Bigg\{ \frac{\exp[v(p_j, x_j, y, z) ]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y, z)] }  \Bigg\}\\
&amp;= v(p_j, x_j, y, z) - \ln\Bigg\{ \sum_{k = 0}^J \exp[v(p_k, x_k, y, z)]  \Bigg\}.
\end{split}
\end{equation}\]</span></p></li>
<li><p>Moreover, because of the location normalization of the utility function,
<span class="math display">\[\begin{equation}
\sigma_{0}(p, x, y, z) = \frac{1}{\sum_{k = 0}^J \exp[v(p_j, x_k, y, z)] }.
\end{equation}\]</span></p></li>
<li><p>Hence,
<span class="math display">\[\begin{equation}
\ln \sigma_{j}(p, x, y, z) - \ln \sigma_{0}(p, x, y, z) = v(p, x_j, y, z).
\end{equation}\]</span></p></li>
<li><p>The left-hand variables are observed in the data.</p></li>
<li><p>Let <span class="math inline">\(s_j(y, z)\)</span> be the share of product <span class="math inline">\(j\)</span> among consumers with characteristics <span class="math inline">\(z\)</span> and income <span class="math inline">\(y\)</span> <strong>in the data</strong>.</p></li>
<li><p>This can be calculated from the consumer-level data.</p></li>
<li><p>More importantly, if there is the total sales data for each demographic, we can use this approach.</p></li>
<li><p>Then, we can estimate the parameter by NLLS such that:
<span class="math display">\[\begin{equation}
\min \sum_{(y, z)} \sum_{j = 1}^J \{\ln[s_{j}(y, z)/s_{0}(y, z)] - v(p_j, x_j, y, z)\}^2.
\end{equation}\]</span></p></li>
<li><p>If <span class="math inline">\(v\)</span> is linear in parameter, it is the ordinal least squares:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_m) = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span></p></li>
</ul>
<p><span class="math display">\[\begin{equation}
\ln[s_{j}(y, z)/s_{0}(y, z)] = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span></p>
</div>
<div id="iia-problem" class="section level3 hasAnchor" number="4.4.20">
<h3><span class="header-section-number">4.4.20</span> IIA Problem<a href="demand.html#iia-problem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Multinomial logit problem is intuitive and easy to implement.</li>
<li>However, there are several problems in the model.</li>
<li>The most important problem is the <strong>independence of irrelevant alternatives (IIA)</strong> problem.</li>
<li>Notice that:
<span class="math display">\[\begin{equation}
\frac{\sigma_j(p, x, y, z)}{\sigma_{k}(p, x, y, z)} = \frac{\exp[v(p_j, x_j, y, z)]}{\exp[v(p_k, x_k, y, z)]}.
\end{equation}\]</span></li>
<li>The ratio of choice probabilities between two alternatives depend only on the mean indirect utility of these two alternatives and <strong>independent of irrelevant alternatives (IIA)</strong>.</li>
<li>Why is this a problem?</li>
</ul>
</div>
<div id="blue-bus-and-red-bus-problem" class="section level3 hasAnchor" number="4.4.21">
<h3><span class="header-section-number">4.4.21</span> Blue Bus and Red Bus Problem<a href="demand.html#blue-bus-and-red-bus-problem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Suppose that you can go to a town by bus or by train.</li>
<li>Half of commuters use a bus and the other half use a train.</li>
<li>The existing bus was blue. Now, the county introduced a red bus, which is identical to the existing blue bus.</li>
<li>No one take care of the color of bus. So the mean indirect utility of blue bus and red bus are equal.</li>
<li>What is the new share across blue bus, red bus, and train?</li>
<li>IIA <span class="math inline">\(\to\)</span> share of blue bus = share of train.</li>
<li>Buses are identical <span class="math inline">\(\to\)</span> share of blue bus = share of red bus.</li>
<li>Therefore, shares have to be 1/3, respectively.</li>
<li>But shouldn’t it be that train keeps half share and bus have half share in total?</li>
</ul>
</div>
<div id="restrictive-price-elasticity" class="section level3 hasAnchor" number="4.4.22">
<h3><span class="header-section-number">4.4.22</span> Restrictive Price Elasticity<a href="demand.html#restrictive-price-elasticity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>IIA property restrict price elasticities in an unfavorable manner.</li>
<li>This is a serious problem because the main purpose for us to estimate demand functions is to identify the price elasticity.</li>
<li>Let <span class="math inline">\(v(p_j, x_j, y, z) = \beta_z&#39;x_j - \alpha_z p_j\)</span>. Then, we have:
<span class="math display">\[\begin{equation}
e_{jk} =
\begin{cases}
-\alpha p_{j} (1 - \sigma_j(p, x, y, z)) &amp;\text{   if   } k = j\\
\alpha p_{k} \sigma_k(p_k, x_k, y, z) &amp;\text{   if   } k \neq j.
\end{cases}
\end{equation}\]</span></li>
<li>The price elasticity is completely determined by the existing choice probabilities of the relevant alternatives.</li>
<li>Suppose that there are coca cola, Pepsi cola, and a coffee.</li>
<li>The shares were 1/2, 1/6, 1/3, respectively.</li>
<li>Suppose that the price of coca cola increased.</li>
<li>We expect that they instead purchase Pepsi cola because Pepsi cola is more similar to coca cola than coffee.</li>
<li>However, according to the previous result, twice more consumers substitute to coffee rather than to Pepsi cola.</li>
</ul>
</div>
<div id="monotonic-inclusive-value" class="section level3 hasAnchor" number="4.4.23">
<h3><span class="header-section-number">4.4.23</span> Monotonic Inclusive Value<a href="demand.html#monotonic-inclusive-value" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Suppose that there is a good whose mean indirect utility is <span class="math inline">\(v\)</span>.</li>
<li>The inclusive value for this choice set is <span class="math inline">\(\ln[1 + \exp(v)]\)</span>.</li>
<li>Suppose that we put <span class="math inline">\(J\)</span> same goods on the shelf and consumer can choose any of them.</li>
<li>The inclusive value is <span class="math inline">\(\ln[1 + J \exp(v)]\)</span>.</li>
<li>We just added the same goods. But the expected utility of consumer increases monotonically in the number of alternatives.</li>
</ul>
</div>
<div id="the-source-of-the-problem" class="section level3 hasAnchor" number="4.4.24">
<h3><span class="header-section-number">4.4.24</span> The Source of the Problem<a href="demand.html#the-source-of-the-problem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><strong>The source of the problem is that there is no correlation in the preference shock across products</strong>.</li>
<li>When the preference shock to coca cola is high, the preference shock to Pepsi cola should be high, while the preference shock to coffee should be relatively independent.</li>
<li>Because the expected value of the maximum of the preference shocks increases according to the number of alternatives, the inclusive value becomes increasing in the number of alternatives.</li>
<li>However, the preference shocks should be the same for the same good. Then, the the expected value of the maximum of the preference shock should not increase even if we add the same products on the shelf.</li>
</ul>
</div>
<div id="correlation-in-preference-shocks" class="section level3 hasAnchor" number="4.4.25">
<h3><span class="header-section-number">4.4.25</span> Correlation in Preference Shocks<a href="demand.html#correlation-in-preference-shocks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Therefore, the preference shock should be such that: preference shocks between two alternative should be more correlated when they are closer in the characteristics space.</li>
<li>So we have to allow the covariance matrix of the preference shock to be free parameters.</li>
<li>If we allow flexible covariance matrix, the curse of dimensionality in the number of alternatives comes back: The dimensionality of the covariance matrix is <span class="math inline">\(J^2\)</span>.</li>
<li>Another way is to remove <span class="math inline">\(\epsilon_{ij}\)</span>: it is called a <strong>pure characteristics model</strong> <span class="citation">(<a href="#ref-Berry2007">Steven Berry &amp; Pakes, 2007</a>)</span>.</li>
<li>But the pure characteristics model is computationally not straightforward.</li>
<li>We explore the way of introducing mild correlation across similar products in the preference shocks.</li>
</ul>
</div>
<div id="observed-and-unobserved-consumer-heterogeneity" class="section level3 hasAnchor" number="4.4.26">
<h3><span class="header-section-number">4.4.26</span> Observed and Unobserved Consumer Heterogeneity<a href="demand.html#observed-and-unobserved-consumer-heterogeneity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Consider beverage demand and let <span class="math inline">\(x_j = \text{carbonated}_j\)</span> and <span class="math inline">\(z_i = \text{teenager}_i\)</span>.</li>
<li>Suppose that the mean indirect utility is:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i) = \beta_i (\text{carbonated})_j - \alpha_i p_j,
\end{equation}\]</span></li>
</ul>
<p><span class="math display">\[\begin{equation}
\beta_i = 0.1 + 0.2 \cdot (\text{teenager})_i.
\end{equation}\]</span></p>
<ul>
<li><p>The mean utility of a carbonated drink for a teenager is 0.3 but only 0.1 for others.</p></li>
<li><p>When coca cola was not available, teenager will substitute more to Pepsi cola than non-teenagers.</p></li>
<li><p>IIA holds at the market-segment level but not at the market level.</p></li>
<li><p>How to avoid IIA at the market-segment level?: Introduce unobserved consumer heterogeneity.</p></li>
<li><p>Suppose that the mean indirect utility is:
<span class="math display">\[\begin{equation}
\beta_i = 0.1 + 0.2 \cdot (\text{teenager})_i + \nu_i.
\end{equation}\]</span></p></li>
<li><p>Consumers with high <span class="math inline">\(\nu_i\)</span> values carbonated drinks more than those with low <span class="math inline">\(\nu_i\)</span> values.</p></li>
<li><p>When coca cola was not available, consumers with high <span class="math inline">\(\nu_i\)</span> will substitute more to Pepsi cola than those with low <span class="math inline">\(\nu_i\)</span> values.</p></li>
<li><p>IIA holds at the market-segment-<span class="math inline">\(\nu\)</span> level but not at the market-segment level.</p></li>
<li><p>In the above example, “<span class="math inline">\(0.2 \cdot (\text{carbonated})_i\)</span>” captures the consumer heterogeneity by observed characteristics and “<span class="math inline">\(\nu_i\)</span>” by unobserved characteristics.</p></li>
</ul>
</div>
<div id="mixed-logit-model" class="section level3 hasAnchor" number="4.4.27">
<h3><span class="header-section-number">4.4.27</span> Mixed Logit Model<a href="demand.html#mixed-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Suppose that the mean indirect utility is:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i) = \beta_i&#39; x_j - \alpha_i p_j,
\end{equation}\]</span>
with
<span class="math display">\[\begin{equation}
(\beta_i, \alpha_i) \sim f(\beta_i, \alpha_i|y_i, z_i).
\end{equation}\]</span></li>
<li>If <span class="math inline">\(\epsilon_{ij}\)</span> is drawn i.i.d. from type-I extreme value distribution, the choice probability of good <span class="math inline">\(j\)</span> by consumer <span class="math inline">\(i\)</span> conditional on <span class="math inline">\(p, x, y_i, z_i\)</span> is:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) = \int_{\beta_i, \alpha_i} \frac{\exp[v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i)]}{\sum_{k = 0}^J \exp[v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i)]} f(\beta_i, \alpha_i|y_i, z_i) d\beta_i d\alpha_i.
\end{equation}\]</span></li>
<li>This is called the <strong>mixed-logit model</strong>.</li>
<li>If the distribution of <span class="math inline">\(\epsilon_{ij}\)</span> is different, it is no longer mixed logit.</li>
<li>Conditional on <span class="math inline">\((\beta_i, \alpha_i)\)</span> the choice probability is written in the same way with the multinomial logit model.</li>
<li><span class="math inline">\(\beta_i, \alpha_i\)</span> are marginal out, because econometrician does not observe them.</li>
</ul>
</div>
<div id="mixed-logit-model-parametric-assumptions" class="section level3 hasAnchor" number="4.4.28">
<h3><span class="header-section-number">4.4.28</span> Mixed Logit Model : Parametric Assumptions<a href="demand.html#mixed-logit-model-parametric-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>It is often assumed that:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i) = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span></li>
<li><span class="citation">McFadden &amp; Train (<a href="#ref-Mcfadden2000">2000</a>)</span> showed that any discrete choice models that are consistent with the random utility maximization can be arbitrarily closely approximated by this class of mixed-logit model.</li>
<li>The distribution of <span class="math inline">\(\beta_i\)</span> and <span class="math inline">\(\alpha_i\)</span> is often assumed to be:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\beta_i = \beta_0 + \Gamma z_i + \Sigma \nu_i,\\
&amp;\alpha_i = \alpha_0 + \pi&#39; z_i + \omega \upsilon_i,
\end{split}
\end{equation}\]</span>
where <span class="math inline">\(\nu_i\)</span> and <span class="math inline">\(\upsilon_i\)</span> are i.i.d. standard normal random vectors.</li>
</ul>
</div>
<div id="mixed-logit-model-iia" class="section level3 hasAnchor" number="4.4.29">
<h3><span class="header-section-number">4.4.29</span> Mixed Logit Model: IIA<a href="demand.html#mixed-logit-model-iia" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>There is no IIA at the market-segment level:
<span class="math display">\[\begin{equation}
\frac{\sigma_{j}(p, x, y, z)}{\sigma_{l}(p, x, y_i, z_i)} = \frac{\int_{\beta_i, \alpha_i} \frac{\exp[v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i)]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i, \beta_i, \alpha_i)]} f(\beta_i, \alpha_i|x, y_i) d\beta_i d\alpha_i}{\int_{\beta_i, \alpha_i} \frac{\exp[v(p_l, x_l, y_i, z_i, \beta_i, \alpha_i)]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i, \beta_i, \alpha_i)]} f(\beta_i, \alpha_i|x, y_i) d\beta_i d\alpha_i}.
\end{equation}\]</span></li>
<li>The share ratio depends on the price and characteristics of all the other products.</li>
</ul>
</div>
<div id="mixed-logit-moel-price-elasticities" class="section level3 hasAnchor" number="4.4.30">
<h3><span class="header-section-number">4.4.30</span> Mixed Logit Moel: Price Elasticities<a href="demand.html#mixed-logit-moel-price-elasticities" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let:
<span class="math display">\[\begin{equation}
v(p_j, x_j, y_i, z_i, \beta_i, \alpha_i) = \beta_i&#39; x_j - \alpha_i p_j.
\end{equation}\]</span></li>
<li>The price elasticities of the choice probabilities conditional on <span class="math inline">\(p, x, y_i, z_i\)</span> is:
<span class="math display">\[\begin{equation}
e_{jk} =
\begin{cases}
-\frac{p_j}{\sigma_j} \int \alpha_i \sigma_{ij}(1 - \sigma_{ij})f(\beta_i, \alpha_i|y_i, z_i) d\beta_i d\alpha_i &amp;\text{   if   } j = k\\
\frac{p_k}{\sigma_j} \int \alpha_i \sigma_{ij} \sigma_{ik} f(\beta_i, \alpha_i|y_i, z_i) d\beta_i d\alpha_i &amp;\text{   otherwise},
\end{cases}
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
\sigma_{ij} = \frac{\exp(\beta_i&#39;x_j - \alpha_i p_j)}{\sum_{k = 0}^J \exp(\beta_i&#39;x_k - \alpha_i p_k)}.
\end{equation}\]</span></li>
<li>The price elasticity depends on the density of unobserved consumer types.</li>
</ul>
</div>
<div id="simulated-maximum-likelihood-estimation-of-the-mixed-logit-model" class="section level3 hasAnchor" number="4.4.31">
<h3><span class="header-section-number">4.4.31</span> Simulated Maximum Likelihood Estimation of the Mixed Logit Model<a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The choice probability of the mixed logit model is an integration of the multinomial logit choice probability.</li>
<li>This is not derived analytically in general.</li>
<li>We can use simulation to evaluate the choice probability:</li>
<li>Draw <span class="math inline">\(R\)</span> values of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\{\beta^r, \alpha^r \}_{r = 1}^R\)</span>.</li>
<li>Compute the multinomial choice probabilities associated with <span class="math inline">\((\beta^r, \alpha^r)\)</span> for each <span class="math inline">\(r = 1, \cdots, R\)</span>.</li>
<li>Approximate the choice probability with the mean of the simulated multinomial choice share:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) \approx \hat{\sigma}_{j}(p, x, y_i, z_i) \equiv \frac{1}{R} \sum_{r = 1}^R  \frac{\exp[v(p_j, x_j, y_i, z_i, \beta^r, \alpha^r)]}{\sum_{k = 0}^J \exp[v(p_k, x_k, y_i, z_i, \beta^r, \alpha^r)]}.
\end{equation}\]</span></li>
<li>This is one of the numerical integration: <strong>Monte Carlo integration</strong>.</li>
<li>Another approach is to use <strong>quadrature</strong>. See <span class="citation">Judd (<a href="#ref-Judd1998">1998</a>)</span> for reference.</li>
</ul>
</div>
<div id="simulated-maximum-likelihood-estimation-of-the-mixed-logit-model-1" class="section level3 hasAnchor" number="4.4.32">
<h3><span class="header-section-number">4.4.32</span> Simulated Maximum Likelihood Estimation of the Mixed Logit Model<a href="demand.html#simulated-maximum-likelihood-estimation-of-the-mixed-logit-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>There are <span class="math inline">\(t = 1, \cdots, T\)</span> markets and there <span class="math inline">\(i = 1, \cdots, N\)</span> consumers in each market.</p></li>
<li><p>Let <span class="math inline">\(\mathcal{J}_t\)</span> be the set of products that are available in market <span class="math inline">\(t\)</span>.</p></li>
<li><p>Suppose that we observe income <span class="math inline">\(y_{it}\)</span>, characteristics <span class="math inline">\(z_{it}\)</span>, and choice <span class="math inline">\(q_{it}\)</span> for each consumer in a market.</p></li>
<li><p>Suppose that we observe product characteristics <span class="math inline">\(x_{jt}\)</span> and price <span class="math inline">\(p_{jt}\)</span> of each product in each market.</p></li>
<li><p>The simulated conditional log likelihood is:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\sum_{i = 1}^N \sum_{t = 1}^T \ln \mathbb{P}\{q_{it} = q(p_t, x_t, y_{it}, z_{it})|p_t, x_t, y_{it}, z_{it}\} \\
&amp;\approx \sum_{i = 1}^N \sum_{t = 1}^T \ln \Bigg\{ \prod_{j \in \mathcal{J}_t \cup \{0\}} \hat{\sigma}_{j}(p_t, x_t, y_{it}, z_{it})^{q_{itj}} \Bigg\}.
\end{split}
\end{equation}\]</span></p></li>
<li><p>We find parameters that maximize the simulated conditional log likelihood.</p></li>
</ul>
</div>
<div id="simulated-non-linear-least-square-estimation-of-the-mixed-logit-model" class="section level3 hasAnchor" number="4.4.33">
<h3><span class="header-section-number">4.4.33</span> Simulated Non-linear Least Square Estimation of the Mixed Logit Model<a href="demand.html#simulated-non-linear-least-square-estimation-of-the-mixed-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Suppose that we only know the sales or share at the market-segment level.</li>
<li>That is, we only observe the share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> among consumers of characteristics <span class="math inline">\(z\)</span> and income <span class="math inline">\(y\)</span>, <span class="math inline">\(s_{jt}(y, z)\)</span>.</li>
<li>Then we can estimate the parameter by:
<span class="math display">\[\begin{equation}
\min \sum_{t = 1}^T \sum_{j \in \mathcal{J}_t \cup \{0\}} \sum_{(y, z) \in \mathcal{Y} \times \mathcal{Z}} \{s_{jt}(y, z) - \hat{\sigma}_{j}(p_t, x_t, y, z)\}^2.
\end{equation}\]</span></li>
</ul>
</div>
<div id="numerical-integration-with-quadrature" class="section level3 hasAnchor" number="4.4.34">
<h3><span class="header-section-number">4.4.34</span> Numerical Integration with Quadrature<a href="demand.html#numerical-integration-with-quadrature" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Refer to Section 7 of <span class="citation">Judd (<a href="#ref-Judd1998">1998</a>)</span>.</li>
<li>Gauss-Hermite Quadrature uses the following approximation:
<span class="math display">\[\begin{equation}
\int_{-\infty}^\infty f(x) e^{-x^2} dx \approx \sum_{i = 1}^n \omega_i f(x_i) + \frac{n\! \sqrt{\pi}}{2^n} \frac{f^{(2n)}(\xi)}{(2n)\!}
\end{equation}\]</span>
for some <span class="math inline">\(\xi \in (-\infty, \infty)\)</span>.</li>
<li><span class="math inline">\(x_i\)</span> are the roots of the Hermite polynomial and <span class="math inline">\(w_i\)</span> are the weights.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="demand.html#cb1-1" tabindex="-1"></a>pracma<span class="sc">::</span><span class="fu">gaussHermite</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## $x
## [1] -2.020183e+00 -9.585725e-01  8.881784e-16  9.585725e-01  2.020183e+00
## 
## $w
## [1] 0.01995324 0.39361932 0.94530872 0.39361932 0.01995324</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="demand.html#cb3-1" tabindex="-1"></a>pracma<span class="sc">::</span><span class="fu">gaussHermite</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## $x
##  [1] -3.4361591 -2.5327317 -1.7566836 -1.0366108 -0.3429013  0.3429013  1.0366108  1.7566836
##  [9]  2.5327317  3.4361591
## 
## $w
##  [1] 7.640433e-06 1.343646e-03 3.387439e-02 2.401386e-01 6.108626e-01 6.108626e-01 2.401386e-01
##  [8] 3.387439e-02 1.343646e-03 7.640433e-06</code></pre>
<ul>
<li>In general, when <span class="math inline">\(Y\)</span> follows a normal distribution of mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>, we have:
<span class="math display">\[\begin{equation}
\begin{split}
\mathbb{E}\{f(Y)\} &amp;= (2 \pi \sigma^2)^{-1/2} \int_{-\infty}^\infty f(y) e^{-\frac{(y - \mu)^2}{2\sigma^2}} dy \\
&amp;=(2 \pi \sigma^2)^{-1/2} \int_{-\infty}^\infty f(\mu + \sqrt{2} \sigma z) e^{- z^2} \sqrt{2} \sigma dz \\
&amp;=\pi^{-1/2} \int_{-\infty}^\infty f(\mu + \sqrt{2} \sigma z) e^{- z^2} dz \\
&amp;\approx \pi^{-1/2} \sum_{i = 1}^n \omega_i f(\mu + \sqrt{2} \sigma z_i).
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="nested-logit-model-a-special-case-of-mixed-logit-model" class="section level3 hasAnchor" number="4.4.35">
<h3><span class="header-section-number">4.4.35</span> Nested Logit Model: A Special Case of Mixed Logit Model<a href="demand.html#nested-logit-model-a-special-case-of-mixed-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let <span class="math inline">\(w_{j1}, \cdots, w_{jG}\)</span> be the indicator of product category, i.e., <span class="math inline">\(w_{jg}\)</span> takes value 1 if good <span class="math inline">\(j\)</span> belong to category <span class="math inline">\(g\)</span> and 0 otherwise.</li>
<li>e.g., car category = {Sports, Luxury, Large, Midsize, Small}.</li>
<li>We have:
<span class="math display">\[\begin{equation}
v(p, x_j, y_i, z_i) = \beta&#39;x_j - \alpha_i p_j + \sum_{g = 0}^G \zeta_{ig} w_{jg} + \epsilon_{ij}.
\end{equation}\]</span></li>
<li>If <span class="math inline">\(\zeta_{ig}\)</span> takes high value, the consumer attaches higher value to the category.</li>
<li>When a product in category <span class="math inline">\(g\)</span> was not available, consumers with high <span class="math inline">\(\zeta_{ig}\)</span> will substitute more to the other products in the same category than consumers with low <span class="math inline">\(\zeta_{ig}\)</span>.</li>
</ul>
</div>
<div id="nested-logit-model-distributional-assumption" class="section level3 hasAnchor" number="4.4.36">
<h3><span class="header-section-number">4.4.36</span> Nested Logit Model: Distributional Assumption<a href="demand.html#nested-logit-model-distributional-assumption" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let
<span class="math display">\[\begin{equation}
\varepsilon_{ij} \equiv \sum_{g = 0}^G \zeta_{ig} w_{jg} + \epsilon_{ij}.
\end{equation}\]</span></li>
<li>Under certain distributional assumption on <span class="math inline">\(\zeta_{ig}\)</span> and <span class="math inline">\(\epsilon_{ij}\)</span>, the term <span class="math inline">\(\varepsilon_{ij}\)</span> have a cumulative distribution <span class="citation">(<a href="#ref-Cardell1997">Cardell, 1997</a>)</span>:
<span class="math display">\[\begin{equation}
F(\varepsilon_i) = \exp\Bigg\{- \sum_{g = 0}^G \Bigg(\sum_{j \in \text{   category   } g} \exp[-\varepsilon_{ij}/\lambda_g] \Bigg)^{\lambda_g}  \Bigg\}.
\end{equation}\]</span></li>
</ul>
</div>
<div id="nested-logit-model-choice-probability" class="section level3 hasAnchor" number="4.4.37">
<h3><span class="header-section-number">4.4.37</span> Nested Logit Model: Choice Probability<a href="demand.html#nested-logit-model-choice-probability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Under this distributional assumption, the choice probability is:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) = \frac{\exp[v(p, x_j, y_i, z_i)/\lambda_g] \Bigg(\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]\Bigg)^{\lambda_g - 1}}{\sum_{g = 0}^G \Bigg(\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]\Bigg)^{\lambda_g}},
\end{equation}\]</span>
if good <span class="math inline">\(j\)</span> belongs to category <span class="math inline">\(g\)</span>.</li>
<li>The higher <span class="math inline">\(\lambda_g \in [0, 1]\)</span> implies lower correlation within category <span class="math inline">\(g\)</span>.</li>
<li><span class="math inline">\(\lambda_g = 0\)</span> for all <span class="math inline">\(g\)</span> coincides with the multinomial logit model.</li>
</ul>
</div>
<div id="nested-logit-model-decomposition-of-the-choice-probability" class="section level3 hasAnchor" number="4.4.38">
<h3><span class="header-section-number">4.4.38</span> Nested Logit Model: Decomposition of the Choice Probability<a href="demand.html#nested-logit-model-decomposition-of-the-choice-probability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The choice probability can be decomposed into two parts:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\sigma_{j}(p, x, y_i, z_i)\\
&amp;= \frac{\exp[v(p, x_j, y_i, z_i)/\lambda_g]}{\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]} \frac{\left(\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]\right)^{\lambda_g}}{\sum_{g = 0}^G \Bigg(\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]\Bigg)^{\lambda_g}}.
\end{split}
\end{equation}\]</span></li>
<li>Letting:
<span class="math display">\[
I_{g}(p, x, y_i, z_i) \equiv \log \sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g],
\]</span>
we have:
<span class="math display">\[\begin{equation}
\sigma_{j}(p, x, y_i, z_i) = \frac{\exp[v(p, x_j, y_i, z_i)/\lambda_g]}{\sum_{k \in \text{   category   } g} \exp[v(p, x_k, y_i, z_i)/\lambda_g]} \frac{\exp[\lambda_g I_{g}(p, x, y_i, z_i)]}{\sum_{g = 0}^G \exp[\lambda_g I_{g}(p, x, y_i, z_i)]}.
\end{equation}\]</span></li>
<li>The second first term can be interpreted as the probability of choosing product <span class="math inline">\(j\)</span> conditional on choosing category <span class="math inline">\(g\)</span> and the second term as the probability of choosing category <span class="math inline">\(g\)</span>.</li>
</ul>
</div>
<div id="nested-logit-mode-outside-inside-category-and-category-specific-shares" class="section level3 hasAnchor" number="4.4.39">
<h3><span class="header-section-number">4.4.39</span> Nested Logit Mode: Outside, Inside-Category, and Category-specific Shares<a href="demand.html#nested-logit-mode-outside-inside-category-and-category-specific-shares" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>With the outside good as the only member of group zero and <span class="math inline">\(\delta_0 = 0\)</span> and <span class="math inline">\(I_0 = 1\)</span>, we have:
<span class="math display">\[\begin{equation}
\sigma_{0}(p, x, y_i, z_i) = \frac{1}{\sum_{g = 0}^G \exp[\lambda_g I_{g}(p, x, y_i, z_i)]}.
\end{equation}\]</span></li>
<li>Moreover, the inside-category share of good <span class="math inline">\(j\)</span> is
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_{j|g}(p, x, y_i, z_i)
&amp;\equiv \frac{\sigma_{j}(p, x, y_i, z_i)}{\sum_{k \in \text{   category   } g} \sigma_{k}(p, x, y_i, z_i)}\\
&amp;= \frac{v(p, x_j, y_i, z_i)/\lambda_g}{\sum_{k \in \text{   category   } g} v(p, x_k, y_i, z_i)/\lambda_g},
\end{split}
\end{equation}\]</span>
and the share of category <span class="math inline">\(g\)</span> is
<span class="math display">\[\begin{equation}
\begin{split}
\sigma_g(p, x, y_i, z_i)
&amp;\equiv \frac{\sum_{j \in \text{   category   } g} \sigma_{j}(p, x, y_i, z_i)}{\sum_{g = 0}^G \sum_{j \in \text{   category   } g} \sigma_{j}(p, x, y_i, z_i)}\\
&amp;= \frac{\exp[\lambda_g I_{g}(p, x, y_i, z_i)]}{\sum_{g = 0}^G \exp[\lambda_g I_{g}(p, x, y_i, z_i)]}.
\end{split}
\end{equation}\]</span></li>
</ul>
</div>
<div id="nonlinear-least-square-estimation-of-nested-logit-model" class="section level3 hasAnchor" number="4.4.40">
<h3><span class="header-section-number">4.4.40</span> Nonlinear Least Square Estimation of Nested Logit Model<a href="demand.html#nonlinear-least-square-estimation-of-nested-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>We can estimate the parameters of nested logit model by maximum likelihood estimation.</li>
<li>In addition, we can also use the nonlinear least square estimation following <span class="citation">S. T. Berry (<a href="#ref-berryEstimatingDiscreteChoiceModels1994">1994</a>)</span>.</li>
<li>We have
<span class="math display">\[\begin{equation}
\begin{split}
\ln \sigma_{j}(p, x, y_i, z_i) - \ln \sigma_{0}(p, x, y_i, z_i) = \frac{v(p, x_j, y_i, z_i)}{\lambda_g} - (1 - \lambda_g) I_g(p, x, y_i, z_i).
\end{split}
\end{equation}\]</span></li>
<li>Moreover,
<span class="math display">\[\begin{equation}
\begin{split}
I_g(p, x, y_i, z_i) = \frac{\ln s_g(p, x, y_i, z_i) - \ln s_0(p, x, y_i, z_i)}{\lambda_g}.
\end{split}
\end{equation}\]</span></li>
<li>Inserting this to the former and arranging it, we get
<span class="math display">\[\begin{equation}
\begin{split}
\ln \sigma_{j}(p, x, y_i, z_i) - \ln \sigma_{0}(p, x, y_i, z_i) = v(p, x_j, y_i, z_i) + (1 - \lambda_g) \ln s_{j|g}(p, x, y_i, z_i).
\end{split}
\end{equation}\]</span></li>
<li>Replacing shares with data, we can estimate the parameters a non-linear least square estimation.</li>
<li>If <span class="math inline">\(v\)</span> is linear in parameters, we can use the linear least square estimation.</li>
<li>We need instruments for i) price <span class="math inline">\(p_j\)</span> and ii) inside-category share <span class="math inline">\(s_{j|g}\)</span>, respectively.</li>
<li>If <span class="math inline">\(\lambda_g\)</span> is heterogeneous across categories, we need instruments for each of them.</li>
<li>The number of goods in each category is often used as such instruments.</li>
<li>This requires variations in the available goods across markets, and the entry and exit to be exogenous.</li>
<li>These variations are implicitly required in the maximum likelihood estimation, too.</li>
<li>This also means that mixed-logit model also requires these variations for its identification.</li>
</ul>
</div>
<div id="discrete-choice-model-with-unobserved-fixed-effects" class="section level3 hasAnchor" number="4.4.41">
<h3><span class="header-section-number">4.4.41</span> Discrete Choice Model with Unobserved Fixed Effects<a href="demand.html#discrete-choice-model-with-unobserved-fixed-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>We have assumed that good <span class="math inline">\(j\)</span> is characterized by a vector of observed characteristics <span class="math inline">\(x_j\)</span>.</li>
<li>Can econometrician observe all the relevant characteristics of the products in the choice set? Maybe no. For example, econometrician may not observe brand values that are created by advertisement and recognized by consumers.</li>
<li>Such unobserved product characteristics is likely to be correlated with the price.</li>
<li>This can cause <strong>endogeneity problems</strong>.</li>
<li>In the following, we consider the situation where only market-segment level share data is available.</li>
<li>Because we can construct the market-share level data from individual choice level data, all the arguments should go through with the individual choice level data.</li>
</ul>
</div>
<div id="unobserved-fixed-effects-in-multinomial-logit-model" class="section level3 hasAnchor" number="4.4.42">
<h3><span class="header-section-number">4.4.42</span> Unobserved Fixed Effects in Multinomial Logit Model<a href="demand.html#unobserved-fixed-effects-in-multinomial-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>To fix the idea, let’s revisit the multinomial logit model.</li>
<li>For now, we do not consider either observed or unobserved consumer heterogeneity.</li>
<li>Including observed heterogeneity is straightforward.</li>
<li>We discuss how to include unobserved heterogeneity in the subsequent sections.</li>
<li>Suppose that the indirect utility function of good <span class="math inline">\(j\)</span> for consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> is:
<span class="math display">\[\begin{equation}
\beta&#39; x_{jt}  - \alpha p_{jt} + \xi_{jt} + \epsilon_{ijt},
\end{equation}\]</span></li>
<li><span class="math inline">\(\epsilon_{ijt}\)</span> is i.i.d. Type-I extreme value.</li>
<li><span class="math inline">\(\xi_{jt}\)</span> is the <em>unobserved product-market-specific fixed effect</em> of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span>, which can be correlated with <span class="math inline">\(p_{jt}\)</span>.</li>
<li>We hold the assumption that <span class="math inline">\(x_{jt}\)</span> is uncorrelated with <span class="math inline">\(\xi_{jt}\)</span>.</li>
<li>The choice probability of good <span class="math inline">\(j\)</span> for this consumer and hence the choice share in this market is:</li>
</ul>
<p><span class="math display">\[\begin{equation}
\sigma_j(p_t, x_t, \xi_t) = \frac{\exp(\beta&#39; x_j - \alpha p_{jt} + \xi_{jt})}{1 + \sum_{k = 1}^J\exp(\beta&#39; x_k - \alpha p_{kt} +  \xi_{kt} ) }.
\end{equation}\]</span>
- How to deal with the endogeneity between <span class="math inline">\(p_{jt}\)</span> and <span class="math inline">\(\xi_{jt}\)</span>?</p>
</div>
<div id="instrumental-variables-and-inversion" class="section level3 hasAnchor" number="4.4.43">
<h3><span class="header-section-number">4.4.43</span> Instrumental Variables and Inversion<a href="demand.html#instrumental-variables-and-inversion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Suppose that we have a vector of instrumental variables <span class="math inline">\(w_{jt}\)</span> such that:
<span class="math display">\[\begin{equation}
\mathbb{E}\{\xi_{jt}|w_{jt}\} = 0.
\end{equation}\]</span></li>
<li>In a liner model, we <strong>invert</strong> the model for the unobserved fixed effects:
<span class="math display">\[\begin{equation}
\xi_{jt} = y_{jt} - \beta&#39;x_{jt},
\end{equation}\]</span></li>
<li>Notice that the unobserved fixed effect is written as a function of parameters and data.</li>
<li>Then we exploit the moment condition by:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\mathbb{E}\{\xi_{jt}|w_{jt}\} = 0,\\
&amp;\Rightarrow \mathbb{E}\{ \xi_{jt} w_{jt}\} = 0,\\
&amp;\Leftrightarrow \mathbb{E}\{(y_{jt} - \beta&#39;x_{jt}) w_{jt} \} = 0
\end{split}
\end{equation}\]</span></li>
<li>We can estimate <span class="math inline">\(\beta\)</span> by finding the value that makes the sample analogue of the above expectation zero.</li>
</ul>
</div>
<div id="inversion-in-multinomial-logit-model" class="section level3 hasAnchor" number="4.4.44">
<h3><span class="header-section-number">4.4.44</span> Inversion in Multinomial Logit Model<a href="demand.html#inversion-in-multinomial-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Can we invert the multinomial model for <span class="math inline">\(\xi_{jt}\)</span>?</li>
<li>We have:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\ln [\sigma_{jt}(p_t, x_t, \xi_t) / \sigma_{0t}(p_t, x_t, \xi_t)] = \beta&#39; x_j - \alpha p_{jt} + \xi_{jt}\\
&amp;\Leftrightarrow \xi_{jt} = \ln [\sigma_j(p_t, x_t, \xi_t) / \sigma_0(p_t, x_t, \xi_t)] - [\beta&#39; x_j - \alpha p_{jt}].
\end{split}
\end{equation}\]</span></li>
<li>Therefore, the moment condition can be written as:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\mathbb{E}\{\xi_{jt}|w_{jt}\} = 0,\\
&amp;\Rightarrow \mathbb{E}\{\xi_{jt} w_{jt}\} = 0,\\
&amp;\Leftrightarrow \mathbb{E}\{(\ln [\sigma_{jt}(p_t, x_t, \xi_t) / \sigma_{0t}(p_t, x_t, \xi_t)] - [\beta&#39; x_j - \alpha p_{jt}]) w_{jt}  \} = 0.
\end{split}
\end{equation}\]</span></li>
<li>We can evaluate the sample analogue of the expectation by replacing the theoretical choice probability <span class="math inline">\(\sigma\)</span>
with the observed share <span class="math inline">\(s\)</span>.</li>
<li>At the end, it is no different from the linear model where the dependent variable is <span class="math inline">\(\ln s_{jt}/s_{0t}\)</span>.</li>
</ul>
</div>
<div id="market-invariant-product-specific-fixed-effects" class="section level3 hasAnchor" number="4.4.45">
<h3><span class="header-section-number">4.4.45</span> Market-invariant Product-specific Fixed Effects<a href="demand.html#market-invariant-product-specific-fixed-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Furthermore, if you can assume <span class="math inline">\(\xi_{jt} = \xi_j\)</span>, then
<span class="math display">\[\begin{equation}
\ln [\sigma_j(p_t, x_t, \xi_t) / \sigma_0(p_t, x_t, \xi_t)] = \beta&#39; x_{jt} - \alpha p_{jt} + \xi_{j}.
\end{equation}\]</span></li>
<li>This is nothing but a linear regression on <span class="math inline">\(x_j\)</span> and <span class="math inline">\(p_{jt}\)</span> with product-specific unobserved fixed effect.</li>
<li>This can be estimated by a within-estimator.</li>
<li>This specification is a good starting point: we better start with the simplest specification and use the estimate as the initial guess for the following specifications.</li>
</ul>
</div>
<div id="unobserved-consumer-heterogeneity-and-unobserved-fixed-effects-in-mixed-logit-model" class="section level3 hasAnchor" number="4.4.46">
<h3><span class="header-section-number">4.4.46</span> Unobserved Consumer Heterogeneity and Unobserved Fixed Effects in Mixed-logit Model<a href="demand.html#unobserved-consumer-heterogeneity-and-unobserved-fixed-effects-in-mixed-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>So far we abstracted away from the unobserved consumer heterogeneity.</li>
<li>Next, suppose that the indirect utility function of good <span class="math inline">\(j\)</span> for consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> is:
<span class="math display">\[\begin{equation}
\beta_i&#39; x_{jt}  - \alpha_i p_{jt} + \xi_{jt} + \epsilon_{ijt},
\end{equation}\]</span>
where <span class="math inline">\(\epsilon_{ik}\)</span> is i.i.d. Type-I extreme value.</li>
<li>The coefficient are drawn according to:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\beta_{it} = \beta_0 + \Sigma \nu_{it},\\
&amp;\alpha_{it} = \alpha_0 + \Omega \upsilon_{it},
\end{split}
\end{equation}\]</span></li>
<li><span class="math inline">\(\nu_i\)</span> are i.i.d. standard normal random variables.</li>
<li>Then the indirect utility of good <span class="math inline">\(j\)</span> for consumer <span class="math inline">\(i\)</span> in market <span class="math inline">\(t\)</span> is written as:
<span class="math display">\[\begin{equation}
\underbrace{\beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt}}_{\text{(conditional) mean}} + \underbrace{\nu_{it}&#39; \Sigma x_{jt} - \upsilon_{it}&#39; \Omega p_{jt}}_{\text{deviation from the mean}}
\end{equation}\]</span></li>
<li>We refer to <span class="math inline">\(\beta_0, \alpha_0\)</span> as <strong>linear parameters</strong> and <span class="math inline">\(\Sigma, \Omega\)</span> as <strong>non-linear parameters</strong>, because of the reason I explain in the subsequent section.</li>
<li>Let <span class="math inline">\(\theta_1\)</span> be the linear parameters and <span class="math inline">\(\theta_2\)</span> the non-linear parameters and let <span class="math inline">\(\theta = (\theta_1&#39;, \theta_2&#39;)&#39;\)</span>.</li>
</ul>
</div>
<div id="unobserved-fixed-effects-in-mixed-logit-model" class="section level3 hasAnchor" number="4.4.47">
<h3><span class="header-section-number">4.4.47</span> Unobserved Fixed Effects in Mixed-logit Model<a href="demand.html#unobserved-fixed-effects-in-mixed-logit-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The choice share of good <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> is:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\sigma_{j}(p_t, x_t, \xi_t; \theta)\\
&amp;= \int \frac{\exp[\beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt} + \nu_{it}&#39; \Sigma x_{jt} - \upsilon_{it}&#39; \Omega p_{jt}]}{1 + \sum_{k \in \mathcal{J}_t} \exp[\exp[\beta_0&#39; x_{kt} - \alpha_0 p_{kt} + \xi_{kt} + \nu_{it}&#39; \Sigma x_{kt} - \upsilon_{it}&#39; \Omega p_{kt}]]} f(\nu, \upsilon) d \nu d \upsilon.
\end{split}
\end{equation}\]</span></li>
<li>How can we represent <span class="math inline">\(\xi_{jt}\)</span> as a function of parameters of interest to exploit the moment condition?</li>
</ul>
</div>
<div id="representing-xi_jt-as-a-function-of-parameters-of-interest" class="section level3 hasAnchor" number="4.4.48">
<h3><span class="header-section-number">4.4.48</span> Representing <span class="math inline">\(\xi_{jt}\)</span> as a Function of Parameters of Interest<a href="demand.html#representing-xi_jt-as-a-function-of-parameters-of-interest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Let <span class="math inline">\(s_{jt}\)</span> be the share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span>.</li>
<li>The following system of equations implicitly determines <span class="math inline">\(\xi_{jt}\)</span> as a function of parameters of interest:
<span class="math display">\[\begin{equation}
s_{jt} = \sigma_j(p_t, x_t, \xi_t; \theta).
\end{equation}\]</span></li>
<li>Let <span class="math inline">\(\xi_{jt}(\theta)\)</span> is the solution to the system of equations above given parameter <span class="math inline">\(\theta\)</span>.</li>
<li>If it exists, it is the unobserved heterogeneity as a function of parameters and data.</li>
<li>Does this solution exist?</li>
<li>Is it unique?</li>
<li>Is there efficient method to find the solution?</li>
</ul>
</div>
<div id="summarizing-the-conditional-mean-term" class="section level3 hasAnchor" number="4.4.49">
<h3><span class="header-section-number">4.4.49</span> Summarizing the Conditional Mean Term<a href="demand.html#summarizing-the-conditional-mean-term" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Now, let <span class="math inline">\(\delta_{jt}\)</span> be the conditional mean term in the indirect utility:
<span class="math display">\[\begin{equation}
\delta_{jt} \equiv \beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt}.
\end{equation}\]</span></li>
<li>I call it the average utility of the product in the market.</li>
<li>Then, the choice share of product <span class="math inline">\(j\)</span> in market <span class="math inline">\(t\)</span> is written as:
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\sigma_{jt}(\delta_t, \theta_2) \\
&amp;\equiv \int \frac{\exp\Bigg(\delta_{jt} + \nu&#39; \Sigma x_{jt} - \upsilon&#39; \Omega p_{jt}\Bigg)}{1 + \sum_{k \in \mathcal{J}_t} \exp\Bigg(\delta_{kt} + \nu&#39; \Sigma x_{kt} - \upsilon&#39; \Omega p_{kt}\Bigg)} f(\nu, \upsilon) d\nu d\upsilon,
\end{split}
\end{equation}\]</span>
for <span class="math inline">\(j = 1, \cdots, J, t = 1, \cdots, T\)</span>.</li>
</ul>
</div>
<div id="contraction-mapping-for-delta_t." class="section level3 hasAnchor" number="4.4.50">
<h3><span class="header-section-number">4.4.50</span> Contraction Mapping for <span class="math inline">\(\delta_t\)</span>.<a href="demand.html#contraction-mapping-for-delta_t." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Now, fix <span class="math inline">\(\theta_2\)</span> and define an operator <span class="math inline">\(T\)</span> such that:
<span class="math display">\[\begin{equation}
T_t(\delta_t) = \delta_t + \ln \underbrace{s_{t}}_{\text{data}} - \ln \underbrace{\sigma_{t}(\delta_t, \theta_2)}_{\text{model}},
\end{equation}\]</span>
where <span class="math inline">\(\delta_t = (\delta_{1t}, \cdots, \delta_{Jt})&#39;\)</span>, <span class="math inline">\(s_t = (s_{1t}, \cdots, s_{Jt})&#39;\)</span> and <span class="math inline">\(\sigma_t = (\sigma_{1t}, \cdots, \sigma_{Jt})&#39;\)</span>.</li>
<li>Let <span class="math inline">\(\delta_t^{(0)} = (\delta_{1t}^{(0)}, \cdots, \delta_{Jt}^{(0)})&#39;\)</span> be an arbitrary starting vector of average utility of products in a market.</li>
<li>Using the operator above, we update <span class="math inline">\(\delta_{t}^{(r)}\)</span> by:
<span class="math display">\[\begin{equation}
\delta_{t}^{(r + 1)} = T_t(\delta_{t}^{(r)}) = \delta_t^{(r)} + \ln s_{t} - \ln \sigma_{t}(\delta_t^{(r)}, \theta_2),
\end{equation}\]</span>
for <span class="math inline">\(r = 0, 1, \cdots\)</span>.</li>
<li><span class="citation">Steven Berry, Levinsohn, &amp; Pakes (<a href="#ref-berryAutomobilePricesMarket1995">1995</a>)</span> proved that <span class="math inline">\(T_t\)</span> as specified above is a <strong>contraction mapping with modulus less than one</strong>.</li>
<li>This means that:
<ol style="list-style-type: decimal">
<li><span class="math inline">\(T_t\)</span> has a unique fixed point;</li>
<li>For arbitrary <span class="math inline">\(\delta_t^{(r)}\)</span>, <span class="math inline">\(\lim_{r \to \infty} T_t^r(\delta_t^{(0)})\)</span> is the unique fixed point.</li>
</ol></li>
<li>The fixed point of <span class="math inline">\(T_t\)</span> is <span class="math inline">\(\delta_t^*\)</span> such that <span class="math inline">\(\delta_t^* = T_t(\delta_t^*)\)</span>, i.e.,
<span class="math display">\[\begin{equation}
\begin{split}
&amp;\delta_t^* = \delta_t^* + \ln s_{t} - \ln \sigma_{t}(\delta_t^*, \theta_2),\\
&amp;\Leftrightarrow s_{t} = \sigma_{t}(\delta_t^*, \theta_2).
\end{split}
\end{equation}\]</span></li>
<li>So, the fixed point <span class="math inline">\(\delta_t^*\)</span> is the conditional mean indirect utility that solves the equality given non-linear parameter <span class="math inline">\(\theta_2\)</span>.</li>
<li>Moreover, the solution is unique.</li>
<li>Moreover, it can be found by iterating the operator.</li>
<li>Let <span class="math inline">\(\delta_t(\theta_2)\)</span> be the solution to this equation, i.e., the limit of this operation.</li>
<li>The above result is useful because it ensures the inversion and provides the algorithm to find the solution.</li>
<li>The invertibility itself holds under more general settings <span class="citation">(<a href="#ref-Berry2013">Steven Berry, Gandhi, &amp; Haile, 2013</a>)</span>.</li>
</ul>
</div>
<div id="solving-for-xi_jttheta" class="section level3 hasAnchor" number="4.4.51">
<h3><span class="header-section-number">4.4.51</span> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span><a href="demand.html#solving-for-xi_jttheta" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>We defined the average utility as:
<span class="math display">\[\begin{equation}
\delta_{jt} =  \beta_0&#39; x_{jt} - \alpha_0 p_{jt} + \xi_{jt}.
\end{equation}\]</span></li>
<li>Hence, if we set:
<span class="math display">\[\begin{equation}
\xi_{jt}(\theta) \equiv \delta_{jt}(\theta_2) - \Bigg[\beta_0&#39; x_{jt} - \alpha_0 p_{jt} \Bigg],
\end{equation}\]</span>
the <span class="math inline">\(\xi_{jt}(\theta)\)</span> solves the equality:
<span class="math display">\[\begin{equation}
s_{jt} = \sigma_{j}(p_t, x, \xi_t; \theta).
\end{equation}\]</span></li>
</ul>
</div>
<div id="solving-for-xi_jttheta-summary" class="section level3 hasAnchor" number="4.4.52">
<h3><span class="header-section-number">4.4.52</span> Solving for <span class="math inline">\(\xi_{jt}(\theta)\)</span>: Summary<a href="demand.html#solving-for-xi_jttheta-summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>In summary, <span class="math inline">\(\xi_{jt}\)</span> that solves the equality exists and unique, and can be computed by:</li>
<li>Fix <span class="math inline">\(\theta = \{\theta_1, \theta_2\}\)</span>.</li>
<li>Fix arbitrary starting value <span class="math inline">\(\delta_t^{(0)}\)</span> for <span class="math inline">\(t = 1, \cdots, T\)</span>.</li>
<li>Let <span class="math inline">\(\delta_t(\theta_2)\)</span> be the limit of <span class="math inline">\(T_t^r(\delta_t^{(0)})\)</span> for <span class="math inline">\(r = 0, 1, \cdots\)</span> for each <span class="math inline">\(t = 1, \cdots, T\)</span>.</li>
<li>Stop the iteration if <span class="math inline">\(|\delta_t(\theta_2)^{(r + 1)} - \delta_t(\theta_2)^{(r)}|\)</span> is below a threshold.</li>
<li>Let <span class="math inline">\(\xi_{jt}(\theta)\)</span> be such that:
<span class="math display">\[\begin{equation}
\xi_{jt}(\theta) = \delta_{jt}(\theta_2) - \beta_0&#39; x_{jt} - \alpha_0 p_{jt}.
\end{equation}\]</span></li>
<li>Then we can evaluate the moment at <span class="math inline">\(\theta\)</span> by:
<span class="math display">\[\begin{equation}
\mathbb{E}\{\xi_{jt}(\theta)|w_{jt}\} = 0.
\end{equation}\]</span></li>
<li>We run this algorithm every time we evaluate the moment condition at a parameter value.</li>
</ul>
</div>
<div id="gmm-objective-function" class="section level3 hasAnchor" number="4.4.53">
<h3><span class="header-section-number">4.4.53</span> GMM Objective Function<a href="demand.html#gmm-objective-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Find <span class="math inline">\(\theta\)</span> that solves:
<span class="math display">\[\begin{equation}
\min_{\theta} \xi(\theta)&#39; W \Phi^{-1} W&#39; \xi(\theta),
\end{equation}\]</span>
where <span class="math inline">\(\Phi\)</span> is a weight matrix,
<span class="math display">\[\begin{equation}
\xi(\theta) =
\begin{pmatrix}
\xi_{11}(\theta)\\
\vdots\\
\xi_{J_1 1}(\theta)\\
\vdots\\
\xi_{1T} \\
\vdots\\
\xi_{J_T T}
\end{pmatrix},
W =
\begin{pmatrix}
w_{11}&#39; \\
\vdots \\
w_{J_11}&#39; \\
\vdots \\
w_{1T}&#39; \\
\vdots \\
w_{J_TT}&#39; \\
\end{pmatrix}.
\end{equation}\]</span></li>
<li>There are <span class="math inline">\(J \to \infty\)</span> and <span class="math inline">\(T \to \infty\)</span> asymptotics. Either is fine to consistently estimate the parameters.</li>
<li><span class="math inline">\(w_{jt} = (x_{jt}&#39;, w_{jt}^*)&#39;\)</span> where <span class="math inline">\(w_{jt}^*\)</span> is an excluded instrument that is relevant to <span class="math inline">\(p_{jt}\)</span>.</li>
</ul>
</div>
<div id="estimating-linear-parameters" class="section level3 hasAnchor" number="4.4.54">
<h3><span class="header-section-number">4.4.54</span> Estimating Linear Parameters<a href="demand.html#estimating-linear-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The first-order condition for <span class="math inline">\(\theta_1\)</span> is:
<span class="math display">\[\begin{equation}
\theta_1 = (X_1&#39;W \Phi^{-1} W&#39;X_1)^{-1} X_1&#39; W \Phi^{-1} W&#39; \delta(\theta_2),
\end{equation}\]</span>
where
<span class="math display">\[\begin{equation}
X_1 =
\begin{pmatrix}
x_{11}&#39; &amp; - p_{11}\\
\vdots &amp; \vdots \\
x_{J_1 1}&#39; &amp; - p_{J_1 1}\\
\vdots &amp; \vdots \\
x_{1T}&#39; &amp; - p_{1T}\\
\vdots &amp; \vdots \\
x_{J_T T} &amp; - p_{J_T T}
\end{pmatrix},
\delta(\theta_2) =
\begin{pmatrix}
\delta_1(\theta_2)\\
\vdots\\
\delta_T(\theta_2)
\end{pmatrix}
\end{equation}\]</span>.</li>
<li>If <span class="math inline">\(\theta_2\)</span> is given, the optimal <span class="math inline">\(\theta_1\)</span> is computed by the above formula.</li>
<li><span class="math inline">\(\rightarrow\)</span> We only have to search over <span class="math inline">\(\theta_2\)</span>.</li>
<li>This is the reason why we called <span class="math inline">\(\theta_1\)</span> linear parameters and <span class="math inline">\(\theta_2\)</span> non-linear parameters.</li>
</ul>
</div>
<div id="blp-algorithm" class="section level3 hasAnchor" number="4.4.55">
<h3><span class="header-section-number">4.4.55</span> BLP Algorithm<a href="demand.html#blp-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Find <span class="math inline">\(\theta_2\)</span> that maximizes the GMM objective function.</li>
<li>To do so:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Pick up <span class="math inline">\(\theta_2\)</span>.</li>
<li>Compute <span class="math inline">\(\delta(\theta_2)\)</span> by the fixed-point algorithm.</li>
<li>Compute associated <span class="math inline">\(\theta_1\)</span> by the formula:
<span class="math display">\[\begin{equation}
\theta_1 = (X_1&#39;W \Phi^{-1} W&#39;X_1)^{-1} X_1&#39; W \Phi^{-1} W&#39; \delta(\theta_2),
\end{equation}\]</span></li>
<li>Compute <span class="math inline">\(\xi(\theta)\)</span> from the above <span class="math inline">\(\delta(\theta_2)\)</span> and <span class="math inline">\(\theta_1\)</span>.</li>
<li>Evaluate the GMM objective function with the <span class="math inline">\(\xi(\theta)\)</span>.</li>
</ol>
</div>
<div id="mathematical-program-with-equilibrium-constraints-mpec" class="section level3 hasAnchor" number="4.4.56">
<h3><span class="header-section-number">4.4.56</span> Mathematical Program with Equilibrium Constraints (MPEC)<a href="demand.html#mathematical-program-with-equilibrium-constraints-mpec" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>In the BLP algorithm, for each parameter <span class="math inline">\(\theta\)</span>, find <span class="math inline">\(\xi(\theta)\)</span> that solve:
<span class="math display">\[\begin{equation}
s = \sigma(p, x, \xi; \theta)
\end{equation}\]</span>
by the fixed-point algorithm and then evaluate the GMM objective function.</li>
<li>This inner loop takes time if the stopping criterion is tight.</li>
<li>If the stopping criterion is loose, the loop may stop earlier but the error may be unacceptably large.</li>
<li><span class="citation">Dubé, Fox, &amp; Su (<a href="#ref-Dube2012">2012</a>)</span> suggest to minimize the GMM objective function with the above equation as the constraints.
<span class="math display">\[\begin{equation}
\min_{\theta} \xi(\theta)&#39; W \Phi^{-1} W&#39; \xi(\theta) \text{   s.t.   } s = \sigma(p, x, \xi; \theta).
\end{equation}\]</span></li>
<li>To enjoy the benefit of this approach, we have to analytically derive the gradient and hessian of the objective function and the constraints, which are anyway needed if we estimate the standard error with the plug-in method.</li>
<li>If the problem is of small scale, BLP algorithm will be fast enough and easier to implement.</li>
<li>If the problem is of large scale, you may better use the MPEC approach.</li>
</ul>
</div>
<div id="control-function-approach" class="section level3 hasAnchor" number="4.4.57">
<h3><span class="header-section-number">4.4.57</span> Control Function Approach<a href="demand.html#control-function-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The BLP method requires a share data. It does not work when each consumer face different choice set.</li>
<li>How to deal with the endogeneity between the price and unobserved fixed effect in such a case?</li>
<li>The equilibrium price vector in a market is determined by product characteristics, and productivity and demand conditions.</li>
<li>It will depends on the unobserved product characteristics <span class="math inline">\(\xi_{jt}\)</span>.</li>
<li>Suppose that the equilibrium price vector in a market is determined by:
<span class="math display">\[\begin{equation}
p_{t} = P(x_t, w_t, \xi_t),
\end{equation}\]</span>
where <span class="math inline">\(w_t\)</span> is a vector of variables that affect the price but are excluded from the indirect utility function.</li>
<li>If we can estimate it and it is invertible in <span class="math inline">\(\xi_t\)</span>, then, we can have a proxy for <span class="math inline">\(\xi_t\)</span> such as:
<span class="math display">\[\begin{equation}
\hat{\xi}_t = \hat{P}^{-1}(x_t, z_t).
\end{equation}\]</span></li>
<li>If we insert this into the previous models, <span class="math inline">\(\xi_{jt}\)</span> is no longer <strong>unobserved</strong> product characteristics.</li>
</ul>
</div>
<div id="control-function-approach-1" class="section level3 hasAnchor" number="4.4.58">
<h3><span class="header-section-number">4.4.58</span> Control Function Approach<a href="demand.html#control-function-approach-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>For example, suppose that <span class="math inline">\(\xi_{jt}\)</span> is decomposed into anticipated shock <span class="math inline">\(\nu_{jt}\)</span> and ex-post shock <span class="math inline">\(\eta_{jt}\)</span> as
<span class="math display">\[\begin{equation}
\xi_{jt} = \rho \nu_{jt} + \eta_{jt}.
\end{equation}\]</span></li>
<li>Then, the equilibrium price should only depend on the anticpated shock as
<span class="math display">\[\begin{equation}
p_{jt} = \beta x_{jt} + \gamma w_{jt} + \nu_{jt}.
\end{equation}\]</span></li>
<li><span class="math inline">\(p_{jt}\)</span> and <span class="math inline">\(\xi_{jt}\)</span> are correlated due to ex-ante shock <span class="math inline">\(\nu_{jt}\)</span>.</li>
<li>In the first stage, regress <span class="math inline">\(p_{jt}\)</span> on <span class="math inline">\(x_{jt}\)</span> and <span class="math inline">\(w_{jt}\)</span> to obtain <span class="math inline">\(\hat{\beta}\)</span> and <span class="math inline">\(\hat{\gamma}\)</span>.</li>
<li>Then, construct <span class="math inline">\(\hat{\nu}_{jt} = p_{jt} - \hat{\beta} x_{jt} - \hat{\gamma} w_{jt}\)</span>.</li>
<li>Then, we have <span class="math inline">\(\xi_{jt} = \rho \hat{\nu}_{jt} + \eta_{jt}\)</span>.</li>
<li>In the second stage, insert this into the choice probability.</li>
<li><span class="math inline">\(\eta_{jt}\)</span> is an unobserved <strong>random</strong> shock.</li>
<li>We integrate <span class="math inline">\(\eta_{jt}\)</span> to calculate the likelihood.</li>
<li>The instrument <span class="math inline">\(w_{jt}\)</span> is necessary, because, otherwise, <span class="math inline">\(\nu_{jt}\)</span> has no variation conditional on <span class="math inline">\(p_{jt}\)</span> and <span class="math inline">\(x_{jt}\)</span> and <span class="math inline">\(\rho\)</span> cannot be identified.</li>
</ul>
</div>
<div id="instrumental-variables" class="section level3 hasAnchor" number="4.4.59">
<h3><span class="header-section-number">4.4.59</span> Instrumental Variables<a href="demand.html#instrumental-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The remaining problem is how to choose the excluded instrumental variable <span class="math inline">\(w_{jt}^*\)</span> for each product/market.</li>
<li><strong>Cost shifters</strong>:
<ul>
<li>These are traditional instruments that directly affect costs but not demand.</li>
</ul></li>
<li><strong>Hausman-type IV</strong> <span class="citation">(<a href="#ref-Hausman1994">Hausman, Leonard, &amp; Zona, 1994</a>)</span>:
<ul>
<li>Assumes that demand shocks are independent across markets, whereas cost shocks are correlated.</li>
<li>The correlation in cost shocks will be true if the products are produced by the same manufacturer.</li>
<li>Then, the prices of the same product in other markets <span class="math inline">\(p_{j, -t}\)</span> will be valid instruments for the price of the product in a given market, <span class="math inline">\(p_{jt}\)</span>.</li>
</ul></li>
<li><strong>BLP-type IV</strong> <span class="citation">(<a href="#ref-berryAutomobilePricesMarket1995">Steven Berry et al., 1995</a>)</span>:
<ul>
<li>In oligopoly, the price of a good in a market depends on the market structure, i.e., what types of products are available in the market.</li>
<li>For example, if there are similar products in the market, the price will tend to be lower.</li>
<li>Then, the product characteristics of other products in the market will be valid instruments for the price of goods in a given market, <span class="math inline">\(p_{jt}\)</span>.</li>
<li>If there are multi-product firms, whether the other good is owned by the same company will also affect the price.</li>
<li>Specifically, <span class="citation">Steven Berry et al. (<a href="#ref-berryAutomobilePricesMarket1995">1995</a>)</span> use:</li>
</ul></li>
</ul>
<p><span class="math display">\[\begin{equation}
\sum_{k \neq j \in \mathcal{J}_t \cap \mathcal{F}_{f}} x_{kt},
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\sum_{k \neq j \in \mathcal{J}_t \setminus \mathcal{F}_{f}} x_{kt}.
\end{equation}\]</span>
where <span class="math inline">\(f\)</span> is the firm that owns product <span class="math inline">\(j\)</span> and <span class="math inline">\(\mathcal{F}_{f}\)</span> is the set of products firm <span class="math inline">\(f\)</span> owns.</p>
<ul>
<li><strong>Differentiation IV</strong> <span class="citation">(<a href="#ref-Gandhi2015a">Gandhi &amp; Houde, 2015</a>)</span>:
<ul>
<li>Let <span class="math inline">\(d_{jkt} = d(x_{jt}, x_{kt})\)</span> be some distance between product characteristics.</li>
<li>They showed that under certain conditions, the optimal BLP-type IV is a function <span class="math inline">\(d_{-jt}\{d_{jkt}\}_{k \neq j \in \mathcal{J}_t}\)</span>.</li>
<li>They suggest using the moments of <span class="math inline">\(d_{-jt}\)</span> as the excluded instrumental variables.</li>
</ul></li>
<li><strong>Weak instruments problem of BLP-type IV</strong>:
<ul>
<li><span class="citation">Armstrong (<a href="#ref-Armstrong2016b">2016</a>)</span> argued that estimates based on BLP-type IV may be inconsistent when <span class="math inline">\(J \times \infty\)</span> asymptotics is considered because then the market approaches the competitive market and the correlation between the markup and the product characteristics of rivals disappears.</li>
<li>Specifically, the estimator is inconsistent if all of the following conditions are met:</li>
</ul>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(J \to \infty\)</span> but <span class="math inline">\(T\)</span> is fixed</li>
<li>The demand/cost functions are such that the correlation between markups and characteristics of other products decreases quickly enough as <span class="math inline">\(J \to \infty\)</span></li>
<li>There are no cost instruments or other sources of identification</li>
</ol></li>
</ul>
</div>
<div id="pyblp" class="section level3 hasAnchor" number="4.4.60">
<h3><span class="header-section-number">4.4.60</span> PyBLP<a href="demand.html#pyblp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><span class="citation">Conlon &amp; Gortmaker (<a href="#ref-conlonBestPracticesDifferentiated2020">2020</a>)</span> summarized the best practices for the BLP method and implemented them in a Python package <a href="https://pyblp.readthedocs.io/"><code>PyBLP</code></a>.</li>
<li>From R, we can use <a href="https://rstudio.github.io/reticulate/"><code>reticulate</code></a> to call Python functions.</li>
</ul>

</div>
</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Afriat1967" class="csl-entry">
Afriat, S. N. (1967). The <span>Construction</span> of <span>Utility Functions</span> from <span>Expenditure Data</span>. <em>International Economic Review</em>, <em>8</em>(1).
</div>
<div id="ref-AngusDeaton1980" class="csl-entry">
Angus Deaton, &amp; John Muellbauer. (1980). <em>Economics and <span>Consumer Behavior</span></em>. <span>New York</span>: <span>Cambridge University Press</span>.
</div>
<div id="ref-Archak2011" class="csl-entry">
Archak, N., Ghose, A., &amp; Ipeirotis, P. G. (2011). <a href="https://doi.org/10.1287/mnsc.1110.1370">Deriving the <span>Pricing Power</span> of <span>Product Features</span> by <span>Mining Consumer Reviews</span></a>. <em>Management Science</em>, <em>57</em>(8), 1485–1509.
</div>
<div id="ref-Armstrong2016b" class="csl-entry">
Armstrong, T. B. (2016). <a href="https://doi.org/10.3982/ECTA10600">Large <span>Market Asymptotics</span> for <span>Differentiated Product Demand Estimators</span> with <span>Economic Models</span> of <span>Supply</span></a>. <em>Econometrica</em>, <em>84</em>(5), 1961–1980.
</div>
<div id="ref-Bayer2007" class="csl-entry">
Bayer, P., Ferreira, F., Mcmillan, R., Altonji, J., Bajari, P., Berry, S., … Timmins, C. (2007). <em>A <span>Unified Framework</span> for <span>Measuring Preferences</span> for <span>Schools</span> and <span>Neighborhoods</span></em> (No. 4) (Vol. 115).
</div>
<div id="ref-berryEstimatingDiscreteChoiceModels1994" class="csl-entry">
Berry, S. T. (1994). <a href="https://doi.org/10.2307/2555829">Estimating <span>Discrete-Choice Models</span> of <span>Product Differentiation</span></a>. <em>The RAND Journal of Economics</em>, <em>25</em>(2), 242–262.
</div>
<div id="ref-Berry2013" class="csl-entry">
Berry, Steven, Gandhi, A., &amp; Haile, P. (2013). <a href="https://doi.org/10.3982/ECTA10135">Connected <span>Substitutes</span> and <span>Invertibility</span> of <span>Demand</span></a>. <em>Econometrica</em>, <em>81</em>(5), 2087–2111.
</div>
<div id="ref-berryAutomobilePricesMarket1995" class="csl-entry">
Berry, Steven, Levinsohn, J., &amp; Pakes, A. (1995). <a href="https://doi.org/10.2307/2171802">Automobile <span>Prices</span> in <span>Market Equilibrium</span></a>. <em>Econometrica</em>, <em>63</em>(4), 841–890.
</div>
<div id="ref-Berry2007" class="csl-entry">
Berry, Steven, &amp; Pakes, A. (2007). <a href="https://doi.org/10.1111/j.1468-2354.2007.00459.x">The <span>Pure Characteristics Demand Model</span></a>. <em>International Economic Review</em>, <em>48</em>(4), 1193–1225.
</div>
<div id="ref-Blow2008" class="csl-entry">
Blow, L., Browning, M., &amp; Crawford, I. (2008). <em>Revealed <span>Preference Analysis</span> of <span>Characteristics Models</span></em> (Vol. 75, pp. 371–389).
</div>
<div id="ref-Bresnahan1987" class="csl-entry">
Bresnahan, Timothy F. (1987). The <span>Empirical Renaissance</span> in <span>Industrial Economics</span>. <em>The Journal of Industrial Economics</em>, <em>35</em>(4), 457–482.
</div>
<div id="ref-Cardell1997" class="csl-entry">
Cardell, N. S. (1997). <a href="https://doi.org/10.1017/S0266466600005727">Variance <span>Components Structures</span> for the <span>Extreme-Value</span> and <span>Logistic Distributions</span> with <span>Application</span> to <span>Models</span> of <span>Heterogeneity</span></a>. <em>Econometric Theory</em>, <em>13</em>, 185–213.
</div>
<div id="ref-Chung2002" class="csl-entry">
Chung, W., &amp; Alcácer, J. (2002). <a href="https://doi.org/10.1287/mnsc.48.12.1534.440">Knowledge <span>Seeking</span> and <span>Location Choice</span> of <span>Foreign Direct Investment</span> in the <span>United States</span></a>. <em>Management Science</em>, <em>48</em>(12).
</div>
<div id="ref-conlonBestPracticesDifferentiated2020" class="csl-entry">
Conlon, C., &amp; Gortmaker, J. (2020). <a href="https://doi.org/10.1111/1756-2171.12352">Best practices for differentiated products demand estimation with <span>PyBLP</span></a>. <em>The RAND Journal of Economics</em>, <em>51</em>(4), 1108–1161.
</div>
<div id="ref-Deaton1980" class="csl-entry">
Deaton, A., &amp; Muellbauer, J. (1980). <em>An <span>Almost Ideal Demand System</span></em> (No. 3) (Vol. 70, pp. 312–326).
</div>
<div id="ref-Dube2012" class="csl-entry">
Dubé, J.-P., Fox, J. T., &amp; Su, C.-L. (2012). <a href="https://doi.org/10.3982/ECTA8585">Improving the <span>Numerical Performance</span> of <span>Static</span> and <span>Dynamic Aggregate Discrete Choice Random Coefficients Demand Estimation</span></a>. <em>Econometrica</em>, <em>80</em>(5), 2231–2267.
</div>
<div id="ref-Gandhi2015a" class="csl-entry">
Gandhi, A., &amp; Houde, J.-F. (2015). <em>Measuring <span>Substitution Patterns</span> in <span>Differentiated Products Industries</span></em>.
</div>
<div id="ref-Gentzkow2004" class="csl-entry">
Gentzow, M. (2004). <em><a href="https://doi.org/10.1257/aer.97.3.713">Valuing new goods in a model with complementarity : <span>Online</span> newspapers</a></em> (No. 3) (Vol. 97, pp. 713–744).
</div>
<div id="ref-Gorman1980" class="csl-entry">
Gorman, W. M. (1980). <em>A <span>Possible Procedure</span> for <span>Analysing Quality Differentials</span> in the <span>Egg Market</span></em> (No. 5) (Vol. 47, pp. 843–856).
</div>
<div id="ref-Handbury2014" class="csl-entry">
Handbury, J., &amp; Weinstein, D. E. (2014). <a href="https://doi.org/10.1093/restud/rdu033">Goods <span>Prices</span> and <span>Availability</span> in <span>Cities</span></a>. <em>The Review of Economic Studies</em>, <em>82</em>(1), 258–296.
</div>
<div id="ref-Hausman1994" class="csl-entry">
Hausman, Leonard, &amp; Zona. (1994). <a href="https://doi.org/10.2307/20075951">Competitive <span>Analysis</span> with <span>Differenciated Products</span></a>. <em>Annales d’Économie et de Statistique</em>, (34), 159–180.
</div>
<div id="ref-Holmes2011" class="csl-entry">
Holmes, B. Y. T. H. J. H. (2011). <a href="https://doi.org/10.3982/ecta7699">The <span>Diffusion</span> of <span>Wal-Mart</span> and <span>Economies</span> of <span>Density</span></a>. <em>Econometrica</em>, <em>79</em>(1), 253–302.
</div>
<div id="ref-Houthakker1950" class="csl-entry">
Houthakker, H. S. (1950). Revealed <span>Preference</span> and the <span>Utility Function Author</span>. <em>Economica</em>, <em>17</em>(66), 159–174.
</div>
<div id="ref-Judd1998" class="csl-entry">
Judd, K. L. (1998). <em>Numerical methods in economics</em>. <span>MIT Press</span>.
</div>
<div id="ref-Lancaster1966" class="csl-entry">
Lancaster, K. J. (1966). <a href="https://doi.org/10.1086/259131">A <span>New Approach</span> to <span>Consumer Theory</span></a>. <em>Journal of Political Economy</em>, <em>74</em>(2), 132–157.
</div>
<div id="ref-Mcfadden1974" class="csl-entry">
Mcfadden, D. L. (1974). Conditional <span>Logit Analysis</span> of <span>Qualitative Choice Behavior</span>. In P. Zarembka (Ed.), <em>Frontiers in <span>Econometrics</span></em>. <span>New York</span>: <span>Academic Press</span>.
</div>
<div id="ref-Mcfadden2000" class="csl-entry">
McFadden, D., &amp; Train, K. (2000). <a href="https://doi.org/10.1002/1099-1255(200009/10)15:5&lt;447::aid-jae570&gt;3.3.co;2-t">Mixed <span>MNL</span> models for discrete response</a>. <em>Journal of Applied Econometrics</em>, <em>15</em>(5), 447–470.
</div>
<div id="ref-Muellbauer1974" class="csl-entry">
Muellbauer, J. (1974). Household <span>Production Theory</span>, <span>Quality</span>, and the "<span>Hedonic Technique</span>. <em>The American Economic Review</em>, <em>64</em>(6), 977–994.
</div>
<div id="ref-Muellbauer1976" class="csl-entry">
Muellbauer, J. (1976). Community <span>Preferences</span> and the <span>Representative Consumer Author</span>. <em>Econometrica</em>, <em>44</em>(5), 979–999.
</div>
<div id="ref-Muth1966" class="csl-entry">
Muth, R. F. (1966). <em>Household <span>Production</span> and <span>Consumer Demand Functions</span></em> (No. 3) (Vol. 34, pp. 699–708).
</div>
<div id="ref-Nevo2000c" class="csl-entry">
Nevo, A. (2000). <em>Mergers with differentiated products: The case of the ready-to-eat cereal industry</em> (No. 3) (Vol. 31).
</div>
<div id="ref-RichardStone1954" class="csl-entry">
Richard Stone. (1954). <em>The <span>Measurement</span> of <span>Consumers</span>’ <span>Expenditure</span> and <span>Behaviour</span> in the <span>United Kingdom</span> 1920-1938, vol. 1</em>. <span>Cambridge</span>: <span>Cambridge University Press</span>.
</div>
<div id="ref-Richter1966" class="csl-entry">
Richter, M. K. (1966). Revealed <span>Preference Theory</span>. <em>Econometrica</em>, <em>34</em>(3).
</div>
<div id="ref-Rosen1974" class="csl-entry">
Rosen, S. (1974). Hedonic <span>Prices</span> and <span>Implicit Markets</span>: <span>Product Differentiation</span> in <span>Pure Competition</span>. <em>Journal of Political Economy</em>, <em>82</em>(1), 34–55.
</div>
<div id="ref-Rysman2004" class="csl-entry">
Rysman, M. (2004). <em>Competition <span>Between Networks</span>: <span>A Study</span> of the <span>Market</span> for <span>Yellow Pages</span></em> (Vol. 71, pp. 483–512).
</div>
<div id="ref-Samuelson1938" class="csl-entry">
Samuelson, P. A. (1938). A <span>Note</span> on the <span>Pure Theory</span> of <span>Consumer</span>’s <span>Behaviour</span>. <em>Economica</em>, <em>5</em>(17), 61–71.
</div>
<div id="ref-Train2009" class="csl-entry">
Train, K. (2009). <em>Discrete <span>Choice Methods</span> with <span>Simulation</span></em>. <span>Cambridge</span>: <span>Cambridge University Press</span>.
</div>
<div id="ref-Varian1982" class="csl-entry">
Varian, H. R. (1982). The <span>Nonparametric Approach</span> to <span>Demand Analysis</span>. <em>Econometrica</em>, <em>50</em>(4), 945–973.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="production.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="merger.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["lecture.pdf", "lecture.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
